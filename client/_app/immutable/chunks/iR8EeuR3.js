import{s as ne,e as _,a as S,c as m,b as N,g as T,q as B,f as L,r as h,y as I,W as se,i as J,h as r,_ as $,z,A as re,n as ee,B as oe,C as ue,k as ce,t as pe,d as de,j as fe,$ as ve}from"./CDvIr29H.js";import{e as te}from"./mmDljT_r.js";import{S as he,i as _e}from"./ByE-_V18.js";import{g as me}from"./BMKj-mzl.js";import{g as ge}from"./VQmOc05J.js";import"./C1zJQccS.js";import{u as be,a as Ce}from"./ZQo-p3Ky.js";import{a as Ee}from"./BF5nqrJG.js";function le(s,t,e){const p=s.slice();return p[5]=t[e][0],p[11]=t[e][1],p}function ae(s){let t,e,p="UUID:",u,l,c;return{c(){t=_("label"),e=_("span"),e.textContent=p,u=S(),l=_("input"),this.h()},l(o){t=m(o,"LABEL",{class:!0});var i=N(t);e=m(i,"SPAN",{"data-svelte-h":!0}),B(e)!=="svelte-xruxbf"&&(e.textContent=p),u=T(i),l=m(i,"INPUT",{type:!0,class:!0}),i.forEach(L),this.h()},h(){var o;h(l,"type","text"),h(l,"class","input"),l.value=c=(o=s[0])==null?void 0:o.uuid,l.readOnly=!0,h(t,"class","label svelte-1pdeqr")},m(o,i){J(o,t,i),r(t,e),r(t,u),r(t,l)},p(o,i){var E;i&1&&c!==(c=(E=o[0])==null?void 0:E.uuid)&&l.value!==c&&(l.value=c)},d(o){o&&L(t)}}}function ie(s){let t,e=s[5]+"",p,u;return{c(){t=_("option"),p=pe(e),this.h()},l(l){t=m(l,"OPTION",{});var c=N(t);p=de(c,e),c.forEach(L),this.h()},h(){t.__value=u=s[11],I(t,t.__value)},m(l,c){J(l,t,c),r(t,p)},p(l,c){c&2&&e!==(e=l[5]+"")&&fe(p,e),c&2&&u!==(u=l[11])&&(t.__value=u,I(t,t.__value))},d(l){l&&L(t)}}}function Le(s){var Z;let t,e,p,u,l,c="Name:",o,i,E,P,q,F="Description:",U,n,D,A,x,K="Application:",H,b,y,Q="Select an application",R,w,X='<button type="submit" data-testid="privilege-save-btn" class="btn variant-ghost-primary hover:variant-filled-primary">Save</button> <a href="/admin/configuration" data-testid="privilege-cancel-btn" class="btn variant-ghost-secondary hover:variant-filled-secondary">Cancel</a>',M,V,Y,g=((Z=s[0])==null?void 0:Z.uuid)&&ae(s),O=te(s[1]),f=[];for(let a=0;a<O.length;a+=1)f[a]=ie(le(s,O,a));return{c(){t=_("form"),e=_("fieldset"),g&&g.c(),p=S(),u=_("label"),l=_("span"),l.textContent=c,o=S(),i=_("input"),E=S(),P=_("label"),q=_("span"),q.textContent=F,U=S(),n=_("input"),D=S(),A=_("label"),x=_("span"),x.textContent=K,H=S(),b=_("select"),y=_("option"),y.textContent=Q;for(let a=0;a<f.length;a+=1)f[a].c();R=S(),w=_("div"),w.innerHTML=X,this.h()},l(a){t=m(a,"FORM",{class:!0});var C=N(t);e=m(C,"FIELDSET",{"data-testid":!0});var d=N(e);g&&g.l(d),p=T(d),u=m(d,"LABEL",{class:!0});var v=N(u);l=m(v,"SPAN",{"data-svelte-h":!0}),B(l)!=="svelte-m2peuz"&&(l.textContent=c),o=T(v),i=m(v,"INPUT",{type:!0,class:!0,minlength:!0,maxlength:!0}),v.forEach(L),E=T(d),P=m(d,"LABEL",{class:!0});var k=N(P);q=m(k,"SPAN",{"data-svelte-h":!0}),B(q)!=="svelte-n5lbfe"&&(q.textContent=F),U=T(k),n=m(k,"INPUT",{type:!0,class:!0,minlength:!0,maxlength:!0}),k.forEach(L),D=T(d),A=m(d,"LABEL",{class:!0});var j=N(A);x=m(j,"SPAN",{"data-svelte-h":!0}),B(x)!=="svelte-u1sl8e"&&(x.textContent=K),H=T(j),b=m(j,"SELECT",{class:!0});var W=N(b);y=m(W,"OPTION",{"data-svelte-h":!0}),B(y)!=="svelte-e5qj4t"&&(y.textContent=Q);for(let G=0;G<f.length;G+=1)f[G].l(W);W.forEach(L),j.forEach(L),R=T(d),w=m(d,"DIV",{"data-svelte-h":!0}),B(w)!=="svelte-eo2lt8"&&(w.innerHTML=X),d.forEach(L),C.forEach(L),this.h()},h(){h(i,"type","text"),h(i,"class","input"),i.required=!0,h(i,"minlength","1"),h(i,"maxlength","255"),h(u,"class","label required svelte-1pdeqr"),h(n,"type","text"),h(n,"class","input"),n.required=!0,h(n,"minlength","1"),h(n,"maxlength","255"),h(P,"class","label required svelte-1pdeqr"),y.__value="",I(y,y.__value),y.disabled=!0,h(b,"class","select"),b.required=!0,s[3]===void 0&&se(()=>s[9].call(b)),h(A,"class","label required svelte-1pdeqr"),h(e,"data-testid","privilege-form"),e.disabled=M=!s[4],h(t,"class","grid gap-4 my-3")},m(a,C){J(a,t,C),r(t,e),g&&g.m(e,null),r(e,p),r(e,u),r(u,l),r(u,o),r(u,i),I(i,s[5]),r(e,E),r(e,P),r(P,q),r(P,U),r(P,n),I(n,s[2]),r(e,D),r(e,A),r(A,x),r(A,H),r(A,b),r(b,y);for(let d=0;d<f.length;d+=1)f[d]&&f[d].m(b,null);$(b,s[3],!0),r(e,R),r(e,w),V||(Y=[z(i,"input",s[7]),z(n,"input",s[8]),z(b,"change",s[9]),z(t,"submit",re(s[6]))],V=!0)},p(a,[C]){var d;if((d=a[0])!=null&&d.uuid?g?g.p(a,C):(g=ae(a),g.c(),g.m(e,p)):g&&(g.d(1),g=null),C&32&&i.value!==a[5]&&I(i,a[5]),C&4&&n.value!==a[2]&&I(n,a[2]),C&2){O=te(a[1]);let v;for(v=0;v<O.length;v+=1){const k=le(a,O,v);f[v]?f[v].p(k,C):(f[v]=ie(k),f[v].c(),f[v].m(b,null))}for(;v<f.length;v+=1)f[v].d(1);f.length=O.length}C&10&&$(b,a[3]),C&16&&M!==(M=!a[4])&&(e.disabled=M)},i:ee,o:ee,d(a){a&&L(t),g&&g.d(),oe(f,a),V=!1,ue(Y)}}}function Pe(s,t,e){let p;ce(s,Ee,n=>e(4,p=n));const u=ge();let{privilege:l=void 0}=t,{applicationList:c}=t,o=l?l.name:"",i=l?l.description:"",E=l?l.application:"";async function P(){let n={name:o,description:i,application:E};try{l?(n={...n,uuid:l.uuid},await be(n)):await Ce(n),u.trigger({message:`Successfully saved ${n&&"new "}privilege '${o}'`,background:"variant-filled-success"}),me("/admin/configuration")}catch(D){console.error(D),u.trigger({message:`An error occured while saving ${n&&"new "}privilege '${o}'`,background:"variant-filled-error"})}}function q(){o=this.value,e(5,o)}function F(){i=this.value,e(2,i)}function U(){E=ve(this),e(3,E),e(1,c)}return s.$$set=n=>{"privilege"in n&&e(0,l=n.privilege),"applicationList"in n&&e(1,c=n.applicationList)},[l,c,i,E,p,o,P,q,F,U]}class xe extends he{constructor(t){super(),_e(this,t,Pe,Le,ne,{privilege:0,applicationList:1})}}export{xe as P};
