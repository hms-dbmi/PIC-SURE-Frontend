var c=Object.defineProperty;var d=(s,i,t)=>i in s?c(s,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[i]=t;var e=(s,i,t)=>d(s,typeof i!="symbol"?i+"":i,t);import{A as l}from"./BBo6I-Ix.js";import{c as u,P as p}from"./yAhaO9Md.js";class k extends l{constructor(t){super(t);e(this,"uri");e(this,"clientid");e(this,"state");e(this,"oktaidpid");e(this,"oktalogouturl");e(this,"idp");e(this,"authenticate",async t=>{const r=this.getResponseMap(t),o=r.get("code"),n=r.get("state")||"",a=this.state;if(!o||a!==n){console.debug("RAS authentication failed code: ",o," state: ",n," localState: ",a);return}return u(`${p.Auth}/ras`,{code:o})});e(this,"login",async(t,r)=>{let o="/";{o=this.getRedirectURI(),o=o.replace(/\/$/,""),this.saveState(t,r,this.idp);const n=encodeURIComponent(this.clientid),a=encodeURIComponent(this.oktaidpid);window.location.href=`${this.uri}?response_type=code&scope=openid&client_id=${n}&idp=${a}&redirect_uri=${o}&state=${this.state}`}});e(this,"logout",()=>{localStorage.removeItem("state");const t=encodeURI(`${window.location.protocol}//${window.location.hostname}${window.location.port?":"+window.location.port:""}/login`),r=localStorage.getItem("oktaIdToken"),o=this.oktalogouturl+"?id_token_hint="+r+"&post_logout_redirect_uri="+t,n=encodeURIComponent(o),a=this.logouturl+n;return Promise.resolve(a)});if(this.state=localStorage.getItem("state")||"ras-"+this.generateRandomState(),localStorage.setItem("state",this.state),t.uri===void 0||t.clientid===void 0||t.oktaidpid===void 0||t.logouturl===void 0||t.oktalogouturl===void 0)throw new Error("Missing required RAS parameter(s).");this.uri=t.uri,this.clientid=t.clientid,this.oktaidpid=t.oktaidpid,this.idp=t.idp,this.oktalogouturl=t.oktalogouturl}generateRandomState(){const t=Math.random().toString(36).substring(2,15),r=new Date().getTime().toString(36);return t+r}}export{k as default};
