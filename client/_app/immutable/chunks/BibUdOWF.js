var V=Object.defineProperty;var v=(i,t,s)=>t in i?V(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var r=(i,t,s)=>v(i,typeof t!="symbol"?t+"":t,s);import{r as c}from"./BD7x6Jnt.js";import{g as o}from"./DpyMT7OB.js";import{u as C}from"./BpV1Tt4c.js";import{f as I,h as T}from"./XQ4prG3n.js";import{e as O}from"./CtWAh19b.js";class n{constructor(t){r(this,"categoryFilters");r(this,"numericFilters");r(this,"requiredFields");r(this,"anyRecordOf");r(this,"anyRecordOfMulti");r(this,"fields");r(this,"crossCountFields");r(this,"variantInfoFilters");r(this,"expectedResultType");var a;this.categoryFilters=(t==null?void 0:t.categoryFilters)||{},this.numericFilters=(t==null?void 0:t.numericFilters)||{},this.requiredFields=(t==null?void 0:t.requiredFields)||[],this.anyRecordOf=(t==null?void 0:t.anyRecordOf)||[],this.anyRecordOfMulti=(t==null?void 0:t.anyRecordOfMulti)||[],this.crossCountFields=(t==null?void 0:t.crossCountFields)||void 0,this.fields=(t==null?void 0:t.fields)||[];const s=((a=t==null?void 0:t.variantInfoFilters)==null?void 0:a[0])||{categoryVariantInfoFilters:{},numericVariantInfoFilters:{}};this.variantInfoFilters=[s],this.expectedResultType=(t==null?void 0:t.expectedResultType)||"COUNT"}addCategoryFilter(t,s){this.categoryFilters[t]=s}removeCategoryFilter(t){delete this.categoryFilters[t]}addNumericFilter(t,s,a){this.numericFilters[t]={min:s.toString(),max:a.toString()}}addCategoryVariantInfoFilters(t){this.variantInfoFilters[0].categoryVariantInfoFilters={Gene_with_variant:t.Gene_with_variant,Variant_consequence_calculated:t.Variant_consequence_calculated,Variant_frequency_as_text:t.Variant_frequency_as_text}}addAnyRecordOfMulti(t){this.anyRecordOfMulti.push(t)}setCrossCountFields(t){this.crossCountFields=t}addSnpFilter(t){t.forEach(s=>{this.categoryFilters[s.search]=s.constraint.split(",")})}addRequiredField(t){this.requiredFields.push(t)}addField(t){this.fields.push(t)}addAnyRecordOf(t){this.anyRecordOf.push(t)}hasFilter(){var e,l,d,h,f,F,_,m,p;const t=((d=(l=(e=this.variantInfoFilters[0])==null?void 0:e.categoryVariantInfoFilters)==null?void 0:l.Gene_with_variant)==null?void 0:d.length)||0,s=((F=(f=(h=this.variantInfoFilters[0])==null?void 0:h.categoryVariantInfoFilters)==null?void 0:f.Variant_consequence_calculated)==null?void 0:F.length)||0,a=((p=(m=(_=this.variantInfoFilters[0])==null?void 0:_.categoryVariantInfoFilters)==null?void 0:m.Variant_frequency_as_text)==null?void 0:p.length)||0;return Object.keys(this.categoryFilters).length+Object.keys(this.numericFilters).length+t+s+a+this.requiredFields.length+this.anyRecordOf.length}}const q="\\DCC Harmonized data set",x="\\_harmonized_consent\\",y="\\_topmed_consents\\";function U(i=!0,t=c.hpds,s="COUNT"){let a=new n;if(i){const e=o(C).queryTemplate;e&&(a=new n(structuredClone(e)))}return o(I).forEach(e=>{e.filterType==="Categorical"?e.displayType==="restrict"?a.addCategoryFilter(e.id,e.categoryValues):a.addRequiredField(e.id):e.filterType==="numeric"?a.addNumericFilter(e.id,e.min||"",e.max||""):e.filterType==="genomic"?a.addCategoryVariantInfoFilters({Gene_with_variant:e.Gene_with_variant,Variant_consequence_calculated:e.Variant_consequence_calculated,Variant_frequency_as_text:e.Variant_frequency_as_text}):e.filterType==="snp"?a.addSnpFilter(e.snpValues):e.filterType==="AnyRecordOf"&&a.addAnyRecordOfMulti(e.concepts)}),o(O).forEach(e=>{e.conceptPath&&a.addField(e.conceptPath)}),i&&(a=R(a)),a.expectedResultType=s,{query:a,resourceUUID:t}}function k(i=!1,t="COUNT"){const s=i?c.openHPDS:c.hpds;let a=new n;if(!i){const e=o(C).queryTemplate;e&&(a=new n(structuredClone(e)))}return i||(a=R(a)),a.expectedResultType=t,{query:a,resourceUUID:s}}const R=i=>(!u(i.categoryFilters)&&!u(i.numericFilters)&&!g(i.fields)&&!g(i.requiredFields)&&i.removeCategoryFilter(x),o(T)||i.removeCategoryFilter(y),i),u=i=>Object.keys(i).some(t=>t.includes(q)),g=i=>i.some(t=>t.includes(q));export{n as Q,k as a,U as g,R as u};
