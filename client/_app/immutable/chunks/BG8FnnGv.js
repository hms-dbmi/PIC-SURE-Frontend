import{w as f}from"./DA0IzwqI.js";import{g as p,p as l,a as m}from"./BB8gGrUk.js";import{x as c}from"./DfqJWsAP.js";function u(s){return{...s,connection:s.connection?s.connection.uuid:"",roles:s.roles?s.roles.map(o=>o.uuid):[]}}const i="psama/user",a=f(!1),n=f([]);async function U(){if(c(a))return;const s=await p(i);n.set(s.map(u)),a.set(!0)}async function w(s){const t=c(n).find(r=>r.uuid===s);if(t)return t;const e=await p(`${i}/${s}`);return u(e)}async function b(s){const o=await l(i,[s]),t=u(o.content[0]),e=c(n);e.push(t),n.set(e)}async function x(s){const o=await m(i,[s]),t=u(o.content[0]),e=c(n),r=e.findIndex(d=>d.uuid===t.uuid);r===-1?e.push(t):e[r]=t,n.set(e)}const _={subscribe:n.subscribe,users:n,loadUsers:U,getUser:w,addUser:b,updateUser:x};export{_ as U};
