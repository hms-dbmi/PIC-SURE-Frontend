import{w as d,g as c}from"./DpyMT7OB.js";import{g as l,d as p,p as C,c as g}from"./BpV1Tt4c.js";const a="psama/connection",r=d(!1),o=d([]);async function u(){if(c(r))return;const s=await l(a);o.set(s),r.set(!0)}async function f(s){let e=c(o);e.length===0&&(await u(),e=c(o));const n=e.find(t=>t.uuid===s);if(n)return n;throw new Error("Connection not found.")}async function x(s){const n=(await g(a,[s])).content[0],t=c(o);t.push(n),o.set(t)}async function y(s){const n=(await C(a,[s]))[0],t=c(o),i=t.findIndex(w=>w.uuid===n.uuid);i===-1?t.push(n):t[i]=n,o.set(t)}async function h(s){const e=await f(s);await p(`${a}/${e.id}`);const n=c(o),t=n.findIndex(i=>i.uuid===s);t>-1&&(n.splice(t,1),o.set(n))}const I={subscribe:o.subscribe,connections:o,loadConnections:u,getConnection:f};export{I as C,x as a,o as c,h as d,f as g,u as l,y as u};
