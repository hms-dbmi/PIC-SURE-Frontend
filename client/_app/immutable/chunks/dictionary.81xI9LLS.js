import{p as o,u as d}from"./User.D1BG6p9P.js";import{p as f}from"./stores.CGSu9-ky.js";import{w as m}from"./entry.D9nKiiu7.js";import{r as u}from"./scheduler.bui7uCNy.js";const l="picsure/proxy/dictionary-api/",p="picsure/proxy/dictionary-api/concepts",h="picsure/proxy/dictionary-api/concepts/detail/",g=m({}),a=new Map;function y(n,e){!n||!e||(a.size>100&&a.clear(),a.set(n,e))}function b(n="",e,s){let t={facets:e,search:n};return u(f).url.pathname.includes("/discover")||(t=c(t)),o(`${p}?page_number=${s.pageNumber}&page_size=${s.pageSize}`,t)}function w(n){const e=n.map(s=>({name:s.name,values:s.facets.filter(t=>t.count===0).map(t=>t.name)})).reduce((s,t)=>(s[t.name]=t.values,s),{});console.log("Found the following facets that should be hidden: {}",e),g.set(e)}async function q(n,e){let s={facets:e,search:n};u(f).url.pathname.includes("/discover")||(s=c(s));const t=await o(`${l}facets/`,s);return e.length===0&&n.length===0&&w(t),t}async function z(n,e){const s=`${h}${e}`,t=String.raw`${n.replace(/\\\\/g,"\\")}`;if(a.has(t))return a.get(t);const r=await o(s,t);if(!r)throw new Error("No response");return y(t,r),r}function c(n){var s;const e=(s=u(d))==null?void 0:s.queryTemplate;if(e){const r=e.categoryFilters["\\_consents\\"];n.consents=r}return n}async function U(n=!1){let e={facets:[],search:"",consents:[]};return n||(e=c(e)),(await o(`${p}?page_number=1&page_size=1`,e)).totalElements}async function x(n=!1){let e={facets:[],search:"",consents:[]};n||(e=c(e));const t=(await o(`${l}facets/`,e)).find(i=>i.name==="dataset_id");return t?n?t.facets.length:t.facets.filter(i=>i.count>0).length:0}export{U as a,z as b,x as g,g as h,b as s,q as u};
