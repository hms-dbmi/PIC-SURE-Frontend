import{w as f}from"./zOfZnRfh.js";import{g as d,p as m,a as U}from"./Cbw8H9n5.js";import{r}from"./CseAM1pm.js";function i(s){return{...s,connection:s.connection?s.connection.uuid:"",roles:s.roles?s.roles.map(o=>o.uuid):[]}}const a="psama/user",u=f(!1),t=f([]);async function l(){if(r(u))return;const s=await d(a);t.set(s.map(i)),u.set(!0)}async function w(s){const e=r(t).find(c=>c.uuid===s);if(e)return e;const n=await d(`${a}/${s}`);return i(n)}async function E(s,o){let e=r(t);return e.length===0&&(await l(),e=r(t)),e.find(n=>n.email===s&&n.connection===o)}async function g(s){const o=await m(a,[s]),e=i(o[0]),n=r(t);n.push(e),t.set(n)}async function b(s){const o=await U(a,[s]),e=i(o[0]),n=r(t),c=n.findIndex(p=>p.uuid===e.uuid);c===-1?n.push(e):n[c]=e,t.set(n)}const _={subscribe:t.subscribe,users:t,loadUsers:l,getUser:w,addUser:g,updateUser:b};export{_ as U,g as a,w as b,E as g,b as u};
