import{s as Z,e as g,a as I,c as v,b as U,l as D,g as P,f as C,m as r,i as H,h,u as $,v as R,n as W,y as be,S as _e,q as Y,t as ge,d as ve,w as ye}from"./CseAM1pm.js";import{S as ee,i as te,t as G,g as re,a as Q,b as ue,d as le,e as ie,m as ne,f as ae}from"./CUD_i9MT.js";import{g as ke}from"./Dx2jxSvH.js";import{g as Ce}from"./xidBtgCA.js";import"./Cd9QPAjN.js";import{u as we,a as Te}from"./6olxXDPS.js";import{e as oe,u as Le,o as Ee}from"./Ba1MNdbe.js";import{p as qe}from"./wLQzkxGg.js";function Fe(s){let e,i='<i class="fa-solid fa-pen fa-xl"></i> <span class="sr-only">Edit</span>',a,t;return{c(){e=g("button"),e.innerHTML=i,this.h()},l(n){e=v(n,"BUTTON",{type:!0,title:!0,class:!0,"data-testid":!0,"data-svelte-h":!0}),D(e)!=="svelte-m763yc"&&(e.innerHTML=i),this.h()},h(){r(e,"type","button"),r(e,"title","Edit"),r(e,"class","btn-icon-color"),r(e,"data-testid","required-field-edit-btn")},m(n,u){H(n,e,u),a||(t=R(e,"click",s[10]),a=!0)},p:W,d(n){n&&C(e),a=!1,t()}}}function Ne(s){let e,i,a,t,n="Save",u,o,d,y,m;function F(l,p){if(l[5])return Ie;if(!l[6]&&!l[5])return Se}let k=F(s),c=k&&k(s);return{c(){e=g("button"),i=g("i"),a=I(),t=g("span"),t.textContent=n,o=I(),c&&c.c(),d=Y(),this.h()},l(l){e=v(l,"BUTTON",{type:!0,title:!0,"data-testid":!0,class:!0});var p=U(e);i=v(p,"I",{class:!0}),U(i).forEach(C),a=P(p),t=v(p,"SPAN",{class:!0,"data-svelte-h":!0}),D(t)!=="svelte-1958rfi"&&(t.textContent=n),p.forEach(C),o=P(l),c&&c.l(l),d=Y(),this.h()},h(){r(i,"class","fa-solid fa-floppy-disk fa-xl"),r(t,"class","sr-only"),r(e,"type","button"),r(e,"title","Save"),r(e,"data-testid","required-field-save-btn"),r(e,"class","btn-icon-color"),e.disabled=u=!s[2]||!s[3]||!s[5]},m(l,p){H(l,e,p),h(e,i),h(e,a),h(e,t),H(l,o,p),c&&c.m(l,p),H(l,d,p),y||(m=R(e,"click",s[7]),y=!0)},p(l,p){p&44&&u!==(u=!l[2]||!l[3]||!l[5])&&(e.disabled=u),k===(k=F(l))&&c?c.p(l,p):(c&&c.d(1),c=k&&k(l),c&&(c.c(),c.m(d.parentNode,d)))},d(l){l&&(C(e),C(o),C(d)),c&&c.d(l),y=!1,m()}}}function Se(s){let e,i='<i class="fa-solid fa-ban fa-xl"></i> <span class="sr-only">Cancel</span>',a,t;return{c(){e=g("button"),e.innerHTML=i,this.h()},l(n){e=v(n,"BUTTON",{type:!0,title:!0,class:!0,"data-testid":!0,"data-svelte-h":!0}),D(e)!=="svelte-1vgxcks"&&(e.innerHTML=i),this.h()},h(){r(e,"type","button"),r(e,"title","Cancel"),r(e,"class","btn-icon-color"),r(e,"data-testid","required-field-cancel-btn")},m(n,u){H(n,e,u),a||(t=R(e,"click",s[10]),a=!0)},p:W,d(n){n&&C(e),a=!1,t()}}}function Ie(s){let e,i='<i class="fa-solid fa-arrow-rotate-right fa-xl"></i> <span class="sr-only">Reset and cancel</span>',a,t;return{c(){e=g("button"),e.innerHTML=i,this.h()},l(n){e=v(n,"BUTTON",{type:!0,title:!0,class:!0,"data-testid":!0,"data-svelte-h":!0}),D(e)!=="svelte-1o0fjlv"&&(e.innerHTML=i),this.h()},h(){r(e,"type","button"),r(e,"title","Reset and cancel"),r(e,"class","btn-icon-color"),r(e,"data-testid","required-field-reset-btn")},m(n,u){H(n,e,u),a||(t=R(e,"click",s[8]),a=!0)},p:W,d(n){n&&C(e),a=!1,t()}}}function Pe(s){let e,i,a,t="Label:",n,u,o,d,y,m,F="ID:",k,c,l,p,w,_,b,f,M='<i class="fa-solid fa-trash fa-xl"></i> <span class="sr-only">Delete</span>',O,S,K;function B(L,E){return L[4]?Ne:Fe}let j=B(s),A=j(s);return{c(){e=g("div"),i=g("label"),a=g("span"),a.textContent=t,n=I(),u=g("input"),d=I(),y=g("label"),m=g("span"),m.textContent=F,k=I(),c=g("input"),w=I(),_=g("div"),A.c(),b=I(),f=g("button"),f.innerHTML=M,this.h()},l(L){e=v(L,"DIV",{class:!0,"data-testid":!0});var E=U(e);i=v(E,"LABEL",{class:!0});var V=U(i);a=v(V,"SPAN",{"data-svelte-h":!0}),D(a)!=="svelte-3s99bi"&&(a.textContent=t),n=P(V),u=v(V,"INPUT",{type:!0,class:!0,minlength:!0,maxlength:!0}),V.forEach(C),d=P(E),y=v(E,"LABEL",{class:!0});var z=U(y);m=v(z,"SPAN",{"data-svelte-h":!0}),D(m)!=="svelte-1dt9zf9"&&(m.textContent=F),k=P(z),c=v(z,"INPUT",{type:!0,class:!0,minlength:!0,maxlength:!0}),z.forEach(C),w=P(E),_=v(E,"DIV",{class:!0});var N=U(_);A.l(N),b=P(N),f=v(N,"BUTTON",{type:!0,title:!0,class:!0,"data-testid":!0,"data-svelte-h":!0}),D(f)!=="svelte-19una3f"&&(f.innerHTML=M),N.forEach(C),E.forEach(C),this.h()},h(){r(u,"type","text"),u.disabled=o=!s[4],r(u,"class","input"),r(u,"minlength","1"),r(u,"maxlength","255"),r(i,"class","label flex-1"),r(c,"type","text"),c.disabled=l=!s[4],r(c,"class",p="input "+(s[1]&&"variant-ghost-warning border-warning-500-400-token focus:border-warning-700-200-token")),r(c,"minlength","1"),r(c,"maxlength","255"),r(y,"class","label flex-1"),r(f,"type","button"),r(f,"title","Delete"),r(f,"class","btn-icon-color"),r(f,"data-testid","required-field-delete-btn"),r(_,"class","flex-none content-end py-2"),r(e,"class","flex gap-4 p-3 odd:bg-surface-100-800-token even:bg-surface-50-900-token"),r(e,"data-testid",O=`required-field-row-${s[0].id?s[0].id:"new"}`)},m(L,E){H(L,e,E),h(e,i),h(i,a),h(i,n),h(i,u),$(u,s[2]),h(e,d),h(e,y),h(y,m),h(y,k),h(y,c),$(c,s[3]),h(e,w),h(e,_),A.m(_,null),h(_,b),h(_,f),S||(K=[R(u,"input",s[11]),R(c,"input",s[12]),R(f,"click",s[9])],S=!0)},p(L,[E]){E&16&&o!==(o=!L[4])&&(u.disabled=o),E&4&&u.value!==L[2]&&$(u,L[2]),E&16&&l!==(l=!L[4])&&(c.disabled=l),E&2&&p!==(p="input "+(L[1]&&"variant-ghost-warning border-warning-500-400-token focus:border-warning-700-200-token"))&&r(c,"class",p),E&8&&c.value!==L[3]&&$(c,L[3]),j===(j=B(L))&&A?A.p(L,E):(A.d(1),A=j(L),A&&(A.c(),A.m(_,b))),E&1&&O!==(O=`required-field-row-${L[0].id?L[0].id:"new"}`)&&r(e,"data-testid",O)},i:W,o:W,d(L){L&&C(e),A.d(),S=!1,be(K)}}}function Ae(s,e,i){let a;const t=_e();let{field:n={label:"",id:""}}=e,{duplicate:u=!1}=e,o=n.label,d=n.id;const y=n.label===""||n.id==="";let m=y;const F=()=>{t("save",{previous:n,current:{label:o,id:d}}),i(4,m=!1)},k=()=>{i(2,o=n.label),i(3,d=n.id)},c=()=>t("delete",{label:o,id:d}),l=()=>i(4,m=!m);function p(){o=this.value,i(2,o)}function w(){d=this.value,i(3,d)}return s.$$set=_=>{"field"in _&&i(0,n=_.field),"duplicate"in _&&i(1,u=_.duplicate)},s.$$.update=()=>{s.$$.dirty&13&&i(5,a=n.id!==d||n.label!==o)},[n,u,o,d,m,a,y,F,k,c,l,p,w]}class me extends ee{constructor(e){super(),te(this,e,Ae,Pe,Z,{field:0,duplicate:1})}}function de(s,e,i){const a=s.slice();return a[11]=e[i],a[13]=i,a}function fe(s){let e,i;return e=new me({}),e.$on("save",s[4]),e.$on("delete",s[8]),{c(){le(e.$$.fragment)},l(a){ie(e.$$.fragment,a)},m(a,t){ne(e,a,t),i=!0},p:W,i(a){i||(G(e.$$.fragment,a),i=!0)},o(a){Q(e.$$.fragment,a),i=!1},d(a){ae(e,a)}}}function ce(s,e){let i,a,t;return a=new me({props:{duplicate:e[3](e[11]),field:e[11]}}),a.$on("save",e[4]),a.$on("delete",e[5]),{key:s,first:null,c(){i=Y(),le(a.$$.fragment),this.h()},l(n){i=Y(),ie(a.$$.fragment,n),this.h()},h(){this.first=i},m(n,u){H(n,i,u),ne(a,n,u),t=!0},p(n,u){e=n;const o={};u&1&&(o.duplicate=e[3](e[11])),u&1&&(o.field=e[11]),a.$set(o)},i(n){t||(G(a.$$.fragment,n),t=!0)},o(n){Q(a.$$.fragment,n),t=!1},d(n){n&&C(i),ae(a,n)}}}function pe(s){let e,i='<i class="fa-solid fa-triangle-exclamation"></i> <div class="alert-message"><p>Fields with the same ID may not function properly.</p></div>';return{c(){e=g("aside"),e.innerHTML=i,this.h()},l(a){e=v(a,"ASIDE",{"data-testid":!0,class:!0,"data-svelte-h":!0}),D(e)!=="svelte-rdnjrw"&&(e.innerHTML=i),this.h()},h(){r(e,"data-testid","validation-warn"),r(e,"class","alert variant-ghost-warning m-2")},m(a,t){H(a,e,t)},d(a){a&&C(e)}}}function Me(s){let e,i,a,t,n,u,o,d=[],y=new Map,m,F,k,c,l=s[1]&&fe(s),p=oe(s[0]);const w=b=>`${b[13]}-${b[11].label}-${b[11].id}`;for(let b=0;b<p.length;b+=1){let f=de(s,p,b),M=w(f);y.set(M,d[b]=ce(M,f))}let _=s[2].length>0&&pe();return{c(){e=g("fieldset"),i=g("legend"),a=ge(`Required Fields:
    `),t=g("button"),n=g("i"),u=I(),l&&l.c(),o=I();for(let b=0;b<d.length;b+=1)d[b].c();m=I(),_&&_.c(),this.h()},l(b){e=v(b,"FIELDSET",{class:!0});var f=U(e);i=v(f,"LEGEND",{class:!0});var M=U(i);a=ve(M,`Required Fields:
    `),t=v(M,"BUTTON",{type:!0,class:!0,title:!0,"data-testid":!0});var O=U(t);n=v(O,"I",{class:!0}),U(n).forEach(C),O.forEach(C),M.forEach(C),u=P(f),l&&l.l(f),o=P(f);for(let S=0;S<d.length;S+=1)d[S].l(f);m=P(f),_&&_.l(f),f.forEach(C),this.h()},h(){r(n,"class","fa-solid fa-square-plus fa-xl"),r(t,"type","button"),r(t,"class","text-primary-600-300-token hover:text-secondary-600-300-token"),r(t,"title","Add New Field"),r(t,"data-testid","required-field-new-btn"),t.disabled=s[1],r(i,"class","px-2 ml-2"),r(e,"class","border border-surface-300-600-token")},m(b,f){H(b,e,f),h(e,i),h(i,a),h(i,t),h(t,n),h(e,u),l&&l.m(e,null),h(e,o);for(let M=0;M<d.length;M+=1)d[M]&&d[M].m(e,null);h(e,m),_&&_.m(e,null),F=!0,k||(c=R(t,"click",s[7]),k=!0)},p(b,[f]){(!F||f&2)&&(t.disabled=b[1]),b[1]?l?(l.p(b,f),f&2&&G(l,1)):(l=fe(b),l.c(),G(l,1),l.m(e,o)):l&&(re(),Q(l,1,1,()=>{l=null}),ue()),f&57&&(p=oe(b[0]),re(),d=Le(d,f,w,1,b,p,y,e,Ee,ce,m,de),ue()),b[2].length>0?_||(_=pe(),_.c(),_.m(e,null)):_&&(_.d(1),_=null)},i(b){if(!F){G(l);for(let f=0;f<p.length;f+=1)G(d[f]);F=!0}},o(b){Q(l);for(let f=0;f<d.length;f+=1)Q(d[f]);F=!1},d(b){b&&C(e),l&&l.d();for(let f=0;f<d.length;f+=1)d[f].d();_&&_.d(),k=!1,c()}}}function Ue(s,e,i){let a,t,n;const u=_e();let{fields:o="[]"}=e;function d(l){return!!n.find(p=>p===l)}function y(l){u("update",{json:JSON.stringify(l)})}function m(l){const p=[...a];if(l.detail.previous.label===""||l.detail.previous.id==="")p.push(l.detail.current),i(1,t=!1);else{const w=p.findIndex(_=>_.label===l.detail.previous.label&&_.id===l.detail.previous.id);w>-1&&(p[w]=l.detail.current)}y(p)}function F(l){const p=a.filter(w=>w.label!==l.detail.label||w.id!==l.detail.id);y(p)}const k=()=>i(1,t=!t),c=()=>i(1,t=!1);return s.$$set=l=>{"fields"in l&&i(6,o=l.fields)},s.$$.update=()=>{s.$$.dirty&64&&i(0,a=qe(o)),s.$$.dirty&1&&i(1,t=a.length===0),s.$$.dirty&1&&i(2,n=a.filter(l=>a.filter(p=>p!==l).filter(p=>p.id===l.id).length>0))},[a,t,n,d,m,F,o,k,c]}class De extends ee{constructor(e){super(),te(this,e,Ue,Me,Z,{fields:6})}}function he(s){let e,i,a="UUID:",t,n,u;return{c(){e=g("label"),i=g("span"),i.textContent=a,t=I(),n=g("input"),this.h()},l(o){e=v(o,"LABEL",{class:!0});var d=U(e);i=v(d,"SPAN",{"data-svelte-h":!0}),D(i)!=="svelte-xruxbf"&&(i.textContent=a),t=P(d),n=v(d,"INPUT",{type:!0,class:!0}),d.forEach(C),this.h()},h(){var o;r(n,"type","text"),r(n,"class","input"),n.value=u=(o=s[0])==null?void 0:o.uuid,n.disabled=!0,r(e,"class","label")},m(o,d){H(o,e,d),h(e,i),h(e,t),h(e,n)},p(o,d){var y;d&1&&u!==(u=(y=o[0])==null?void 0:y.uuid)&&n.value!==u&&(n.value=u)},d(o){o&&C(e)}}}function He(s){var se;let e,i=`For details on how to set up a Connection, please refer to the
  <a href="https://pic-sure.gitbook.io/pic-sure-developer-guide/configuring-pic-sure/all-in-one-authentication-configuration#additional-authentication-configuration-option-s" target="_blank" class="anchor">PIC-SURE developer guide</a>.`,a,t,n,u,o,d="Label:",y,m,F,k,c,l="ID:",p,w,_,b,f,M="Sub Prefix:",O,S,K,B,j,A,L='<button type="submit" data-testid="connection-save-btn" class="btn variant-ghost-primary hover:variant-filled-primary">Save</button> <a href="/admin/configuration" data-testid="connection-cancel-btn" class="btn variant-ghost-secondary hover:variant-filled-secondary">Cancel</a>',E,V,z,N=((se=s[0])==null?void 0:se.uuid)&&he(s);return B=new De({props:{fields:s[4]}}),B.$on("update",s[5]),{c(){e=g("p"),e.innerHTML=i,a=I(),t=g("form"),N&&N.c(),n=I(),u=g("label"),o=g("span"),o.textContent=d,y=I(),m=g("input"),F=I(),k=g("label"),c=g("span"),c.textContent=l,p=I(),w=g("input"),_=I(),b=g("label"),f=g("span"),f.textContent=M,O=I(),S=g("input"),K=I(),le(B.$$.fragment),j=I(),A=g("div"),A.innerHTML=L,this.h()},l(T){e=v(T,"P",{class:!0,"data-svelte-h":!0}),D(e)!=="svelte-kaypeb"&&(e.innerHTML=i),a=P(T),t=v(T,"FORM",{class:!0});var q=U(t);N&&N.l(q),n=P(q),u=v(q,"LABEL",{class:!0});var J=U(u);o=v(J,"SPAN",{"data-svelte-h":!0}),D(o)!=="svelte-3s99bi"&&(o.textContent=d),y=P(J),m=v(J,"INPUT",{type:!0,class:!0,minlength:!0,maxlength:!0}),J.forEach(C),F=P(q),k=v(q,"LABEL",{class:!0});var x=U(k);c=v(x,"SPAN",{"data-svelte-h":!0}),D(c)!=="svelte-1dt9zf9"&&(c.textContent=l),p=P(x),w=v(x,"INPUT",{type:!0,class:!0,minlength:!0,maxlength:!0}),x.forEach(C),_=P(q),b=v(q,"LABEL",{class:!0});var X=U(b);f=v(X,"SPAN",{"data-svelte-h":!0}),D(f)!=="svelte-hkdo9q"&&(f.textContent=M),O=P(X),S=v(X,"INPUT",{type:!0,class:!0,minlength:!0,maxlength:!0}),X.forEach(C),K=P(q),ie(B.$$.fragment,q),j=P(q),A=v(q,"DIV",{"data-svelte-h":!0}),D(A)!=="svelte-1blu6n4"&&(A.innerHTML=L),q.forEach(C),this.h()},h(){r(e,"class","mb-3 text-center"),r(m,"type","text"),r(m,"class","input"),m.required=!0,r(m,"minlength","1"),r(m,"maxlength","255"),r(u,"class","label required"),r(w,"type","text"),r(w,"class","input"),w.required=!0,r(w,"minlength","1"),r(w,"maxlength","255"),r(k,"class","label required"),r(S,"type","text"),r(S,"class","input"),S.required=!0,r(S,"minlength","1"),r(S,"maxlength","255"),r(b,"class","label required"),r(t,"class","grid gap-4 my-3")},m(T,q){H(T,e,q),H(T,a,q),H(T,t,q),N&&N.m(t,null),h(t,n),h(t,u),h(u,o),h(u,y),h(u,m),$(m,s[1]),h(t,F),h(t,k),h(k,c),h(k,p),h(k,w),$(w,s[2]),h(t,_),h(t,b),h(b,f),h(b,O),h(b,S),$(S,s[3]),h(t,K),ne(B,t,null),h(t,j),h(t,A),E=!0,V||(z=[R(m,"input",s[7]),R(w,"input",s[8]),R(S,"input",s[9]),R(t,"submit",ye(s[6]))],V=!0)},p(T,[q]){var x;(x=T[0])!=null&&x.uuid?N?N.p(T,q):(N=he(T),N.c(),N.m(t,n)):N&&(N.d(1),N=null),q&2&&m.value!==T[1]&&$(m,T[1]),q&4&&w.value!==T[2]&&$(w,T[2]),q&8&&S.value!==T[3]&&$(S,T[3]);const J={};q&16&&(J.fields=T[4]),B.$set(J)},i(T){E||(G(B.$$.fragment,T),E=!0)},o(T){Q(B.$$.fragment,T),E=!1},d(T){T&&(C(e),C(a),C(t)),N&&N.d(),ae(B),V=!1,be(z)}}}function Be(s,e,i){const a=Ce();let{connection:t=void 0}=e,n=(t==null?void 0:t.label)||"",u=(t==null?void 0:t.id)||"",o=(t==null?void 0:t.subPrefix)||"",d=(t==null?void 0:t.requiredFields)||"[]";function y(l){i(4,d=l.detail.json)}async function m(){let l={id:u,label:n,requiredFields:d,subPrefix:o};try{t?(l={...l,uuid:t.uuid},await we(l)):await Te(l),a.trigger({message:`Successfully saved ${l&&"new "}connection '${n}'`,background:"variant-filled-success"}),ke("/admin/configuration")}catch(p){console.error(p),a.trigger({message:`An error occured while saving ${l&&"new "}connection '${n}'`,background:"variant-filled-error"})}}function F(){n=this.value,i(1,n)}function k(){u=this.value,i(2,u)}function c(){o=this.value,i(3,o)}return s.$$set=l=>{"connection"in l&&i(0,t=l.connection)},[t,n,u,o,d,y,m,F,k,c]}class Ge extends ee{constructor(e){super(),te(this,e,Be,He,Z,{connection:0})}}export{Ge as C};
