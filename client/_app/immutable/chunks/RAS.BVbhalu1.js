var c=Object.defineProperty;var u=(o,e,t)=>e in o?c(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var r=(o,e,t)=>u(o,typeof e!="symbol"?e+"":e,t);import{A as d}from"./AuthProviderRegistry.C01toUd8.js";import{p as h,l}from"./User.D1BG6p9P.js";class f extends d{constructor(t){super(t);r(this,"uri");r(this,"clientid");r(this,"state");r(this,"authenticate",async t=>{const s=this.getResponseMap(t).get("code");let a="";if(a=sessionStorage.getItem("state")||"",!s||a!==this.state)return!0;try{const i=await h("psama/okta/authentication",{code:s});return i!=null&&i.token?(l(i.token),!1):!0}catch(i){return console.error("Login Error: ",i),!0}});r(this,"login",async(t,n)=>{let s="/";s=this.getRedirectURI(),window.location.href=encodeURI(`${this.uri}/oauth2/default/v1/authorize?response_type=code&scope=openid&client_id=${this.clientid}&provider=${n}&redirect_uri=${s}&state=${this.state}`)});r(this,"logout",()=>{throw new Error("Method not implemented.")});this.uri=t.uri,this.clientid=t.clientid,this.state=t.state??this.generateRandomState()}generateRandomState(){const t=Math.random().toString(36).substring(2,15),n=new Date().getTime().toString(36);return t+n}}export{f as default};
