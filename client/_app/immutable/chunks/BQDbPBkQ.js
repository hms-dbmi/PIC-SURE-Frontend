import"./Bzak7iHL.js";import{p as ne,i as q,h as D,f as B,b as c,c as le,d as a,n as O,j as R,s as n,r as s,k as e,u as b,t as C,e as ce,a as de,l as m}from"./pV5yBOfK.js";import{d as pe,s as d}from"./D3FUfhzK.js";import{a as S}from"./CF-XIK1E.js";import{i as ue}from"./BAa5cEXk.js";import{a as fe}from"./B3YVaWvx.js";import{a as me,s as ve}from"./C2caA9Pm.js";import{u as ge,m as he,n as be,o as _e,t as F,q as ke}from"./tvkVmxlD.js";import{d as xe}from"./DR5Ig_-s.js";import{C as ye}from"./C24VzmQy.js";import{E as $e}from"./C6RsMIt9.js";import{M as we}from"./DBMsBZi4.js";import{L as G}from"./BK-nQ0m1.js";function Te(I,v){m(v,!e(v))}var Ee=B('<span id="expires-badge" data-testid="expires-badge"> </span>'),Pe=B('<div id="user-token" class="card preset-filled-sureface-500 svelte-ogor50"><header class="card-header"><h4>Personal Access Token</h4></header> <section class="p-4 grid grid-cols-2 gap-y-2 items-center svelte-ogor50"><label for="account" class="svelte-ogor50">Account:</label> <span id="account" class="w-full"> </span> <label for="token" class="svelte-ogor50">Token:</label> <div id="token"> </div> <label for="expires" class="svelte-ogor50">Expires:</label> <div><span id="expires" class="w-1/3 mr-2"> </span> <!></div></section> <footer class="card-footer mt-2"><!> <!> <button data-testid="reveal-btn" class="btn preset-tonal-primary border border-primary-500 hover:preset-filled-primary-500"> </button></footer></div>'),Ae=B('<div id="user-token-container" class="svelte-ogor50"><!></div>');function Se(I,v){var L;ne(v,!0);const g=()=>me(ge,"$user",J),[J,K]=ve(),N="Refresh",Q="••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••";let V=q(((L=g())==null?void 0:L.email)||"There was an error retrieving your account."),_=D(!1),k=D(!1),x=D(q(Promise.resolve(N))),y=b(()=>{var r;return(r=g())==null?void 0:r.token}),p=b(()=>e(y)?X(e(y)):0),$=b(()=>e(p)&&W());function W(){if(!e(p)||e(p)===0)return"unknown";const r=Math.floor((e(p)-Date.now())/(1e3*60*60*24));return e(p)<Date.now()?"expired":r<7?"expiring soon":"valid for "+r+" more days"}function X(r){if(!r)return 0;try{return ke(r)}catch(l){return console.error(l),F.error({title:"An error occured while parsing your token. Please try again later. If this problem persists, please contact an administrator."}),0}}function Y(){m(k,!0),m(x,_e().then(()=>"Refreshed!").catch(r=>(console.log("Error: ",r),F.error({title:"An error occured while refreshing your token. Please try again later. If this problem persists, please contact an administrator."}),"Error")).finally(xe(()=>{m(x,Promise.resolve("Refresh"),!0),m(k,!1)},5e3)),!0)}var w=Ae(),Z=a(w);S(Z,()=>be(!0,!0),r=>{G(r,{ring:!0,size:"medium"})},r=>{var l=Pe(),h=n(a(l),2),u=n(a(h),2),ee=a(u,!0);s(u);var T=n(u,4),re=a(T,!0);s(T);var U=n(T,4),E=a(U),te=a(E,!0);s(E);var oe=n(E,2);{var ae=t=>{var o=Ee(),i=a(o,!0);s(o),C(f=>{fe(o,1,`badge ${e($)??""}`),d(i,f)},[()=>e($).toUpperCase()]),c(t,o)};ue(oe,t=>{e($)&&t(ae)})}s(U),s(h);var M=n(h,2),z=a(M);{let t=b(()=>g().token||"");ye(z,{get itemToCopy(){return e(t)},class:"preset-tonal-primary border border-primary-500 hover:preset-filled-primary-500"})}var H=n(z,2);we(H,{"data-testid":"refresh",title:"Please Confirm",onconfirm:Y,get disabled(){return e(k)},triggerBase:"btn preset-tonal-primary border border-primary-500 hover:preset-filled-primary-500",footerButtons:!0,withDefault:!0,trigger:o=>{var i=ce(),f=de(i);S(f,()=>e(x),A=>{G(A,{ring:!0,size:"micro",label:"Refreshing"})},(A,ie)=>{var j=R();C(()=>d(j,e(ie))),c(A,j)}),c(o,i)},children:(o,i)=>{O();var f=R("Are you sure you wish to invalidate your old token and create a new one?");c(o,f)},$$slots:{trigger:!0,default:!0}});var P=n(H,2);P.__click=[Te,_];var se=a(P,!0);s(P),s(M),s(l),C(t=>{d(ee,V),d(re,e(_)?e(y):Q),d(te,t),d(se,e(_)?"Hide":"Reveal")},[()=>{var t,o,i;return(i=(o=he(((t=g())==null?void 0:t.token)||""))==null?void 0:o.toString())==null?void 0:i.substring(0,24)}]),c(r,l)},r=>{$e(r,{color:"warning",children:(l,h)=>{O();var u=R(`An error occured while to retrieving your account. If this problem persists, please contact an
      administrator.`);c(l,u)},$$slots:{default:!0}})}),s(w),c(I,w),le(),K()}pe(["click"]);export{Se as U};
