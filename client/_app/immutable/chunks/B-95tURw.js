import{s as te,e as g,a as N,c as v,b as M,q as B,g as S,f as k,r as s,i as O,h as p,y as J,z as j,n as Z,C as ge,V as ve,x as ee,t as Te,d as we,k as ye,A as Ee}from"./CDvIr29H.js";import{S as le,i as ie,t as W,g as de,a as Y,b as fe,d as ne,e as ae,m as se,f as re}from"./ByE-_V18.js";import{g as Le}from"./BMKj-mzl.js";import{g as qe}from"./VQmOc05J.js";import"./C1zJQccS.js";import{u as Fe,a as Ne}from"./iFuEiUsZ.js";import{a as ke}from"./BF5nqrJG.js";import{e as ce,u as Se,o as Ae}from"./mmDljT_r.js";import{p as Ie}from"./wLQzkxGg.js";function Pe(a){let e,l='<i class="fa-solid fa-pen fa-xl"></i> <span class="sr-only">Edit</span>',n,r;return{c(){e=g("button"),e.innerHTML=l,this.h()},l(t){e=v(t,"BUTTON",{type:!0,title:!0,class:!0,"data-testid":!0,"data-svelte-h":!0}),B(e)!=="svelte-m763yc"&&(e.innerHTML=l),this.h()},h(){s(e,"type","button"),s(e,"title","Edit"),s(e,"class","btn-icon-color"),s(e,"data-testid","required-field-edit-btn")},m(t,u){O(t,e,u),n||(r=j(e,"click",a[10]),n=!0)},p:Z,d(t){t&&k(e),n=!1,r()}}}function Me(a){let e,l,n,r,t="Save",u,o,c,h,L;function C(b,i){if(b[5])return Ue;if(!b[6]&&!b[5])return De}let T=C(a),d=T&&T(a);return{c(){e=g("button"),l=g("i"),n=N(),r=g("span"),r.textContent=t,o=N(),d&&d.c(),c=ee(),this.h()},l(b){e=v(b,"BUTTON",{type:!0,title:!0,"data-testid":!0,class:!0});var i=M(e);l=v(i,"I",{class:!0}),M(l).forEach(k),n=S(i),r=v(i,"SPAN",{class:!0,"data-svelte-h":!0}),B(r)!=="svelte-1958rfi"&&(r.textContent=t),i.forEach(k),o=S(b),d&&d.l(b),c=ee(),this.h()},h(){s(l,"class","fa-solid fa-floppy-disk fa-xl"),s(r,"class","sr-only"),s(e,"type","button"),s(e,"title","Save"),s(e,"data-testid","required-field-save-btn"),s(e,"class","btn-icon-color"),e.disabled=u=!a[2]||!a[3]||!a[5]},m(b,i){O(b,e,i),p(e,l),p(e,n),p(e,r),O(b,o,i),d&&d.m(b,i),O(b,c,i),h||(L=j(e,"click",a[7]),h=!0)},p(b,i){i&44&&u!==(u=!b[2]||!b[3]||!b[5])&&(e.disabled=u),T===(T=C(b))&&d?d.p(b,i):(d&&d.d(1),d=T&&T(b),d&&(d.c(),d.m(c.parentNode,c)))},d(b){b&&(k(e),k(o),k(c)),d&&d.d(b),h=!1,L()}}}function De(a){let e,l='<i class="fa-solid fa-ban fa-xl"></i> <span class="sr-only">Cancel</span>',n,r;return{c(){e=g("button"),e.innerHTML=l,this.h()},l(t){e=v(t,"BUTTON",{type:!0,title:!0,class:!0,"data-testid":!0,"data-svelte-h":!0}),B(e)!=="svelte-1vgxcks"&&(e.innerHTML=l),this.h()},h(){s(e,"type","button"),s(e,"title","Cancel"),s(e,"class","btn-icon-color"),s(e,"data-testid","required-field-cancel-btn")},m(t,u){O(t,e,u),n||(r=j(e,"click",a[10]),n=!0)},p:Z,d(t){t&&k(e),n=!1,r()}}}function Ue(a){let e,l='<i class="fa-solid fa-arrow-rotate-right fa-xl"></i> <span class="sr-only">Reset and cancel</span>',n,r;return{c(){e=g("button"),e.innerHTML=l,this.h()},l(t){e=v(t,"BUTTON",{type:!0,title:!0,class:!0,"data-testid":!0,"data-svelte-h":!0}),B(e)!=="svelte-1o0fjlv"&&(e.innerHTML=l),this.h()},h(){s(e,"type","button"),s(e,"title","Reset and cancel"),s(e,"class","btn-icon-color"),s(e,"data-testid","required-field-reset-btn")},m(t,u){O(t,e,u),n||(r=j(e,"click",a[8]),n=!0)},p:Z,d(t){t&&k(e),n=!1,r()}}}function He(a){let e,l,n,r="Label:",t,u,o,c,h,L,C="ID:",T,d,b,i,y,m,w,f,_='<i class="fa-solid fa-trash fa-xl"></i> <span class="sr-only">Delete</span>',A,V,I;function X(E,F){return E[4]?Me:Pe}let H=X(a),D=H(a);return{c(){e=g("div"),l=g("label"),n=g("span"),n.textContent=r,t=N(),u=g("input"),c=N(),h=g("label"),L=g("span"),L.textContent=C,T=N(),d=g("input"),y=N(),m=g("div"),D.c(),w=N(),f=g("button"),f.innerHTML=_,this.h()},l(E){e=v(E,"DIV",{class:!0,"data-testid":!0});var F=M(e);l=v(F,"LABEL",{class:!0});var G=M(l);n=v(G,"SPAN",{"data-svelte-h":!0}),B(n)!=="svelte-3s99bi"&&(n.textContent=r),t=S(G),u=v(G,"INPUT",{type:!0,class:!0,minlength:!0,maxlength:!0}),G.forEach(k),c=S(F),h=v(F,"LABEL",{class:!0});var z=M(h);L=v(z,"SPAN",{"data-svelte-h":!0}),B(L)!=="svelte-1dt9zf9"&&(L.textContent=C),T=S(z),d=v(z,"INPUT",{type:!0,class:!0,minlength:!0,maxlength:!0}),z.forEach(k),y=S(F),m=v(F,"DIV",{class:!0});var K=M(m);D.l(K),w=S(K),f=v(K,"BUTTON",{type:!0,title:!0,class:!0,"data-testid":!0,"data-svelte-h":!0}),B(f)!=="svelte-19una3f"&&(f.innerHTML=_),K.forEach(k),F.forEach(k),this.h()},h(){s(u,"type","text"),u.disabled=o=!a[4],s(u,"class","input"),s(u,"minlength","1"),s(u,"maxlength","255"),s(l,"class","label flex-1"),s(d,"type","text"),d.disabled=b=!a[4],s(d,"class",i="input "+(a[1]&&"variant-ghost-warning border-warning-500-400-token focus:border-warning-700-200-token")),s(d,"minlength","1"),s(d,"maxlength","255"),s(h,"class","label flex-1"),s(f,"type","button"),s(f,"title","Delete"),s(f,"class","btn-icon-color"),s(f,"data-testid","required-field-delete-btn"),s(m,"class","flex-none content-end py-2"),s(e,"class","flex gap-4 p-3 odd:bg-surface-100-800-token even:bg-surface-50-900-token"),s(e,"data-testid",A=`required-field-row-${a[0].id?a[0].id:"new"}`)},m(E,F){O(E,e,F),p(e,l),p(l,n),p(l,t),p(l,u),J(u,a[2]),p(e,c),p(e,h),p(h,L),p(h,T),p(h,d),J(d,a[3]),p(e,y),p(e,m),D.m(m,null),p(m,w),p(m,f),V||(I=[j(u,"input",a[11]),j(d,"input",a[12]),j(f,"click",a[9])],V=!0)},p(E,[F]){F&16&&o!==(o=!E[4])&&(u.disabled=o),F&4&&u.value!==E[2]&&J(u,E[2]),F&16&&b!==(b=!E[4])&&(d.disabled=b),F&2&&i!==(i="input "+(E[1]&&"variant-ghost-warning border-warning-500-400-token focus:border-warning-700-200-token"))&&s(d,"class",i),F&8&&d.value!==E[3]&&J(d,E[3]),H===(H=X(E))&&D?D.p(E,F):(D.d(1),D=H(E),D&&(D.c(),D.m(m,w))),F&1&&A!==(A=`required-field-row-${E[0].id?E[0].id:"new"}`)&&s(e,"data-testid",A)},i:Z,o:Z,d(E){E&&k(e),D.d(),V=!1,ge(I)}}}function Be(a,e,l){let n;const r=ve();let{field:t={label:"",id:""}}=e,{duplicate:u=!1}=e,o=t.label,c=t.id;const h=t.label===""||t.id==="";let L=h;const C=()=>{r("save",{previous:t,current:{label:o,id:c}}),l(4,L=!1)},T=()=>{l(2,o=t.label),l(3,c=t.id)},d=()=>r("delete",{label:o,id:c}),b=()=>l(4,L=!L);function i(){o=this.value,l(2,o)}function y(){c=this.value,l(3,c)}return a.$$set=m=>{"field"in m&&l(0,t=m.field),"duplicate"in m&&l(1,u=m.duplicate)},a.$$.update=()=>{a.$$.dirty&13&&l(5,n=t.id!==c||t.label!==o)},[t,u,o,c,L,n,h,C,T,d,b,i,y]}class Ce extends le{constructor(e){super(),ie(this,e,Be,He,te,{field:0,duplicate:1})}}function pe(a,e,l){const n=a.slice();return n[12]=e[l],n[14]=l,n}function he(a){let e,l;return e=new Ce({}),e.$on("save",a[4]),e.$on("delete",a[9]),{c(){ne(e.$$.fragment)},l(n){ae(e.$$.fragment,n)},m(n,r){se(e,n,r),l=!0},p:Z,i(n){l||(W(e.$$.fragment,n),l=!0)},o(n){Y(e.$$.fragment,n),l=!1},d(n){re(e,n)}}}function be(a,e){let l,n,r;return n=new Ce({props:{duplicate:e[3](e[12]),field:e[12]}}),n.$on("save",e[4]),n.$on("delete",e[5]),{key:a,first:null,c(){l=ee(),ne(n.$$.fragment),this.h()},l(t){l=ee(),ae(n.$$.fragment,t),this.h()},h(){this.first=l},m(t,u){O(t,l,u),se(n,t,u),r=!0},p(t,u){e=t;const o={};u&1&&(o.duplicate=e[3](e[12])),u&1&&(o.field=e[12]),n.$set(o)},i(t){r||(W(n.$$.fragment,t),r=!0)},o(t){Y(n.$$.fragment,t),r=!1},d(t){t&&k(l),re(n,t)}}}function _e(a){let e,l='<i class="fa-solid fa-triangle-exclamation"></i> <div class="alert-message"><p>Fields with the same ID may not function properly.</p></div>';return{c(){e=g("aside"),e.innerHTML=l,this.h()},l(n){e=v(n,"ASIDE",{"data-testid":!0,class:!0,"data-svelte-h":!0}),B(e)!=="svelte-rdnjrw"&&(e.innerHTML=l),this.h()},h(){s(e,"data-testid","validation-warn"),s(e,"class","alert variant-ghost-warning m-2")},m(n,r){O(n,e,r)},d(n){n&&k(e)}}}function Oe(a){let e,l,n,r,t,u,o,c,h=[],L=new Map,C,T,d,b,i=a[1]&&he(a),y=ce(a[0]);const m=f=>`${f[14]}-${f[12].label}-${f[12].id}`;for(let f=0;f<y.length;f+=1){let _=pe(a,y,f),A=m(_);L.set(A,h[f]=be(A,_))}let w=a[2].length>0&&_e();return{c(){e=g("fieldset"),l=g("legend"),n=Te(`Required Fields:
    `),r=g("button"),t=g("i"),o=N(),i&&i.c(),c=N();for(let f=0;f<h.length;f+=1)h[f].c();C=N(),w&&w.c(),this.h()},l(f){e=v(f,"FIELDSET",{class:!0});var _=M(e);l=v(_,"LEGEND",{class:!0});var A=M(l);n=we(A,`Required Fields:
    `),r=v(A,"BUTTON",{type:!0,class:!0,"aria-label":!0,title:!0,"data-testid":!0});var V=M(r);t=v(V,"I",{class:!0}),M(t).forEach(k),V.forEach(k),A.forEach(k),o=S(_),i&&i.l(_),c=S(_);for(let I=0;I<h.length;I+=1)h[I].l(_);C=S(_),w&&w.l(_),_.forEach(k),this.h()},h(){s(t,"class",u="fa-solid fa-square-plus fa-xl "+(a[1]?"opacity-50":"")),s(r,"type","button"),s(r,"class","text-primary-600-300-token hover:text-secondary-600-300-token"),s(r,"aria-label","Add New Field"),s(r,"title","Add New Field"),s(r,"data-testid","required-field-new-btn"),r.disabled=a[1],s(l,"class","px-2 ml-2"),s(e,"class","border border-surface-300-600-token")},m(f,_){O(f,e,_),p(e,l),p(l,n),p(l,r),p(r,t),p(e,o),i&&i.m(e,null),p(e,c);for(let A=0;A<h.length;A+=1)h[A]&&h[A].m(e,null);p(e,C),w&&w.m(e,null),T=!0,d||(b=j(r,"click",a[8]),d=!0)},p(f,[_]){(!T||_&2&&u!==(u="fa-solid fa-square-plus fa-xl "+(f[1]?"opacity-50":"")))&&s(t,"class",u),(!T||_&2)&&(r.disabled=f[1]),f[1]?i?(i.p(f,_),_&2&&W(i,1)):(i=he(f),i.c(),W(i,1),i.m(e,c)):i&&(de(),Y(i,1,1,()=>{i=null}),fe()),_&57&&(y=ce(f[0]),de(),h=Se(h,_,m,1,f,y,L,e,Ae,be,C,pe),fe()),f[2].length>0?w||(w=_e(),w.c(),w.m(e,null)):w&&(w.d(1),w=null)},i(f){if(!T){W(i);for(let _=0;_<y.length;_+=1)W(h[_]);T=!0}},o(f){Y(i);for(let _=0;_<h.length;_+=1)Y(h[_]);T=!1},d(f){f&&k(e),i&&i.d();for(let _=0;_<h.length;_+=1)h[_].d();w&&w.d(),d=!1,b()}}}function Re(a,e,l){let n,r,t,u;ye(a,ke,i=>l(7,u=i));const o=ve();let{fields:c="[]"}=e;function h(i){return!!t.find(y=>y===i)}function L(i){o("update",{json:JSON.stringify(i)})}function C(i){const y=[...n];if(i.detail.previous.label===""||i.detail.previous.id==="")y.push(i.detail.current),l(1,r=!1);else{const m=y.findIndex(w=>w.label===i.detail.previous.label&&w.id===i.detail.previous.id);m>-1&&(y[m]=i.detail.current)}L(y)}function T(i){const y=n.filter(m=>m.label!==i.detail.label||m.id!==i.detail.id);L(y)}const d=()=>l(1,r=!r),b=()=>l(1,r=!1);return a.$$set=i=>{"fields"in i&&l(6,c=i.fields)},a.$$.update=()=>{a.$$.dirty&64&&l(0,n=Ie(c)),a.$$.dirty&129&&l(1,r=n.length===0||!u),a.$$.dirty&1&&l(2,t=n.filter(i=>n.filter(y=>y!==i).filter(y=>y.id===i.id).length>0))},[n,r,t,h,C,T,c,u,d,b]}class je extends le{constructor(e){super(),ie(this,e,Re,Oe,te,{fields:6})}}function me(a){let e,l,n="UUID:",r,t,u;return{c(){e=g("label"),l=g("span"),l.textContent=n,r=N(),t=g("input"),this.h()},l(o){e=v(o,"LABEL",{class:!0});var c=M(e);l=v(c,"SPAN",{"data-svelte-h":!0}),B(l)!=="svelte-xruxbf"&&(l.textContent=n),r=S(c),t=v(c,"INPUT",{type:!0,class:!0}),c.forEach(k),this.h()},h(){var o;s(t,"type","text"),s(t,"class","input"),t.value=u=(o=a[0])==null?void 0:o.uuid,t.readOnly=!0,s(e,"class","label")},m(o,c){O(o,e,c),p(e,l),p(e,r),p(e,t)},p(o,c){var h;c&1&&u!==(u=(h=o[0])==null?void 0:h.uuid)&&t.value!==u&&(t.value=u)},d(o){o&&k(e)}}}function Ve(a){var oe;let e,l=`For details on how to set up a Connection, please refer to the
  <a href="https://pic-sure.gitbook.io/pic-sure-developer-guide/configuring-pic-sure/all-in-one-authentication-configuration#additional-authentication-configuration-option-s" target="_blank" class="anchor">PIC-SURE developer guide</a>.`,n,r,t,u,o,c,h="Label:",L,C,T,d,b,i="ID:",y,m,w,f,_,A="Sub Prefix:",V,I,X,H,D,E,F='<button type="submit" data-testid="connection-save-btn" class="btn variant-ghost-primary hover:variant-filled-primary">Save</button> <a href="/admin/configuration" data-testid="connection-cancel-btn" class="btn variant-ghost-secondary hover:variant-filled-secondary">Cancel</a>',G,z,K,ue,P=((oe=a[0])==null?void 0:oe.uuid)&&me(a);return H=new je({props:{fields:a[4]}}),H.$on("update",a[6]),{c(){e=g("p"),e.innerHTML=l,n=N(),r=g("form"),t=g("fieldset"),P&&P.c(),u=N(),o=g("label"),c=g("span"),c.textContent=h,L=N(),C=g("input"),T=N(),d=g("label"),b=g("span"),b.textContent=i,y=N(),m=g("input"),w=N(),f=g("label"),_=g("span"),_.textContent=A,V=N(),I=g("input"),X=N(),ne(H.$$.fragment),D=N(),E=g("div"),E.innerHTML=F,this.h()},l(q){e=v(q,"P",{class:!0,"data-svelte-h":!0}),B(e)!=="svelte-kaypeb"&&(e.innerHTML=l),n=S(q),r=v(q,"FORM",{class:!0});var R=M(r);t=v(R,"FIELDSET",{"data-testid":!0});var U=M(t);P&&P.l(U),u=S(U),o=v(U,"LABEL",{class:!0});var Q=M(o);c=v(Q,"SPAN",{"data-svelte-h":!0}),B(c)!=="svelte-3s99bi"&&(c.textContent=h),L=S(Q),C=v(Q,"INPUT",{type:!0,class:!0,minlength:!0,maxlength:!0}),Q.forEach(k),T=S(U),d=v(U,"LABEL",{class:!0});var x=M(d);b=v(x,"SPAN",{"data-svelte-h":!0}),B(b)!=="svelte-1dt9zf9"&&(b.textContent=i),y=S(x),m=v(x,"INPUT",{type:!0,class:!0,minlength:!0,maxlength:!0}),x.forEach(k),w=S(U),f=v(U,"LABEL",{class:!0});var $=M(f);_=v($,"SPAN",{"data-svelte-h":!0}),B(_)!=="svelte-hkdo9q"&&(_.textContent=A),V=S($),I=v($,"INPUT",{type:!0,class:!0,minlength:!0,maxlength:!0}),$.forEach(k),X=S(U),ae(H.$$.fragment,U),D=S(U),E=v(U,"DIV",{"data-svelte-h":!0}),B(E)!=="svelte-rkei74"&&(E.innerHTML=F),U.forEach(k),R.forEach(k),this.h()},h(){s(e,"class","mb-3 text-center"),s(C,"type","text"),s(C,"class","input"),C.required=!0,s(C,"minlength","1"),s(C,"maxlength","255"),s(o,"class","label required"),s(m,"type","text"),s(m,"class","input"),m.required=!0,s(m,"minlength","1"),s(m,"maxlength","255"),s(d,"class","label required"),s(I,"type","text"),s(I,"class","input"),I.required=!0,s(I,"minlength","1"),s(I,"maxlength","255"),s(f,"class","label required"),s(t,"data-testid","connection-form"),t.disabled=G=!a[5],s(r,"class","grid gap-4 my-3")},m(q,R){O(q,e,R),O(q,n,R),O(q,r,R),p(r,t),P&&P.m(t,null),p(t,u),p(t,o),p(o,c),p(o,L),p(o,C),J(C,a[1]),p(t,T),p(t,d),p(d,b),p(d,y),p(d,m),J(m,a[2]),p(t,w),p(t,f),p(f,_),p(f,V),p(f,I),J(I,a[3]),p(t,X),se(H,t,null),p(t,D),p(t,E),z=!0,K||(ue=[j(C,"input",a[8]),j(m,"input",a[9]),j(I,"input",a[10]),j(r,"submit",Ee(a[7]))],K=!0)},p(q,[R]){var Q;(Q=q[0])!=null&&Q.uuid?P?P.p(q,R):(P=me(q),P.c(),P.m(t,u)):P&&(P.d(1),P=null),R&2&&C.value!==q[1]&&J(C,q[1]),R&4&&m.value!==q[2]&&J(m,q[2]),R&8&&I.value!==q[3]&&J(I,q[3]);const U={};R&16&&(U.fields=q[4]),H.$set(U),(!z||R&32&&G!==(G=!q[5]))&&(t.disabled=G)},i(q){z||(W(H.$$.fragment,q),z=!0)},o(q){Y(H.$$.fragment,q),z=!1},d(q){q&&(k(e),k(n),k(r)),P&&P.d(),re(H),K=!1,ge(ue)}}}function ze(a,e,l){let n;ye(a,ke,i=>l(5,n=i));const r=qe();let{connection:t=void 0}=e,u=(t==null?void 0:t.label)||"",o=(t==null?void 0:t.id)||"",c=(t==null?void 0:t.subPrefix)||"",h=(t==null?void 0:t.requiredFields)||"[]";function L(i){l(4,h=i.detail.json)}async function C(){let i={id:o,label:u,requiredFields:h,subPrefix:c};try{t?(i={...i,uuid:t.uuid},await Fe(i)):await Ne(i),r.trigger({message:`Successfully saved ${i&&"new "}connection '${u}'`,background:"variant-filled-success"}),Le("/admin/configuration")}catch(y){console.error(y),r.trigger({message:`An error occured while saving ${i&&"new "}connection '${u}'`,background:"variant-filled-error"})}}function T(){u=this.value,l(1,u)}function d(){o=this.value,l(2,o)}function b(){c=this.value,l(3,c)}return a.$$set=i=>{"connection"in i&&l(0,t=i.connection)},[t,u,o,c,h,n,L,C,T,d,b]}class $e extends le{constructor(e){super(),ie(this,e,ze,Ve,te,{connection:0})}}export{$e as C};
