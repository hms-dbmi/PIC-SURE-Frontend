import{w as f,g as r}from"./DpyMT7OB.js";import{g as d,p as U,c as m}from"./BpV1Tt4c.js";function i(s){return{...s,connection:s.connection?s.connection.uuid:"",roles:s.roles?s.roles.map(o=>o.uuid):[]}}const a="psama/user",u=f(!1),t=f([]);async function l(){if(r(u))return;const s=await d(a);t.set(s.map(i)),u.set(!0)}async function w(s){const e=r(t).find(c=>c.uuid===s);if(e)return e;const n=await d(`${a}/${s}`);return i(n)}async function y(s,o){let e=r(t);return e.length===0&&(await l(),e=r(t)),e.find(n=>n.email===s&&n.connection===o)}async function x(s){const o=await m(a,[s]),e=i(o[0]),n=r(t);n.push(e),t.set(n)}async function h(s){const o=await U(a,[s]),e=i(o[0]),n=r(t),c=n.findIndex(p=>p.uuid===e.uuid);c===-1?n.push(e):n[c]=e,t.set(n)}const E={subscribe:t.subscribe,users:t,loadUsers:l,getUser:w};export{E as U,y as a,x as b,w as g,h as u};
