import{w as f}from"./BMKj-mzl.js";import{g as l,p as m,b as U}from"./BF5nqrJG.js";import{l as r}from"./CDvIr29H.js";function i(s){return{...s,connection:s.connection?s.connection.uuid:"",roles:s.roles?s.roles.map(o=>o.uuid):[]}}const a="psama/user",u=f(!1),t=f([]);async function d(){if(r(u))return;const s=await l(a);t.set(s.map(i)),u.set(!0)}async function w(s){const e=r(t).find(c=>c.uuid===s);if(e)return e;const n=await l(`${a}/${s}`);return i(n)}async function E(s,o){let e=r(t);return e.length===0&&(await d(),e=r(t)),e.find(n=>n.email===s&&n.connection===o)}async function b(s){const o=await m(a,[s]),e=i(o[0]),n=r(t);n.push(e),t.set(n)}async function g(s){const o=await U(a,[s]),e=i(o[0]),n=r(t),c=n.findIndex(p=>p.uuid===e.uuid);c===-1?n.push(e):n[c]=e,t.set(n)}const _={subscribe:t.subscribe,users:t,loadUsers:d,getUser:w,addUser:b,updateUser:g};export{_ as U,b as a,w as b,E as g,g as u};
