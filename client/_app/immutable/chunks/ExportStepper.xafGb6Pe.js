import{s as De,J as $e,e as g,a as S,c as $,b as w,g as T,f as m,m as v,i as D,h as _,K as ke,L as ye,M as Ee,k as se,v as pe,N as dt,H as Ue,I as xe,P as tt,R as pt,t as F,d as j,E as qe,j as ne,Q as de,q as oe,F as mt,u as me,a3 as _t,n as M,a6 as ht,l as H,U as Me,O as Ie,Y as Pe,Z as Ae}from"./scheduler.bui7uCNy.js";import{h as Ce,u as bt}from"./await_block.DenEio6G.js";import{S as Se,i as Te,t as y,g as ee,a as E,b as te,h as lt,c as rt,d as N,e as V,m as B,f as U,j as Le}from"./index.Divvo4fc.js";import{p as ge}from"./User.D1BG6p9P.js";import{b as vt}from"./index.Bt-Xh7oU.js";import{e as He}from"./each.Ct-HShz-.js";import{a as we}from"./index.D4B8xqkz.js";import{w as gt,g as $t}from"./entry.D9nKiiu7.js";import{A as Ve}from"./AngleButton.Fz8rojsH.js";import{T as kt}from"./Table.BpsTUvy6.js";import{E as at}from"./Export.CC8Iq2Jz.js";import{f as nt,t as st}from"./Filter.BoavJqGc.js";import{U as ot}from"./UserToken.Cp9kT_qm.js";import{C as yt}from"./CopyButton.BNNi8mRq.js";import"./ProgressBar.svelte_svelte_type_style_lang.B7SkmbeT.js";import{P as it}from"./ProgressRadial.CtNAsR5Q.js";import{T as Et,a as Ne,C as ct}from"./CodeBlock.iEDhD8KX.js";import{E as Be}from"./ErrorAlert.Bn1vPw-K.js";import{C as Fe}from"./CardButton.Dg6cVRuf.js";const ce=gt({current:0,total:0});function je(s,e,t){const l=s.slice();return l[10]=e[t],l}function Oe(s){let e,t,l,r,a=He(Array.from(Array(s[0].total).keys())),n=[];for(let i=0;i<a.length;i+=1)n[i]=ze(je(s,a,i));return{c(){e=g("header");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=$(i,"HEADER",{class:!0});var o=w(e);for(let c=0;c<n.length;c+=1)n[c].l(o);o.forEach(m),this.h()},h(){v(e,"class","stepper-header flex items-center border-t mt-[15px] mb-7 border-surface-400-500-token gap-4")},m(i,o){D(i,e,o);for(let c=0;c<n.length;c+=1)n[c]&&n[c].m(e,null);r=!0},p(i,o){if(o&3){a=He(Array.from(Array(i[0].total).keys()));let c;for(c=0;c<a.length;c+=1){const d=je(i,a,c);n[c]?n[c].p(d,o):(n[c]=ze(d),n[c].c(),n[c].m(e,null))}for(;c<n.length;c+=1)n[c].d(1);n.length=a.length}},i(i){r||(i&&tt(()=>{r&&(l&&l.end(1),t=lt(e,we,{duration:100}),t.start())}),r=!0)},o(i){t&&t.invalidate(),i&&(l=rt(e,we,{duration:100})),r=!1},d(i){i&&m(e),pt(n,i),i&&l&&l.end()}}}function ze(s){let e,t,l=(s[1](s[10])?`Step ${s[10]+1}`:s[10]+1)+"",r,a,n;return{c(){e=g("div"),t=g("span"),r=F(l),n=S(),this.h()},l(i){e=$(i,"DIV",{class:!0});var o=w(e);t=$(o,"SPAN",{class:!0});var c=w(t);r=j(c,l),c.forEach(m),n=T(o),o.forEach(m),this.h()},h(){v(t,"class",a="badge text-sm "+(s[1](s[10])?"variant-filled-primary":"variant-filled-surface")),v(e,"class","stepper-header-step -mt-[15px] transition-all duration-300"),qe(e,"flex-1",s[1](s[10]))},m(i,o){D(i,e,o),_(e,t),_(t,r),_(e,n)},p(i,o){o&3&&l!==(l=(i[1](i[10])?`Step ${i[10]+1}`:i[10]+1)+"")&&ne(r,l),o&3&&a!==(a="badge text-sm "+(i[1](i[10])?"variant-filled-primary":"variant-filled-surface"))&&v(t,"class",a),o&3&&qe(e,"flex-1",i[1](i[10]))},d(i){i&&m(e)}}}function Ct(s){let e,t,l,r,a,n=s[0].total&&Oe(s);const i=s[5].default,o=$e(i,s,s[4],null);return{c(){e=g("div"),n&&n.c(),t=S(),l=g("div"),o&&o.c(),this.h()},l(c){e=$(c,"DIV",{class:!0,"data-testid":!0});var d=w(e);n&&n.l(d),t=T(d),l=$(d,"DIV",{class:!0});var f=w(l);o&&o.l(f),f.forEach(m),d.forEach(m),this.h()},h(){v(l,"class","stepper-content"),v(e,"class",r="stepper space-y-4 "+(s[2].class??"")),v(e,"data-testid","stepper")},m(c,d){D(c,e,d),n&&n.m(e,null),_(e,t),_(e,l),o&&o.m(l,null),a=!0},p(c,[d]){c[0].total?n?(n.p(c,d),d&1&&y(n,1)):(n=Oe(c),n.c(),y(n,1),n.m(e,t)):n&&(ee(),E(n,1,1,()=>{n=null}),te()),o&&o.p&&(!a||d&16)&&ke(o,i,c,c[4],a?Ee(i,c[4],d,null):ye(c[4]),null),(!a||d&4&&r!==(r="stepper space-y-4 "+(c[2].class??"")))&&v(e,"class",r)},i(c){a||(y(n),y(o,c),a=!0)},o(c){E(n),E(o,c),a=!1},d(c){c&&m(e),n&&n.d(),o&&o.d(c)}}}function wt(s,e,t){let l,r;se(s,ce,u=>t(0,r=u));let{$$slots:a={},$$scope:n}=e,{buttonCompleteLabel:i=""}=e;pe("buttonCompleteLabel",i),pe("state",ce);const o=dt();async function c(u){await new Promise(h=>setTimeout(h)),!u&&(o("next",{step:r.current,state:r}),de(ce,r.current++,r))}function d(){o("back",{step:r.current,state:r}),de(ce,r.current=r.current===1?0:r.current-1,r)}function f(u,h){h||o("complete",{step:u,state:r})}return pe("onBack",d),pe("onNext",c),pe("onComplete",f),s.$$set=u=>{t(2,e=Ue(Ue({},e),xe(u))),"buttonCompleteLabel"in u&&t(3,i=u.buttonCompleteLabel),"$$scope"in u&&t(4,n=u.$$scope)},s.$$.update=()=>{s.$$.dirty&1&&t(1,l=u=>u===r.current)},e=xe(e),[r,l,e,i,n,a]}class Dt extends Se{constructor(e){super(),Te(this,e,wt,Ct,De,{buttonCompleteLabel:3})}}const It=s=>({}),Qe=s=>({}),St=s=>({}),Ge=s=>({});function We(s){let e,t,l,r,a,n;const i=s[9].header,o=$e(i,s,s[13],Ge),c=s[9].default,d=$e(c,s,s[13],null),f=d||Tt(s);let u=s[6].total>1&&Xe(s);return{c(){e=g("div"),t=g("header"),o&&o.c(),l=S(),r=g("div"),f&&f.c(),a=S(),u&&u.c(),this.h()},l(h){e=$(h,"DIV",{class:!0,"data-testid":!0});var k=w(e);t=$(k,"HEADER",{class:!0});var I=w(t);o&&o.l(I),I.forEach(m),l=T(k),r=$(k,"DIV",{class:!0});var p=w(r);f&&f.l(p),p.forEach(m),a=T(k),u&&u.l(k),k.forEach(m),this.h()},h(){v(t,"class","step-header text-2xl font-bold"),v(r,"class","step-content space-y-4 px-2"),v(e,"class","step space-y-4"),v(e,"data-testid","step-"+(s[7]+1))},m(h,k){D(h,e,k),_(e,t),o&&o.m(t,null),_(e,l),_(e,r),f&&f.m(r,null),_(e,a),u&&u.m(e,null),n=!0},p(h,k){o&&o.p&&(!n||k&8192)&&ke(o,i,h,h[13],n?Ee(i,h[13],k,St):ye(h[13]),Ge),d&&d.p&&(!n||k&8192)&&ke(d,c,h,h[13],n?Ee(c,h[13],k,null):ye(h[13]),null),h[6].total>1?u?(u.p(h,k),k&64&&y(u,1)):(u=Xe(h),u.c(),y(u,1),u.m(e,null)):u&&(ee(),E(u,1,1,()=>{u=null}),te())},i(h){n||(y(o,h),y(f,h),y(u),n=!0)},o(h){E(o,h),E(f,h),E(u),n=!1},d(h){h&&m(e),o&&o.d(h),f&&f.d(h),u&&u.d()}}}function Tt(s){let e,t=s[7]+1+"",l,r;return{c(){e=F("(Step "),l=F(t),r=F(" Content)")},l(a){e=j(a,"(Step "),l=j(a,t),r=j(a," Content)")},m(a,n){D(a,e,n),D(a,l,n),D(a,r,n)},p:M,d(a){a&&(m(e),m(l),m(r))}}}function Xe(s){let e,t,l,r,a,n,i,o,c;const d=[At,Pt,Rt],f=[];function u(p,b){return p[8].navigation?0:p[7]!==0?1:2}t=u(s),l=f[t]=d[t](s);const h=[Vt,Nt],k=[];function I(p,b){return p[7]<p[6].total-1?0:1}return a=I(s),n=k[a]=h[a](s),{c(){e=g("div"),l.c(),r=S(),n.c(),this.h()},l(p){e=$(p,"DIV",{class:!0});var b=w(e);l.l(b),r=T(b),n.l(b),b.forEach(m),this.h()},h(){v(e,"class","step-navigation flex justify-between gap-4")},m(p,b){D(p,e,b),f[t].m(e,null),_(e,r),k[a].m(e,null),c=!0},p(p,b){let L=t;t=u(p),t===L?f[t].p(p,b):(ee(),E(f[L],1,1,()=>{f[L]=null}),te(),l=f[t],l?l.p(p,b):(l=f[t]=d[t](p),l.c()),y(l,1),l.m(e,r));let R=a;a=I(p),a===R?k[a].p(p,b):(ee(),E(k[R],1,1,()=>{k[R]=null}),te(),n=k[a],n?n.p(p,b):(n=k[a]=h[a](p),n.c()),y(n,1),n.m(e,null))},i(p){c||(y(l),y(n),p&&tt(()=>{c&&(o&&o.end(1),i=lt(e,we,{duration:100}),i.start())}),c=!0)},o(p){E(l),E(n),i&&i.invalidate(),p&&(o=rt(e,we,{duration:100})),c=!1},d(p){p&&m(e),f[t].d(),k[a].d(),p&&o&&o.end()}}}function Rt(s){let e;return{c(){e=g("div")},l(t){e=$(t,"DIV",{}),w(e).forEach(m)},m(t,l){D(t,e,l)},p:M,i:M,o:M,d(t){t&&m(e)}}}function Pt(s){let e,t;return e=new Ve({props:{disabled:s[6].current===0,$$slots:{default:[Lt]},$$scope:{ctx:s}}}),e.$on("click",s[10]),{c(){N(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,r){B(e,l,r),t=!0},p(l,r){const a={};r&64&&(a.disabled=l[6].current===0),r&8192&&(a.$$scope={dirty:r,ctx:l}),e.$set(a)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){U(e,l)}}}function At(s){let e,t;const l=s[9].navigation,r=$e(l,s,s[13],Qe);return{c(){e=g("div"),r&&r.c(),this.h()},l(a){e=$(a,"DIV",{class:!0});var n=w(e);r&&r.l(n),n.forEach(m),this.h()},h(){v(e,"class","step-navigation-slot")},m(a,n){D(a,e,n),r&&r.m(e,null),t=!0},p(a,n){r&&r.p&&(!t||n&8192)&&ke(r,l,a,a[13],t?Ee(l,a[13],n,It):ye(a[13]),Qe)},i(a){t||(y(r,a),t=!0)},o(a){E(r,a),t=!1},d(a){a&&m(e),r&&r.d(a)}}}function Lt(s){let e;return{c(){e=F("Back")},l(t){e=j(t,"Back")},m(t,l){D(t,e,l)},d(t){t&&m(e)}}}function Nt(s){let e,t;return e=new Ve({props:{name:s[1]||"complete",angle:"right",variant:"filled",disabled:s[0],$$slots:{default:[Bt]},$$scope:{ctx:s}}}),e.$on("click",s[12]),{c(){N(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,r){B(e,l,r),t=!0},p(l,r){const a={};r&2&&(a.name=l[1]||"complete"),r&1&&(a.disabled=l[0]),r&8194&&(a.$$scope={dirty:r,ctx:l}),e.$set(a)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){U(e,l)}}}function Vt(s){let e,t;return e=new Ve({props:{name:"next",angle:"right",variant:"filled",disabled:s[0],$$slots:{default:[Ut]},$$scope:{ctx:s}}}),e.$on("click",s[11]),{c(){N(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,r){B(e,l,r),t=!0},p(l,r){const a={};r&1&&(a.disabled=l[0]),r&8192&&(a.$$scope={dirty:r,ctx:l}),e.$set(a)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){U(e,l)}}}function Bt(s){let e=(s[1]||"Complete")+"",t;return{c(){t=F(e)},l(l){t=j(l,e)},m(l,r){D(l,t,r)},p(l,r){r&2&&e!==(e=(l[1]||"Complete")+"")&&ne(t,e)},d(l){l&&m(t)}}}function Ut(s){let e;return{c(){e=F("Next")},l(t){e=j(t,"Next")},m(t,l){D(t,e,l)},d(t){t&&m(e)}}}function xt(s){let e,t,l=s[7]===s[6].current&&We(s);return{c(){l&&l.c(),e=oe()},l(r){l&&l.l(r),e=oe()},m(r,a){l&&l.m(r,a),D(r,e,a),t=!0},p(r,[a]){r[7]===r[6].current?l?(l.p(r,a),a&64&&y(l,1)):(l=We(r),l.c(),y(l,1),l.m(e.parentNode,e)):l&&(ee(),E(l,1,1,()=>{l=null}),te())},i(r){t||(y(l),t=!0)},o(r){E(l),t=!1},d(r){r&&m(e),l&&l.d(r)}}}function qt(s,e,t){let l,r=M,a=()=>(r(),r=ht(f,R=>t(6,l=R)),f);s.$$.on_destroy.push(()=>r());let{$$slots:n={},$$scope:i}=e;const o=mt(n);let{locked:c=!1}=e,{buttonCompleteLabel:d=me("buttonCompleteLabel")}=e,{state:f=me("state")}=e;a();let{onNext:u=me("onNext")}=e,{onBack:h=me("onBack")}=e,{onComplete:k=me("onComplete")}=e;const I=l.total;de(f,l.total++,l),_t(()=>{de(f,l.total--,l)});const p=()=>h(),b=()=>u(c),L=()=>k(I,c);return s.$$set=R=>{"locked"in R&&t(0,c=R.locked),"buttonCompleteLabel"in R&&t(1,d=R.buttonCompleteLabel),"state"in R&&a(t(2,f=R.state)),"onNext"in R&&t(3,u=R.onNext),"onBack"in R&&t(4,h=R.onBack),"onComplete"in R&&t(5,k=R.onComplete),"$$scope"in R&&t(13,i=R.$$scope)},[c,d,f,u,h,k,l,I,o,n,p,b,L,i]}class _e extends Se{constructor(e){super(),Te(this,e,qt,xt,De,{locked:0,buttonCompleteLabel:1,state:2,onNext:3,onBack:4,onComplete:5})}}function Mt(s){let e,t,l,r='<label for="summary" class="mr-8 font-bold">Summary:</label>',a,n,i,o,c,d,f="Participants",u,h,k,I,p,b,L="Variables",R,P,A,X,G,O,le="Data Points";return{c(){e=g("div"),t=g("div"),l=g("div"),l.innerHTML=r,a=S(),n=g("div"),i=g("span"),o=F(s[1]),c=S(),d=g("label"),d.textContent=f,u=S(),h=g("div"),k=g("span"),I=F(s[0]),p=S(),b=g("label"),b.textContent=L,R=S(),P=g("div"),A=g("span"),X=F(s[2]),G=S(),O=g("label"),O.textContent=le,this.h()},l(Q){e=$(Q,"DIV",{id:!0,class:!0});var W=w(e);t=$(W,"DIV",{id:!0,class:!0});var Y=w(t);l=$(Y,"DIV",{class:!0,"data-svelte-h":!0}),H(l)!=="svelte-1vd72fa"&&(l.innerHTML=r),a=T(Y),n=$(Y,"DIV",{class:!0});var x=w(n);i=$(x,"SPAN",{id:!0,class:!0});var q=w(i);o=j(q,s[1]),q.forEach(m),c=T(x),d=$(x,"LABEL",{for:!0,"data-svelte-h":!0}),H(d)!=="svelte-1te5h4m"&&(d.textContent=f),x.forEach(m),u=T(Y),h=$(Y,"DIV",{class:!0});var z=w(h);k=$(z,"SPAN",{id:!0,class:!0});var K=w(k);I=j(K,s[0]),K.forEach(m),p=T(z),b=$(z,"LABEL",{for:!0,"data-svelte-h":!0}),H(b)!=="svelte-j0nyhs"&&(b.textContent=L),z.forEach(m),R=T(Y),P=$(Y,"DIV",{class:!0});var re=w(P);A=$(re,"SPAN",{id:!0,class:!0});var ae=w(A);X=j(ae,s[2]),ae.forEach(m),G=T(re),O=$(re,"LABEL",{for:!0,"data-svelte-h":!0}),H(O)!=="svelte-kgfncs"&&(O.textContent=le),re.forEach(m),Y.forEach(m),W.forEach(m),this.h()},h(){v(l,"class","text-xl"),v(i,"id","participants"),v(i,"class","mr-2"),v(d,"for","participants"),v(n,"class","flex justify-left text-xl font-light"),v(k,"id","variables"),v(k,"class","mr-2"),v(b,"for","variables"),v(h,"class","flex justify-left text-xl font-light"),v(A,"id","dataPoints"),v(A,"class","mr-2"),v(O,"for","dataPoints"),v(P,"class","flex justify-left text-xl font-light"),v(t,"id","summary"),v(t,"class","w-full grid grid-flow-col auto-cols-auto"),v(e,"id","stats"),v(e,"class","w-full flex justify-evenly mb-5 pb-2 svelte-11yjabd")},m(Q,W){D(Q,e,W),_(e,t),_(t,l),_(t,a),_(t,n),_(n,i),_(i,o),_(n,c),_(n,d),_(t,u),_(t,h),_(h,k),_(k,I),_(h,p),_(h,b),_(t,R),_(t,P),_(P,A),_(A,X),_(P,G),_(P,O)},p(Q,[W]){W&2&&ne(o,Q[1]),W&1&&ne(I,Q[0]),W&4&&ne(X,Q[2])},i:M,o:M,d(Q){Q&&m(e)}}}function Ht(s,e,t){let l,r,a,n,i,o;se(s,nt,d=>t(5,i=d)),se(s,st,d=>t(6,o=d));let{exports:c}=at;return se(s,c,d=>t(4,n=d)),s.$$.update=()=>{s.$$.dirty&64&&t(1,l=o),s.$$.dirty&48&&t(0,r=i.length+n.length),s.$$.dirty&3&&t(2,a=typeof l=="number"?l*r:0)},[r,l,a,c,n,i,o]}class Re extends Se{constructor(e){super(),Te(this,e,Ht,Mt,De,{})}}async function Ft(s,e){if(e===""&&e.trim()==="")throw"Please input a Dataset ID name";const t=/^[\w \-\\/?+=[\].():"']+$/g;if(!e.match(t))throw`Name can only contain letters, numbers, and these special symbols - ? + = [ ] . ( ) : ' "`;return await ge("picsure/dataset/named",{queryId:s,name:e})}function jt(s){let e,t,l,r,a={ctx:s,current:null,token:null,hasCatch:!0,pending:Gt,then:Qt,catch:zt,blocks:[,,,]};return Ce(e=s[5],a),l=new kt({props:{tableName:"ExportSummary",data:s[3],columns:s[14]}}),{c(){a.block.c(),t=S(),N(l.$$.fragment)},l(n){a.block.l(n),t=T(n),V(l.$$.fragment,n)},m(n,i){a.block.m(n,a.anchor=i),a.mount=()=>t.parentNode,a.anchor=t,D(n,t,i),B(l,n,i),r=!0},p(n,i){s=n,a.ctx=s,i[0]&32&&e!==(e=s[5])&&Ce(e,a);const o={};i[0]&8&&(o.data=s[3]),l.$set(o)},i(n){r||(y(a.block),y(l.$$.fragment,n),r=!0)},o(n){for(let i=0;i<3;i+=1){const o=a.blocks[i];E(o)}E(l.$$.fragment,n),r=!1},d(n){n&&m(t),a.block.d(n),a.token=null,a=null,U(l,n)}}}function Ot(s){let e,t,l='<i class="fa-solid fa-triangle-exclamation text-4xl"></i>',r,a,n=`<h3 class="h3">Warning</h3> <p>Warning: Your selected data exceeds 1,000,000 estimated data points, which is too
                large to export. Please reduce the data selection or the number of selected
                participants.</p>`,i,o,c,d="Back",f,u;return{c(){e=g("aside"),t=g("div"),t.innerHTML=l,r=S(),a=g("div"),a.innerHTML=n,i=S(),o=g("div"),c=g("button"),c.textContent=d,this.h()},l(h){e=$(h,"ASIDE",{class:!0});var k=w(e);t=$(k,"DIV",{"data-svelte-h":!0}),H(t)!=="svelte-1dz1fc7"&&(t.innerHTML=l),r=T(k),a=$(k,"DIV",{class:!0,"data-svelte-h":!0}),H(a)!=="svelte-e8x9nn"&&(a.innerHTML=n),i=T(k),o=$(k,"DIV",{class:!0});var I=w(o);c=$(I,"BUTTON",{class:!0,"data-svelte-h":!0}),H(c)!=="svelte-1datm77"&&(c.textContent=d),I.forEach(m),k.forEach(m),this.h()},h(){v(a,"class","alert-message"),v(c,"class","btn variant-filled"),v(o,"class","alert-actions dark"),v(e,"class","alert variant-filled-error")},m(h,k){D(h,e,k),_(e,t),_(e,r),_(e,a),_(e,i),_(e,o),_(o,c),f||(u=Ie(c,"click",s[21]),f=!0)},p:M,i:M,o:M,d(h){h&&m(e),f=!1,u()}}}function zt(s){let e,t,l;return t=new Be({props:{title:`An error occurred while preparing your dataset. Please try again. If this problem persists, please
                  contact an administrator.`}}),{c(){e=g("div"),N(t.$$.fragment),this.h()},l(r){e=$(r,"DIV",{class:!0});var a=w(e);V(t.$$.fragment,a),a.forEach(m),this.h()},h(){v(e,"class","flex justify-center mb-4")},m(r,a){D(r,e,a),B(t,e,null),l=!0},i(r){l||(y(t.$$.fragment,r),l=!0)},o(r){E(t.$$.fragment,r),l=!1},d(r){r&&m(e),U(t)}}}function Qt(s){return{c:M,l:M,m:M,i:M,o:M,d:M}}function Gt(s){let e,t,l,r="Preparing your dataset...",a;return e=new it({props:{width:"w-4"}}),{c(){N(e.$$.fragment),t=S(),l=g("div"),l.textContent=r},l(n){V(e.$$.fragment,n),t=T(n),l=$(n,"DIV",{"data-svelte-h":!0}),H(l)!=="svelte-1m53t1h"&&(l.textContent=r)},m(n,i){B(e,n,i),D(n,t,i),D(n,l,i),a=!0},i(n){a||(y(e.$$.fragment,n),a=!0)},o(n){E(e.$$.fragment,n),a=!1},d(n){n&&(m(t),m(l)),U(e,n)}}}function Wt(s){let e,t,l,r,a,n,i;t=new Re({});const o=[Ot,jt],c=[];function d(f,u){return f[20]()?0:1}return a=d(s),n=c[a]=o[a](s),{c(){e=g("div"),N(t.$$.fragment),l=S(),r=g("section"),n.c(),this.h()},l(f){e=$(f,"DIV",{id:!0,class:!0});var u=w(e);V(t.$$.fragment,u),l=T(u),r=$(u,"SECTION",{class:!0});var h=w(r);n.l(h),h.forEach(m),u.forEach(m),this.h()},h(){v(r,"class","w-full"),v(e,"id","first-step-container"),v(e,"class","flex flex-col w-full h-full items-center")},m(f,u){D(f,e,u),B(t,e,null),_(e,l),_(e,r),c[a].m(r,null),i=!0},p(f,u){n.p(f,u)},i(f){i||(y(t.$$.fragment,f),y(n),i=!0)},o(f){E(t.$$.fragment,f),E(n),i=!1},d(f){f&&m(e),U(t),c[a].d()}}}function Xt(s){let e;return{c(){e=F("Review Cohort Details:")},l(t){e=j(t,"Review Cohort Details:")},m(t,l){D(t,e,l)},d(t){t&&m(e)}}}function Ye(s){let e,t;return e=new _e({props:{$$slots:{header:[Jt],default:[Yt]},$$scope:{ctx:s}}}),{c(){N(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,r){B(e,l,r),t=!0},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){U(e,l)}}}function Yt(s){let e,t,l,r,a=`<header class="card-header">Select <strong>additional variables</strong> you would like to be included in your final
            data export.</header> <hr/> <div class="card-body p-4">Tree Component Here</div>`,n;return t=new Re({}),{c(){e=g("section"),N(t.$$.fragment),l=S(),r=g("div"),r.innerHTML=a,this.h()},l(i){e=$(i,"SECTION",{class:!0});var o=w(e);V(t.$$.fragment,o),l=T(o),r=$(o,"DIV",{class:!0,"data-svelte-h":!0}),H(r)!=="svelte-1l9s757"&&(r.innerHTML=a),o.forEach(m),this.h()},h(){v(r,"class","w-full h-full m-2 card p-4"),v(e,"class","flex flex-col w-full h-full items-center")},m(i,o){D(i,e,o),B(t,e,null),_(e,l),_(e,r),n=!0},p:M,i(i){n||(y(t.$$.fragment,i),n=!0)},o(i){E(t.$$.fragment,i),n=!1},d(i){i&&m(e),U(t)}}}function Jt(s){let e;return{c(){e=F("Finalize Data:")},l(t){e=j(t,"Finalize Data:")},m(t,l){D(t,e,l)},d(t){t&&m(e)}}}function Kt(s){let e,t,l,r,a,n,i,o;return t=new Re({}),a=new Fe({props:{"data-testid":"csv-export-option",title:"Export as Data Frame or CSV",subtitle:"Export data as a Python or R data frame or a comma-separated values file",size:"other",class:"card variant-ringed-primary",active:s[1]==="DATAFRAME"}}),a.$on("click",s[22]),i=new Fe({props:{"data-testid":"csv-export-option",title:"Export as PFB",subtitle:"Export data in Portable Format for Biomedical Data file format",size:"other",class:"card variant-ringed-primary",active:s[1]==="DATAFRAME_PFB"}}),i.$on("click",s[23]),{c(){e=g("section"),N(t.$$.fragment),l=S(),r=g("div"),N(a.$$.fragment),n=S(),N(i.$$.fragment),this.h()},l(c){e=$(c,"SECTION",{class:!0});var d=w(e);V(t.$$.fragment,d),l=T(d),r=$(d,"DIV",{class:!0});var f=w(r);V(a.$$.fragment,f),n=T(f),V(i.$$.fragment,f),f.forEach(m),d.forEach(m),this.h()},h(){v(r,"class","grid gap-10 grid-cols-2"),v(e,"class","flex flex-col w-full h-full items-center")},m(c,d){D(c,e,d),B(t,e,null),_(e,l),_(e,r),B(a,r,null),_(r,n),B(i,r,null),o=!0},p(c,d){const f={};d[0]&2&&(f.active=c[1]==="DATAFRAME"),a.$set(f);const u={};d[0]&2&&(u.active=c[1]==="DATAFRAME_PFB"),i.$set(u)},i(c){o||(y(t.$$.fragment,c),y(a.$$.fragment,c),y(i.$$.fragment,c),o=!0)},o(c){E(t.$$.fragment,c),E(a.$$.fragment,c),E(i.$$.fragment,c),o=!1},d(c){c&&m(e),U(t),U(a),U(i)}}}function Zt(s){let e;return{c(){e=F("Review and Save Dataset:")},l(t){e=j(t,"Review and Save Dataset:")},m(t,l){D(t,e,l)},d(t){t&&m(e)}}}function Je(s){let e,t,l;return t=new Be({props:{title:"Error",$$slots:{default:[el]},$$scope:{ctx:s}}}),{c(){e=g("div"),N(t.$$.fragment),this.h()},l(r){e=$(r,"DIV",{class:!0});var a=w(e);V(t.$$.fragment,a),a.forEach(m),this.h()},h(){v(e,"class","w-full h-full m-2")},m(r,a){D(r,e,a),B(t,e,null),l=!0},p(r,a){const n={};a[0]&256|a[1]&256&&(n.$$scope={dirty:a,ctx:r}),t.$set(n)},i(r){l||(y(t.$$.fragment,r),l=!0)},o(r){E(t.$$.fragment,r),l=!1},d(r){r&&m(e),U(t)}}}function el(s){let e;return{c(){e=F(s[8])},l(t){e=j(t,s[8])},m(t,l){D(t,e,l)},p(t,l){l[0]&256&&ne(e,t[8])},d(t){t&&m(e)}}}function tl(s){let e,t,l,r,a,n=`Save the information in your final data export by clicking the Save Dataset ID button.
          Navigate to the <a class="anchor" href="/dataset">Manage Datasets page</a> to view or manage
          your Dataset IDs.`,i,o,c,d,f,u,h,k,I="Dataset Name:",p,b,L,R,P,A,X="Dataset ID:",G,O,le,Q,W,Y;t=new Re({});let x=s[8]&&Je(s);return{c(){e=g("section"),N(t.$$.fragment),l=S(),r=g("div"),a=g("header"),a.innerHTML=n,i=S(),o=g("hr"),c=S(),x&&x.c(),d=S(),f=g("div"),u=g("div"),h=g("div"),k=g("label"),k.textContent=I,p=S(),b=g("input"),L=S(),R=g("div"),P=g("div"),A=g("label"),A.textContent=X,G=S(),O=g("div"),le=F(s[10]),this.h()},l(q){e=$(q,"SECTION",{class:!0});var z=w(e);V(t.$$.fragment,z),l=T(z),r=$(z,"DIV",{class:!0});var K=w(r);a=$(K,"HEADER",{class:!0,"data-svelte-h":!0}),H(a)!=="svelte-1l8cwjc"&&(a.innerHTML=n),i=T(K),o=$(K,"HR",{}),c=T(K),x&&x.l(K),d=T(K),f=$(K,"DIV",{class:!0});var re=w(f);u=$(re,"DIV",{});var ae=w(u);h=$(ae,"DIV",{class:!0});var fe=w(h);k=$(fe,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),H(k)!=="svelte-1i4hx8x"&&(k.textContent=I),p=T(fe),b=$(fe,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),fe.forEach(m),L=T(ae),R=$(ae,"DIV",{class:!0});var he=w(R);P=$(he,"DIV",{class:!0});var ue=w(P);A=$(ue,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),H(A)!=="svelte-vytwml"&&(A.textContent=X),G=T(ue),O=$(ue,"DIV",{id:!0});var be=w(O);le=j(be,s[10]),be.forEach(m),ue.forEach(m),he.forEach(m),ae.forEach(m),re.forEach(m),K.forEach(m),z.forEach(m),this.h()},h(){v(a,"class","card-header"),v(k,"for","dataset-name"),v(k,"class","font-bold mr-2"),v(b,"type","text"),v(b,"id","dataset-name"),v(b,"class","w-80 svelte-uusfhg"),v(b,"placeholder","Enter a name"),b.required=!0,v(h,"class","flex items-center m-2"),v(A,"for","dataset-id"),v(A,"class","font-bold mr-2"),v(O,"id","dataset-id"),v(P,"class","flex items-center"),v(R,"class","flex items-center m-2"),v(f,"class","card-body p-4 flex flex-col justify-center items-center"),v(r,"class","w-full h-full m-2 card p-4"),v(e,"class","flex flex-col w-full h-full items-center")},m(q,z){D(q,e,z),B(t,e,null),_(e,l),_(e,r),_(r,a),_(r,i),_(r,o),_(r,c),x&&x.m(r,null),_(r,d),_(r,f),_(f,u),_(u,h),_(h,k),_(h,p),_(h,b),Me(b,s[6]),_(u,L),_(u,R),_(R,P),_(P,A),_(P,G),_(P,O),_(O,le),Q=!0,W||(Y=Ie(b,"input",s[24]),W=!0)},p(q,z){q[8]?x?(x.p(q,z),z[0]&256&&y(x,1)):(x=Je(q),x.c(),y(x,1),x.m(r,d)):x&&(ee(),E(x,1,1,()=>{x=null}),te()),z[0]&64&&b.value!==q[6]&&Me(b,q[6]),(!Q||z[0]&1024)&&ne(le,q[10])},i(q){Q||(y(t.$$.fragment,q),y(x),Q=!0)},o(q){E(t.$$.fragment,q),E(x),Q=!1},d(q){q&&m(e),U(t),x&&x.d(),W=!1,Y()}}}function ll(s){let e;return{c(){e=F("Save Dataset ID:")},l(t){e=j(t,"Save Dataset ID:")},m(t,l){D(t,e,l)},d(t){t&&m(e)}}}function Ke(s){let e,t,l,r={ctx:s,current:null,token:null,hasCatch:!0,pending:_l,then:al,catch:rl,error:38,blocks:[,,,]};return Ce(t=s[4],r),{c(){e=oe(),r.block.c()},l(a){e=oe(),r.block.l(a)},m(a,n){D(a,e,n),r.block.m(a,r.anchor=n),r.mount=()=>e.parentNode,r.anchor=e,l=!0},p(a,n){s=a,r.ctx=s,n[0]&16&&t!==(t=s[4])&&Ce(t,r)||bt(r,s,n)},i(a){l||(y(r.block),l=!0)},o(a){for(let n=0;n<3;n+=1){const i=r.blocks[n];E(i)}l=!1},d(a){a&&m(e),r.block.d(a),r.token=null,r=null}}}function rl(s){let e,t,l,r,a=s[38]+"",n,i;return t=new Be({props:{title:`An error occurred while preparing your dataset. Please try again. If this problem persists, please
                contact an administrator.`}}),{c(){e=g("div"),N(t.$$.fragment),l=S(),r=g("div"),n=F(a),this.h()},l(o){e=$(o,"DIV",{class:!0});var c=w(e);V(t.$$.fragment,c),l=T(c),r=$(c,"DIV",{class:!0});var d=w(r);n=j(d,a),d.forEach(m),c.forEach(m),this.h()},h(){v(r,"class","hidden"),v(e,"class","flex justify-center")},m(o,c){D(o,e,c),B(t,e,null),_(e,l),_(e,r),_(r,n),i=!0},p(o,c){(!i||c[0]&16)&&a!==(a=o[38]+"")&&ne(n,a)},i(o){i||(y(t.$$.fragment,o),i=!0)},o(o){E(t.$$.fragment,o),i=!1},d(o){o&&m(e),U(t)}}}function al(s){let e,t,l,r;const a=[sl,nl],n=[];function i(o,c){return o[0].query.expectedResultType==="DATAFRAME"?0:o[0].query.expectedResultType==="DATAFRAME_PFB"?1:-1}return~(e=i(s))&&(t=n[e]=a[e](s)),{c(){t&&t.c(),l=oe()},l(o){t&&t.l(o),l=oe()},m(o,c){~e&&n[e].m(o,c),D(o,l,c),r=!0},p(o,c){let d=e;e=i(o),e===d?~e&&n[e].p(o,c):(t&&(ee(),E(n[d],1,1,()=>{n[d]=null}),te()),~e?(t=n[e],t?t.p(o,c):(t=n[e]=a[e](o),t.c()),y(t,1),t.m(l.parentNode,l)):t=null)},i(o){r||(y(t),r=!0)},o(o){E(t),r=!1},d(o){o&&m(l),~e&&n[e].d(o)}}}function nl(s){let e,t,l="Use the option below to download your selected data in the PFB format.",r,a,n,i,o,c,d='<i class="fa-solid fa-download"></i>Download as PFB',f,u,h,k;return{c(){e=g("section"),t=g("div"),t.textContent=l,r=S(),a=g("div"),n=g("div"),i=S(),o=g("div"),c=g("button"),c.innerHTML=d,f=S(),u=g("div"),this.h()},l(I){e=$(I,"SECTION",{class:!0});var p=w(e);t=$(p,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-qfbmlq"&&(t.textContent=l),r=T(p),a=$(p,"DIV",{class:!0});var b=w(a);n=$(b,"DIV",{}),w(n).forEach(m),i=T(b),o=$(b,"DIV",{});var L=w(o);c=$(L,"BUTTON",{class:!0,"data-svelte-h":!0}),H(c)!=="svelte-451agi"&&(c.innerHTML=d),L.forEach(m),f=T(b),u=$(b,"DIV",{}),w(u).forEach(m),b.forEach(m),p.forEach(m),this.h()},h(){v(t,"class","flex justify-center mt-4"),v(c,"class","flex-initial w-64 btn variant-filled-primary"),v(a,"class","grid grid-cols-3"),v(e,"class","flex flex-col gap-8")},m(I,p){D(I,e,p),_(e,t),_(e,r),_(e,a),_(a,n),_(a,i),_(a,o),_(o,c),_(a,f),_(a,u),h||(k=Ie(c,"click",s[29]),h=!0)},p:M,i:M,o:M,d(I){I&&m(e),h=!1,k()}}}function sl(s){let e,t,l=`To export data and start your analysis, copy and paste the following code in an
                  analysis workspace, such as BioData Catalyst Powered by Seven Bridges or BioData
                  Catalyst Powered by Terra, to connect to PIC-SURE and save the data frame or
                  download the file. Note that you will need your personal access token to complete
                  the connection to PIC-SURE with code.`,r,a,n,i,o=`Copy your personal access token and save as a text file called “token.txt” in the
                  same working directory to execute the code above.`,c,d,f,u,h,k='<a class="btn variant-ghost-primary m-2 hover:variant-filled-primary" href="https://platform.sb.biodatacatalyst.nhlbi.nih.gov/u/biodatacatalyst/data-export-from-the-pic-sure-ui" target="_blank">Go to Seven Bridges</a> <a class="btn variant-ghost-primary m-2 hover:variant-filled-primary" href="https://terra.biodatacatalyst.nhlbi.nih.gov/" target="_blank">Go to Terra</a>',I;return a=new Et({props:{class:"card p-4",$$slots:{panel:[ml],default:[fl]},$$scope:{ctx:s}}}),f=new ot({}),{c(){e=g("section"),t=g("p"),t.textContent=l,r=S(),N(a.$$.fragment),n=S(),i=g("p"),i.textContent=o,c=S(),d=g("div"),N(f.$$.fragment),u=S(),h=g("div"),h.innerHTML=k,this.h()},l(p){e=$(p,"SECTION",{class:!0});var b=w(e);t=$(b,"P",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-hpr0ix"&&(t.textContent=l),r=T(b),V(a.$$.fragment,b),n=T(b),i=$(b,"P",{"data-svelte-h":!0}),H(i)!=="svelte-104z5lh"&&(i.textContent=o),c=T(b),d=$(b,"DIV",{class:!0});var L=w(d);V(f.$$.fragment,L),L.forEach(m),u=T(b),h=$(b,"DIV",{class:!0,"data-svelte-h":!0}),H(h)!=="svelte-h1oinp"&&(h.innerHTML=k),b.forEach(m),this.h()},h(){v(t,"class","mt-4"),v(d,"class","flex justify-center"),v(h,"class","flex justify-center"),v(e,"class","flex flex-col gap-8")},m(p,b){D(p,e,b),_(e,t),_(e,r),B(a,e,null),_(e,n),_(e,i),_(e,c),_(e,d),B(f,d,null),_(e,u),_(e,h),I=!0},p(p,b){const L={};b[0]&1536|b[1]&256&&(L.$$scope={dirty:b,ctx:p}),a.$set(L)},i(p){I||(y(a.$$.fragment,p),y(f.$$.fragment,p),I=!0)},o(p){E(a.$$.fragment,p),E(f.$$.fragment,p),I=!1},d(p){p&&m(e),U(a),U(f)}}}function ol(s){let e;return{c(){e=F("Python")},l(t){e=j(t,"Python")},m(t,l){D(t,e,l)},d(t){t&&m(e)}}}function il(s){let e;return{c(){e=F("R")},l(t){e=j(t,"R")},m(t,l){D(t,e,l)},d(t){t&&m(e)}}}function cl(s){let e;return{c(){e=F("Download")},l(t){e=j(t,"Download")},m(t,l){D(t,e,l)},d(t){t&&m(e)}}}function fl(s){let e,t,l,r,a,n,i,o,c;function d(p){s[26](p)}let f={name:"python",value:0,$$slots:{default:[ol]},$$scope:{ctx:s}};s[9]!==void 0&&(f.group=s[9]),e=new Ne({props:f}),Pe.push(()=>Le(e,"group",d));function u(p){s[27](p)}let h={name:"r",value:1,$$slots:{default:[il]},$$scope:{ctx:s}};s[9]!==void 0&&(h.group=s[9]),r=new Ne({props:h}),Pe.push(()=>Le(r,"group",u));function k(p){s[28](p)}let I={name:"download",value:2,$$slots:{default:[cl]},$$scope:{ctx:s}};return s[9]!==void 0&&(I.group=s[9]),i=new Ne({props:I}),Pe.push(()=>Le(i,"group",k)),{c(){N(e.$$.fragment),l=S(),N(r.$$.fragment),n=S(),N(i.$$.fragment)},l(p){V(e.$$.fragment,p),l=T(p),V(r.$$.fragment,p),n=T(p),V(i.$$.fragment,p)},m(p,b){B(e,p,b),D(p,l,b),B(r,p,b),D(p,n,b),B(i,p,b),c=!0},p(p,b){const L={};b[1]&256&&(L.$$scope={dirty:b,ctx:p}),!t&&b[0]&512&&(t=!0,L.group=p[9],Ae(()=>t=!1)),e.$set(L);const R={};b[1]&256&&(R.$$scope={dirty:b,ctx:p}),!a&&b[0]&512&&(a=!0,R.group=p[9],Ae(()=>a=!1)),r.$set(R);const P={};b[1]&256&&(P.$$scope={dirty:b,ctx:p}),!o&&b[0]&512&&(o=!0,P.group=p[9],Ae(()=>o=!1)),i.$set(P)},i(p){c||(y(e.$$.fragment,p),y(r.$$.fragment,p),y(i.$$.fragment,p),c=!0)},o(p){E(e.$$.fragment,p),E(r.$$.fragment,p),E(i.$$.fragment,p),c=!1},d(p){p&&(m(l),m(n)),U(e,p),U(r,p),U(i,p)}}}function ul(s){let e,t,l='<i class="fa-solid fa-download mr-1"></i>Download as CSV',r,a;return{c(){e=g("div"),t=g("button"),t.innerHTML=l,this.h()},l(n){e=$(n,"DIV",{});var i=w(e);t=$(i,"BUTTON",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-1sq7t1x"&&(t.innerHTML=l),i.forEach(m),this.h()},h(){v(t,"class","btn variant-filled-primary")},m(n,i){D(n,e,i),_(e,t),r||(a=Ie(t,"click",s[25]),r=!0)},p:M,i:M,o:M,d(n){n&&m(e),r=!1,a()}}}function dl(s){let e,t;return e=new ct({props:{language:"r",lineNumbers:!0,code:`# Requires R 3.4 or later
### Uncomment this code if you are not using the PIC-SURE environment in *BDC-Seven Bridges*, or if you do not have all the necessary dependencies installed.
#install.packages("devtools")

Sys.setenv(TAR = "/bin/tar")
options(unzip = "internal")
devtools::install_github("hms-dbmi/pic-sure-r-adapter-hpds", ref="main", force=T, quiet=FALSE)
library(dplyr)

PICSURE_network_URL = "https://picsure.biodatacatalyst.nhlbi.nih.gov/picsure"
token_file <- "token.txt"
token <- scan(token_file, what = "character")
session <- picsure::bdc.initializeSession(PICSURE_network_URL, token)
session <- picsure::bdc.setResource(session = session)

queryID <- "${s[10]}"

results <- picsure::getResultByQueryUUID(session, queryID)`}}),{c(){N(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,r){B(e,l,r),t=!0},p(l,r){const a={};r[0]&1024&&(a.code=`# Requires R 3.4 or later
### Uncomment this code if you are not using the PIC-SURE environment in *BDC-Seven Bridges*, or if you do not have all the necessary dependencies installed.
#install.packages("devtools")

Sys.setenv(TAR = "/bin/tar")
options(unzip = "internal")
devtools::install_github("hms-dbmi/pic-sure-r-adapter-hpds", ref="main", force=T, quiet=FALSE)
library(dplyr)

PICSURE_network_URL = "https://picsure.biodatacatalyst.nhlbi.nih.gov/picsure"
token_file <- "token.txt"
token <- scan(token_file, what = "character")
session <- picsure::bdc.initializeSession(PICSURE_network_URL, token)
session <- picsure::bdc.setResource(session = session)

queryID <- "${l[10]}"

results <- picsure::getResultByQueryUUID(session, queryID)`),e.$set(a)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){U(e,l)}}}function pl(s){let e,t;return e=new ct({props:{language:"python",lineNumbers:!0,buttonCopied:"Copied!",code:`# Requires python 3.7 or later
import sys
import pandas as pd
import matplotlib.pyplot as plt
# BDC Powered by Terra users uncomment the following line to specify package install location
# sys.path.insert(0, r"/home/jupyter/.local/lib/python3.7/site-packages")
!{sys.executable} -m pip install --upgrade --force-reinstall git+https://github.com/hms-dbmi/pic-sure-python-client.git
!{sys.executable} -m pip install --upgrade --force-reinstall git+https://github.com/hms-dbmi/pic-sure-python-adapter-hpds.git
!{sys.executable} -m pip install --upgrade --force-reinstall git+https://github.com/hms-dbmi/pic-sure-biodatacatalyst-python-adapter-hpds.git
import PicSureHpdsLib
import PicSureClient

PICSURE_network_URL = "https://picsure.biodatacatalyst.nhlbi.nih.gov/picsure"

token_file = "token.txt"
with open(token_file, "r") as f:
    my_token = f.read()

connection = PicSureClient.Client.connect(url = PICSURE_network_URL, token = my_token)

queryID = "${s[10]}"

results = resource.retrieveQueryResults(queryID)

from io import StringIO
df_UI = pd.read_csv(StringIO(results), low_memory=False)`}}),{c(){N(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,r){B(e,l,r),t=!0},p(l,r){const a={};r[0]&1024&&(a.code=`# Requires python 3.7 or later
import sys
import pandas as pd
import matplotlib.pyplot as plt
# BDC Powered by Terra users uncomment the following line to specify package install location
# sys.path.insert(0, r"/home/jupyter/.local/lib/python3.7/site-packages")
!{sys.executable} -m pip install --upgrade --force-reinstall git+https://github.com/hms-dbmi/pic-sure-python-client.git
!{sys.executable} -m pip install --upgrade --force-reinstall git+https://github.com/hms-dbmi/pic-sure-python-adapter-hpds.git
!{sys.executable} -m pip install --upgrade --force-reinstall git+https://github.com/hms-dbmi/pic-sure-biodatacatalyst-python-adapter-hpds.git
import PicSureHpdsLib
import PicSureClient

PICSURE_network_URL = "https://picsure.biodatacatalyst.nhlbi.nih.gov/picsure"

token_file = "token.txt"
with open(token_file, "r") as f:
    my_token = f.read()

connection = PicSureClient.Client.connect(url = PICSURE_network_URL, token = my_token)

queryID = "${l[10]}"

results = resource.retrieveQueryResults(queryID)

from io import StringIO
df_UI = pd.read_csv(StringIO(results), low_memory=False)`),e.$set(a)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){U(e,l)}}}function ml(s){let e,t,l,r;const a=[pl,dl,ul],n=[];function i(o,c){return o[9]===0?0:o[9]===1?1:o[9]===2?2:-1}return~(e=i(s))&&(t=n[e]=a[e](s)),{c(){t&&t.c(),l=oe()},l(o){t&&t.l(o),l=oe()},m(o,c){~e&&n[e].m(o,c),D(o,l,c),r=!0},p(o,c){let d=e;e=i(o),e===d?~e&&n[e].p(o,c):(t&&(ee(),E(n[d],1,1,()=>{n[d]=null}),te()),~e?(t=n[e],t?t.p(o,c):(t=n[e]=a[e](o),t.c()),y(t,1),t.m(l.parentNode,l)):t=null)},i(o){r||(y(t),r=!0)},o(o){E(t),r=!1},d(o){o&&m(l),~e&&n[e].d(o)}}}function _l(s){let e,t,l,r,a="Preparing your dataset...",n;return t=new it({props:{width:"w-4"}}),{c(){e=g("div"),N(t.$$.fragment),l=S(),r=g("div"),r.textContent=a,this.h()},l(i){e=$(i,"DIV",{class:!0});var o=w(e);V(t.$$.fragment,o),l=T(o),r=$(o,"DIV",{"data-svelte-h":!0}),H(r)!=="svelte-1m53t1h"&&(r.textContent=a),o.forEach(m),this.h()},h(){v(e,"class","flex justify-center items-center")},m(i,o){D(i,e,o),B(t,e,null),_(e,l),_(e,r),n=!0},p:M,i(i){n||(y(t.$$.fragment,i),n=!0)},o(i){E(t.$$.fragment,i),n=!1},d(i){i&&m(e),U(t)}}}function Ze(s){let e,t,l=`Use your personal access token and the dataset ID to export your participant-level
            cohort data using the PIC-SURE API.`,r,a,n,i,o,c,d="Dataset ID:",f,u,h,k,I,p,b,L=`Navigate to the <a class="anchor" href="/api">API page</a> to view examples and learn more
            about the PIC-SURE API.`,R;return a=new ot({}),I=new yt({props:{itemToCopy:s[10]}}),{c(){e=g("div"),t=g("div"),t.textContent=l,r=S(),N(a.$$.fragment),n=S(),i=g("div"),o=g("div"),c=g("label"),c.textContent=d,f=S(),u=g("div"),h=F(s[10]),k=S(),N(I.$$.fragment),p=S(),b=g("p"),b.innerHTML=L,this.h()},l(P){e=$(P,"DIV",{class:!0});var A=w(e);t=$(A,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-1d55zu0"&&(t.textContent=l),r=T(A),V(a.$$.fragment,A),n=T(A),i=$(A,"DIV",{class:!0});var X=w(i);o=$(X,"DIV",{class:!0});var G=w(o);c=$(G,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),H(c)!=="svelte-10o6xpf"&&(c.textContent=d),f=T(G),u=$(G,"DIV",{id:!0,class:!0});var O=w(u);h=j(O,s[10]),O.forEach(m),k=T(G),V(I.$$.fragment,G),G.forEach(m),X.forEach(m),p=T(A),b=$(A,"P",{"data-svelte-h":!0}),H(b)!=="svelte-188gcj5"&&(b.innerHTML=L),A.forEach(m),this.h()},h(){v(t,"class","flex justify-center"),v(c,"for","dataset-id"),v(c,"class","font-bold ml-4 mr-2"),v(u,"id","dataset-id"),v(u,"class","mr-4"),v(o,"class","flex items-center"),v(i,"class","flex items-center m-4"),v(e,"class","flex flex-col justify-center items-center")},m(P,A){D(P,e,A),_(e,t),_(e,r),B(a,e,null),_(e,n),_(e,i),_(i,o),_(o,c),_(o,f),_(o,u),_(u,h),_(o,k),B(I,o,null),_(e,p),_(e,b),R=!0},p(P,A){(!R||A[0]&1024)&&ne(h,P[10]);const X={};A[0]&1024&&(X.itemToCopy=P[10]),I.$set(X)},i(P){R||(y(a.$$.fragment,P),y(I.$$.fragment,P),R=!0)},o(P){E(a.$$.fragment,P),E(I.$$.fragment,P),R=!1},d(P){P&&m(e),U(a),U(I)}}}function hl(s){let e,t,l,r,a=s[12]&&Ke(s),n=s[11]&&Ze(s);return{c(){e=g("section"),t=g("div"),a&&a.c(),l=S(),n&&n.c(),this.h()},l(i){e=$(i,"SECTION",{class:!0});var o=w(e);t=$(o,"DIV",{class:!0});var c=w(t);a&&a.l(c),c.forEach(m),l=T(o),n&&n.l(o),o.forEach(m),this.h()},h(){v(t,"class","flex justify-center"),v(e,"class","flex flex-col w-full h-full items-center")},m(i,o){D(i,e,o),_(e,t),a&&a.m(t,null),_(e,l),n&&n.m(e,null),r=!0},p(i,o){i[12]?a?(a.p(i,o),o[0]&4096&&y(a,1)):(a=Ke(i),a.c(),y(a,1),a.m(t,null)):a&&(ee(),E(a,1,1,()=>{a=null}),te()),i[11]?n?(n.p(i,o),o[0]&2048&&y(n,1)):(n=Ze(i),n.c(),y(n,1),n.m(e,null)):n&&(ee(),E(n,1,1,()=>{n=null}),te())},i(i){r||(y(a),y(n),r=!0)},o(i){E(a),E(n),r=!1},d(i){i&&m(e),a&&a.d(),n&&n.d()}}}function bl(s){let e;return{c(){e=F("Start Analysis:")},l(t){e=j(t,"Start Analysis:")},m(t,l){D(t,e,l)},d(t){t&&m(e)}}}function vl(s){let e,t,l,r,a,n,i,o,c;e=new _e({props:{locked:s[20](),$$slots:{header:[Xt],default:[Wt]},$$scope:{ctx:s}}});let d=s[2]&&Ye(s);return r=new _e({props:{locked:s[1]===void 0,$$slots:{header:[Zt],default:[Kt]},$$scope:{ctx:s}}}),n=new _e({props:{locked:!s[6]||s[6].length<2,$$slots:{header:[ll],default:[tl]},$$scope:{ctx:s}}}),o=new _e({props:{locked:s[7],$$slots:{header:[bl],default:[hl]},$$scope:{ctx:s}}}),{c(){N(e.$$.fragment),t=S(),d&&d.c(),l=S(),N(r.$$.fragment),a=S(),N(n.$$.fragment),i=S(),N(o.$$.fragment)},l(f){V(e.$$.fragment,f),t=T(f),d&&d.l(f),l=T(f),V(r.$$.fragment,f),a=T(f),V(n.$$.fragment,f),i=T(f),V(o.$$.fragment,f)},m(f,u){B(e,f,u),D(f,t,u),d&&d.m(f,u),D(f,l,u),B(r,f,u),D(f,a,u),B(n,f,u),D(f,i,u),B(o,f,u),c=!0},p(f,u){const h={};u[0]&40|u[1]&256&&(h.$$scope={dirty:u,ctx:f}),e.$set(h),f[2]?d?u[0]&4&&y(d,1):(d=Ye(f),d.c(),y(d,1),d.m(l.parentNode,l)):d&&(ee(),E(d,1,1,()=>{d=null}),te());const k={};u[0]&2&&(k.locked=f[1]===void 0),u[0]&2|u[1]&256&&(k.$$scope={dirty:u,ctx:f}),r.$set(k);const I={};u[0]&64&&(I.locked=!f[6]||f[6].length<2),u[0]&1344|u[1]&256&&(I.$$scope={dirty:u,ctx:f}),n.$set(I);const p={};u[0]&128&&(p.locked=f[7]),u[0]&7697|u[1]&256&&(p.$$scope={dirty:u,ctx:f}),o.$set(p)},i(f){c||(y(e.$$.fragment,f),y(d),y(r.$$.fragment,f),y(n.$$.fragment,f),y(o.$$.fragment,f),c=!0)},o(f){E(e.$$.fragment,f),E(d),E(r.$$.fragment,f),E(n.$$.fragment,f),E(o.$$.fragment,f),c=!1},d(f){f&&(m(t),m(l),m(a),m(i)),U(e,f),d&&d.d(f),U(r,f),U(n,f),U(o,f)}}}function gl(s){let e,t;return e=new Dt({props:{class:"w-full h-full m-8",buttonCompleteLabel:"Done",$$slots:{default:[vl]},$$scope:{ctx:s}}}),e.$on("complete",s[19]),e.$on("next",s[16]),e.$on("step",$l),e.$on("back",s[17]),{c(){N(e.$$.fragment)},l(l){V(e.$$.fragment,l)},m(l,r){B(e,l,r),t=!0},p(l,r){const a={};r[0]&8191|r[1]&256&&(a.$$scope={dirty:r,ctx:l}),e.$set(a)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){U(e,l)}}}const et=1e6;function $l(s){console.log("event:next",s)}function kl(s,e,t){let l,r,a,n,i,o,c;se(s,nt,C=>t(32,i=C)),se(s,st,C=>t(33,o=C)),se(s,ce,C=>t(34,c=C));let{exports:d}=at;se(s,d,C=>t(31,n=C));let{query:f}=e,{showTreeStep:u=!1}=e,{rows:h=[]}=e,k,I,p="",b="",L=!0,R="";const P=[{dataElement:"variableName",label:"Variable Name",sort:!0},{dataElement:"description",label:"Variable Description",sort:!0},{dataElement:"type",label:"Type",sort:!0}];async function A(){try{const C=await ge(`picsure/query/${l}/result`,{}),Z=URL.createObjectURL(new Blob([C],{type:"octet/stream"}));if(vt){const J=document.createElement("a");J.href=Z,f.query.expectedResultType==="DATAFRAME"?J.download="pic-sure-data.csv":f.query.expectedResultType==="DATAFRAME_PFB"&&(J.download="pic-sure-data.avro"),document.body.appendChild(J),J.click(),document.body.removeChild(J)}}catch(C){console.error("Error in onCompleteHandler",C)}}function X(C){console.log("event:next",C),!(C.detail.step===0&&!u)&&(C.detail.step===1&&u?console.log("event:next",C):C.detail.step===1&&!u||u&&C.detail.step===2?t(5,I=O()):(C.detail.step===2&&!u||u&&C.detail.step===3)&&le(),C.detail.state.total-1===C.detail.step+1&&t(4,k=new Promise((Z,J)=>{const ie=setInterval(async()=>{const ve=await Q(b);ve==="ERROR"?(t(7,L=!0),clearInterval(ie),J(ve)):["PENDING","RUNNING","QUEUED"].includes(ve)||(t(7,L=!1),clearInterval(ie),Z(ve))},2e3)})))}function G(C){t(8,R=""),console.log("event:next",C)}async function O(){try{t(0,f.query.fields=n.map(Z=>Z.conceptPath),f);const C=await ge("picsure/query",f);console.log("res",C),t(10,l=C.picsureResultId)}catch(C){throw de(ce,c.current--,c),console.error("Error in handleFirstStep",C),C}}async function le(){var C;try{await Ft(l,p)}catch(Z){if(Z instanceof Object){const J=Z;t(8,R=((C=J==null?void 0:J.message)==null?void 0:C.message)||"Error Creating Named Dataset")}else t(8,R=String(Z)||"Error Creating Named Dataset");de(ce,c.current--,c),console.error("Error in createNamedDataset",Z)}}async function Q(C){const J="picsure/query/"+(C||l)+"/status";try{const ie=await ge(J,f);return b=ie.picsureResultId,ie.status}catch(ie){console.error("Error in checkExportStatus",ie)}return"ERROR"}let{activeType:W}=e;function Y(C){t(0,f.query.expectedResultType=C,f),t(1,W=C)}function x(){$t("/explorer")}let q=0;function z(){return(typeof o=="number"?o:et+1)+i.length+n.length>et}const K=()=>x(),re=()=>Y("DATAFRAME"),ae=()=>Y("DATAFRAME_PFB");function fe(){p=this.value,t(6,p)}const he=()=>A();function ue(C){q=C,t(9,q)}function be(C){q=C,t(9,q)}function ft(C){q=C,t(9,q)}const ut=()=>A();return s.$$set=C=>{"query"in C&&t(0,f=C.query),"showTreeStep"in C&&t(2,u=C.showTreeStep),"rows"in C&&t(3,h=C.rows),"activeType"in C&&t(1,W=C.activeType)},t(10,l=""),t(12,r=!0),t(11,a=!1),[f,W,u,h,k,I,p,L,R,q,l,a,r,d,P,A,X,G,Y,x,z,K,re,ae,fe,he,ue,be,ft,ut]}class Hl extends Se{constructor(e){super(),Te(this,e,kl,gl,De,{query:0,showTreeStep:2,rows:3,activeType:1},null,[-1,-1])}}export{Hl as E,ce as s};
