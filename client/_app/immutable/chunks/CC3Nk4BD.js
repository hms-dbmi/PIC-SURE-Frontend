import{d as f,w as p}from"./DA0IzwqI.js";import{g as d,p as m,a as g,d as R}from"./BB8gGrUk.js";import{x as a}from"./DfqJWsAP.js";function c(e){return{...e,privileges:e.privileges?e.privileges.map(s=>s.uuid):[]}}const r="psama/role",l=p(!1),n=p([]),v=f(n,e=>e.map(s=>[s.name,s.uuid||""]),[]);async function w(){if(a(l))return;const e=await d(r);n.set(e.map(c)),l.set(!0)}async function x(e){const t=a(n).find(i=>i.uuid===e);if(t)return t;const o=await d(`${r}/${e}`);return c(o)}async function b(e){const s=await m(r,[{...e,privileges:e.privileges.map(i=>({uuid:i}))}]),t=c(s.content[0]),o=a(n);o.push(t),n.set(o)}async function y(e){const s=await g(r,[{...e,privileges:e.privileges.map(u=>({uuid:u}))}]),t=c(s.content[0]),o=a(n),i=o.findIndex(u=>u.uuid===t.uuid);i===-1?o.push(t):o[i]=t,n.set(o)}async function I(e){await R(`${r}/${e}`);const s=a(n),t=s.findIndex(o=>o.uuid===e);t>-1&&(s.splice(t,1),n.set(s))}const L={subscribe:n.subscribe,roles:n,roleList:v,loadRoles:w,getRole:x,addRole:b,updateRole:y,deleteRole:I};export{L as R,b as a,x as g,w as l,n as r,y as u};
