var We=Object.defineProperty;var Fe=d=>{throw TypeError(d)};var qe=(d,e,u)=>e in d?We(d,e,{enumerable:!0,configurable:!0,writable:!0,value:u}):d[e]=u;var pe=(d,e,u)=>qe(d,typeof e!="symbol"?e+"":e,u),Be=(d,e,u)=>e.has(d)||Fe("Cannot "+u);var Y=(d,e,u)=>(Be(d,e,"read from private field"),u?u.call(d):e.get(d)),ne=(d,e,u)=>e.has(d)?Fe("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(d):e.set(d,u);import{f as h,a as p,c as Ue}from"./CtfeAAbw.js";import{w as ce,g as te,o as Xe}from"./DlIBaGjY.js";import{p as ie,c as n,f as be,s as l,g as t,r,t as z,a as re,h as oe,d as Z,b as B,e as c}from"./B4GrenNm.js";import{s as H}from"./DxSOTiY2.js";import{i as k}from"./CSsnQ7i2.js";import{s as J,r as ye,b as Se,d as Ge,g as Je,a as Ke,c as Qe}from"./BPiAbArq.js";import{d as ge}from"./D7VV4X-8.js";import{b as Ne}from"./CJCVGGPV.js";import{p as G,s as Le,c as le}from"./DvPjbdiY.js";import{t as Oe}from"./BRrMSDP5.js";import{a as Te}from"./CpfTO1e4.js";import{b as Ye,d as Ze,e as Re,f as De,O as $e}from"./DOfTSHX0.js";import{c as Pe,d as et}from"./bY-Ac27V.js";import{p as Ve}from"./M_WnVc2Q.js";import{L as Ee}from"./DYQPks66.js";import{a as tt}from"./bf3FOAR_.js";import{e as Me,i as je}from"./BdG0KSB2.js";var at=h('<div><span class="font-bold">Name:</span> </div>'),it=h('<div><span class="font-bold mb-1">Accession:</span> </div>'),rt=h('<div><span class="font-bold mb-1">Type:</span> </div>'),nt=h('<div><span class="font-bold">Description:</span> </div>'),st=h('<div><span class="font-bold mb-1">Name:</span> </div>'),ot=h('<div><span class="font-bold">Accession:</span> </div>'),lt=h('<div><span class="font-bold">Description:</span> </div>'),dt=h('<section data-testid="dataset-info" class="flex flex-col w-3/4 p-4"><h3 class="text-primary-500">Dataset Information</h3> <div class="w-full flex flex-row justify-between"><!> <!></div> <!></section>'),ct=h('<div><span class="font-bold mb-1">Study Name:</span> </div>'),vt=h('<div><span class="font-bold">Study Accession:</span> </div>'),ft=h('<section data-testid="study-info" class="flex flex-col w-3/4 p-4"><h3 class="text-primary-500">Study Information</h3> <div class="w-full flex flex-col"><!> <!></div></section>'),ut=h('<section data-testid="variable-info" class="flex flex-col w-3/4 p-4"><h3 class="text-primary-500">Variable Information</h3> <div class="w-full flex flex-row justify-between"><!> <!> <!></div> <!></section> <!> <!>',1),mt=h('<div class="card bg-surface-100 min-h-60 p-4"><div class="card-body"><!></div></div>');function _t(d,e){ie(e,!0);let u=G(e,"data",19,()=>({})),V=Pe(u().conceptPath,u().dataset);var a=mt(),S=n(a),U=n(S);tt(U,()=>V,w=>{Ee(w,{ring:!0,size:"medium"})},(w,i)=>{var E=ut(),m=be(E),v=l(n(m),2),N=n(v);{var s=_=>{var b=at(),M=l(n(b));r(b),z(()=>H(M,` ${t(i).display??""}`)),p(_,b)};k(N,_=>{t(i).display&&_(s)})}var y=l(N,2);{var L=_=>{var b=it(),M=l(n(b));r(b),z(()=>H(M,` ${t(i).name??""}`)),p(_,b)};k(y,_=>{t(i).name&&_(L)})}var W=l(y,2);{var F=_=>{var b=rt(),M=l(n(b));r(b),z(()=>H(M,` ${t(i).type??""}`)),p(_,b)};k(W,_=>{t(i).type&&_(F)})}r(v);var O=l(v,2);{var X=_=>{var b=nt(),M=l(n(b));r(b),z(()=>H(M,` ${t(i).description??""}`)),p(_,b)};k(O,_=>{t(i).description&&_(X)})}r(m);var R=l(m,2);{var ve=_=>{var b=dt(),M=l(n(b),2),Q=n(M);{var $=g=>{var x=st(),j=l(n(x));r(x),z(()=>H(j,` ${t(i).table.display??""}`)),p(g,x)};k(Q,g=>{t(i).table.display&&g($)})}var ee=l(Q,2);{var o=g=>{var x=ot(),j=l(n(x));r(x),z(()=>H(j,` ${t(i).table.name??""}`)),p(g,x)};k(ee,g=>{t(i).table.name&&g(o)})}r(M);var A=l(M,2);{var f=g=>{var x=lt(),j=l(n(x));r(x),z(()=>H(j,` ${t(i).table.description??""}`)),p(g,x)};k(A,g=>{t(i).table.description&&g(f)})}r(b),p(_,b)};k(R,_=>{t(i).table&&_(ve)})}var K=l(R,2);{var D=_=>{var b=ft(),M=l(n(b),2),Q=n(M);{var $=A=>{var f=ct(),g=l(n(f));r(f),z(()=>{var x;return H(g,` ${(t(i).study.fullName||t(i).study.display||t(i).study.studyAcronym||((x=t(i))==null?void 0:x.studyAcronym))??""}`)}),p(A,f)};k(Q,A=>{var f;(t(i).study.fullName||t(i).study.display||t(i).study.studyAcronym||(f=t(i))!=null&&f.studyAcronym)&&A($)})}var ee=l(Q,2);{var o=A=>{var f=vt(),g=l(n(f));r(f),z(()=>H(g,` ${t(i).study.ref??""}`)),p(A,f)};k(ee,A=>{t(i).study.ref&&A(o)})}r(M),r(b),p(_,b)};k(K,_=>{t(i).study&&_(D)})}p(w,E)}),r(S),r(a),p(d,a),re()}var pt=h('<i class="fa-solid fa-angle-left fa-xl -rotate-45 self-center"></i>'),yt=(d,e)=>e.node.select(),bt=h('<details class="tree-item" open><summary class="tree-item-summary list-none [&amp;::-webkit-details-marker]:hidden flex items-center cursor-pointer rounded-container p-0 hover:preset-tonal-primary space-x-1 w-full mr-2" role="treeitem"><!> <input type="radio" name="tree-radio"/> <label class="w-full"> </label></summary> <div class="tree-item-children ml-4" role="group"><!></div></details>');function Ie(d,e){ie(e,!0);const u=G(e,"isRoot",3,!1);var V=bt(),a=n(V);J(a,"aria-expanded",!0);var S=n(a);{var U=s=>{var y=pt();z(()=>Ke(y,`margin-left: ${(e.index+1)*9}px;`)),p(s,y)};k(S,s=>{u()||s(U)})}var w=l(S,2);ye(w),w.__click=[yt,e];var i=l(w,2),E=n(i,!0);r(i),r(a);var m=l(a,2),v=n(m);{var N=s=>{var y=Ue(),L=be(y);Me(L,17,()=>e.node.children,je,(W,F)=>{const O=oe(()=>e.index+1);Ie(W,{get node(){return t(F)},get index(){return t(O)}})}),p(s,y)};k(v,s=>{e.node.isLeaf||s(N)})}r(m),r(V),z(()=>{J(V,"data-testid",`tree-item:${e.node.name??""}-${e.node.value??""}`),J(V,"aria-disabled",e.node.disabled),J(a,"aria-selected",e.node.selected),J(w,"id",`radio:${e.node.name??""}`),J(w,"data-testid",`radio:${e.node.name??""}`),Se(w,1,`radio tree-item-radio self-center ${u()?"ml-[28px]":""}`),Ge(w,e.node.value),Je(w,e.node.selected),J(i,"for",`${e.node.isLeaf?"radio:":"tree-item-btn:"}${e.node.name??""}`),H(E,e.node.name),J(m,"data-testid",`tree-item-children:${e.node.name??""}`)}),p(d,V),re()}ge(["click"]);var gt=h("<div></div>");function xt(d,e){var E,m,v;ie(e,!0);let u=G(e,"nodes",19,()=>[]),V=G(e,"onselect",3,()=>{}),a=G(e,"fullWidth",3,!1);class S{constructor(s,y,L=[],W=!1){pe(this,"name","");pe(this,"value","");ne(this,E,B(!1));ne(this,m,B(!1));ne(this,v,B(Z([])));this.name=s,this.value=y,this.children=L,this.selected=W||this.isLeaf}get selected(){return t(Y(this,E))}set selected(s){c(Y(this,E),s,!0)}get disabled(){return t(Y(this,m))}set disabled(s){c(Y(this,m),s,!0)}get children(){return t(Y(this,v))}set children(s){c(Y(this,v),s,!0)}get isLeaf(){return this.children.length===0}select(){w.forEach(s=>{const y=L=>{L!==this&&(L.selected=!1,L.children.forEach(y))};y(s)}),this.selected=!0,V()(this.value)}}E=new WeakMap,m=new WeakMap,v=new WeakMap;function U(N){const{name:s,value:y,selected:L}=N;let W=[];return N.children.length>0&&(W=N.children.map(U)),new S(s,y,W,L)}let w=Z(u().map(U));var i=gt();Me(i,21,()=>w,je,(N,s,y)=>{Ie(N,{get node(){return t(s)},index:y,isRoot:y===0})}),r(i),z(()=>Se(i,1,Qe(a()?"w-full":""))),p(d,i),re()}var ht=h('<div data-testid="hierarchy-component" class="flex flex-row bg-surface-100 p-4 rounded-container"><!> <button class="btn btn-icon preset-filled-primary-500 m-1" data-testid="add-filter" aria-label="Add Filter"><i class="fas fa-plus"></i></button></div>');function wt(d,e){ie(e,!0);const[u,V]=Le(),a=100;let S=G(e,"data",19,()=>({})),U=G(e,"onclose",3,()=>{}),w=Z(S().conceptPath.split("\\").reduce((F,O,X,R)=>X===0&&O===""||X===R.length-1&&O===""?F:[...F,O],[])),i=Z(E());function E(){if(!w.length)return null;let F=null;for(let O=w.length-1;O>=0;O--)F={name:w[O],value:`\\${w.slice(0,O+1).join("\\")}\\`,children:F?[F]:[],open:!0,selected:!1};return F}let m=B(Z(S().conceptPath));async function v(){const F=await et(S().dataset,a,t(m));let O;const X={conceptPath:t(m),display:t(m).split("\\").filter(Boolean).pop()||t(m),name:t(m),allowFiltering:!0,dataset:S().dataset,studyAcronym:S().studyAcronym,description:`Any Record of ${t(m)}`,meta:S().meta,study:S().study,table:S().table,type:"AnyRecordOf"};O=Ye(X,F),Te(O),N()}function N(){le(ae,""),le(Ve,!0),U()()}var s=ht(),y=n(s);{var L=F=>{const O=oe(()=>[i]);xt(F,{fullWidth:!0,get nodes(){return t(O)},onselect:X=>c(m,X,!0)})};k(y,F=>{i&&F(L)})}var W=l(y,2);W.__click=v,r(s),p(d,s),re(),V()}ge(["click"]);const de={filter:()=>Tt,info:()=>_t,hierarchy:()=>wt},Ce=ce(""),ae=ce(""),ke=ce(de.info()),se=ce(de.info());function Zt(d){const{row:e,table:u,component:V}=d,a=te(ae)===e,S=!V||te(se)===de[V](),U=!u||te(Ce)===u;a&&S&&U?(ae.set(""),se.set(te(ke))):(ae.set(e),u&&Ce.set(u),V?se.set(de[V]()):se.set(te(ke)))}var At=h('<div class="variable-name"> </div>'),Ft=h('<div class="variable-desc"> </div>'),Nt=h('<div class="variable-study"> </div>'),Ot=h('<div class="variable-info"><!> <!> <!></div>'),Ct=h('<div data-testid="categoical-filter" class="w-full"><!></div>'),kt=h('<div class="card bg-surface-100 p-3 m-1 w-full"><section class="card-body flex grow gap-4" data-testid="numerical-filter"><label class="flex-auto flex-col"><span> </span> <input id="min" data-testid="min-input" type="text" placeholder="Enter value or leave blank for variable min" class="input"/></label> <label class="flex-auto flex-col"><span> </span> <input id="max" data-testid="max-input" type="text" placeholder="Enter value or leave blank for variable max" class="input"/></label></section></div>'),St=h('<!> <button class="btn btn-icon preset-filled-primary-500 m-1 svelte-1kbvhvw" data-testid="add-filter" aria-label="Add Filter"><i class="fas fa-plus"></i></button>',1),Lt=h('<div><!> <div class="flex justify-between" data-testid="filter-component"><!></div></div>');function Tt(d,e){ie(e,!0);const[u,V]=Le();let a=G(e,"data",23,()=>({})),S=G(e,"onclose",3,()=>{}),U=B(""),w=B(""),i=B(""),E=B(""),m=20,v=B(Z([])),N=B(Z([])),s=m,y="",L=B(!1),W=B(""),F=B(""),O=B("");Xe(async()=>{var o,A,f,g,x,j,q;if(e.existingFilter)c(W,((o=a())==null?void 0:o.display)||"",!0),c(F,((A=a())==null?void 0:A.description)||"",!0),c(O,a().studyAcronym&&a().dataset?`${a().studyAcronym} (${a().dataset})`:a().studyAcronym||a().dataset||"",!0),e.existingFilter.filterType==="Categorical"?(e.existingFilter.categoryValues.length===0?c(N,((f=a())==null?void 0:f.values)||[],!0):c(N,e.existingFilter.categoryValues,!0),c(v,((x=(g=a())==null?void 0:g.values)==null?void 0:x.filter(I=>!t(N).find(P=>P===I)))||[],!0),t(v).length>=50&&c(v,t(v).slice(0,m),!0)):e.existingFilter.filterType==="numeric"&&(c(i,e.existingFilter.min!==void 0&&e.existingFilter.min!==null?e.existingFilter.min.toString():"",!0),c(E,e.existingFilter.max!==void 0&&e.existingFilter.max!==null?e.existingFilter.max.toString():"",!0));else if(((j=a())==null?void 0:j.type)==="Categorical")try{c(L,!0),a(await Pe(a().conceptPath,a().dataset)),c(L,!1),c(v,((q=a())==null?void 0:q.values)||[],!0),t(v).length>=50&&c(v,t(v).slice(0,m),!0)}catch(I){console.error(I),Oe.error({title:"An error occured while loading the filter. Please try again later."})}c(w,a().min!==void 0&&a().min!==null?a().min.toString():"",!0),c(U,a().max!==void 0&&a().max!==null?a().max.toString():"",!0)});function X(){var A,f;let o;if(a().type==="Categorical"){if(!t(K)||t(K).length===0)return;t(K).length===((f=(A=a())==null?void 0:A.values)==null?void 0:f.length)?o=Ze(a()):o=Re(a(),t(K))}else o=De(a(),t(i)||void 0,t(E)||void 0);o&&(Te(o),R())}function R(){le(ae,""),le(Ve,!0),S()()}function ve(o=""){var f,g,x;if((((g=(f=a())==null?void 0:f.values)==null?void 0:g.length)||0)!==0){c(L,!0);try{let j=((x=a())==null?void 0:x.values)||[];(o!==y||!y.includes(o))&&(s=0,c(v,[],!0),y=o);let q=j.filter(T=>!t(N).includes(T)&&(!o||T.toLowerCase().includes(o.toLowerCase())));const I=Math.min(s+m,q.length),P=q.slice(s,I);c(v,[...t(v),...P],!0),s=I}catch(j){console.error(j),Oe.error({title:"An error occurred while loading more options. Please try again later."})}c(L,!1)}}let K=oe(()=>t(N).map(o=>o));var D=Lt(),_=n(D);{var b=o=>{var A=Ot(),f=n(A);{var g=P=>{var T=At(),C=n(T);r(T),z(()=>H(C,`Variable Name: ${t(W)??""}`)),p(P,T)};k(f,P=>{t(W)&&P(g)})}var x=l(f,2);{var j=P=>{var T=Ft(),C=n(T);r(T),z(()=>H(C,`Variable Description: ${t(F)??""}`)),p(P,T)};k(x,P=>{t(F)&&P(j)})}var q=l(x,2);{var I=P=>{var T=Nt(),C=n(T);r(T),z(()=>H(C,`Study: ${t(O)??""}`)),p(P,T)};k(q,P=>{t(O)&&P(I)})}r(A),p(o,A)};k(_,o=>{a()&&o(b)})}var M=l(_,2),Q=n(M);{var $=o=>{Ee(o,{ring:!0,size:"medium"})},ee=o=>{var A=St(),f=be(A);{var g=q=>{var I=Ct(),P=n(I);const T=oe(()=>{var C;return(C=a())==null?void 0:C.values});$e(P,{get allOptions(){return t(T)},onscroll:ve,get unselectedOptions(){return t(v)},set unselectedOptions(C){c(v,C,!0)},get selectedOptions(){return t(N)},set selectedOptions(C){c(N,C,!0)},get currentlyLoading(){return t(L)},set currentlyLoading(C){c(L,C,!0)}}),r(I),p(q,I)},x=(q,I)=>{{var P=T=>{var C=kt(),xe=n(C),fe=n(xe),ue=n(fe),ze=n(ue);r(ue);var he=l(ue,2);ye(he),r(fe);var we=l(fe,2),me=n(we),He=n(me);r(me);var Ae=l(me,2);ye(Ae),r(we),r(xe),r(C),z(()=>{H(ze,`Min: ${t(w)??""}`),H(He,`Max: ${t(U)??""}`)}),Ne(he,()=>t(i),_e=>c(i,_e)),Ne(Ae,()=>t(E),_e=>c(E,_e)),p(T,C)};k(q,T=>{var C;((C=a())==null?void 0:C.type)==="Continuous"&&T(P)},I)}};k(f,q=>{var I;((I=a())==null?void 0:I.type)==="Categorical"?q(g):q(x,!1)})}var j=l(f,2);j.__click=X,z(()=>j.disabled=a().type==="Categorical"&&t(K).length===0),p(o,A)};k(Q,o=>{a()?o(ee,!1):o($)})}r(M),r(D),p(d,D),re(),V()}ge(["click"]);export{Tt as A,ae as a,Ce as b,se as c,Zt as s};
