import{w as u}from"./entry.DxzR7bMM.js";import{g as a,p as w,a as b}from"./User.C8JF3DW-.js";import{r as c}from"./scheduler.bui7uCNy.js";function f(s){return{...s,connection:s.connection?s.connection.uuid:"",roles:s.roles?s.roles.map(o=>o.uuid):[]}}const d="psama/user",p=u(!1),e=u([]);async function y(){if(c(p))return;const s=await a(d);e.set(s.map(f)),p.set(!0)}async function g(s){const n=c(e).find(r=>r.uuid===s);if(n)return n;const t=await a(`${d}/${s}`);return f(t)}async function C(s){const o=await w(d,[s]),n=f(o.content[0]),t=c(e);t.push(n),e.set(t)}async function $(s){const o=await b(d,[s]),n=f(o.content[0]),t=c(e),r=t.findIndex(U=>U.uuid===n.uuid);r===-1?t.push(n):t[r]=n,e.set(t)}const E={subscribe:e.subscribe,users:e,loadUsers:y,getUser:g,addUser:C,updateUser:$},m="psama/connection",l=u(!1),i=u([]);async function x(){if(c(l))return;const s=await a(m);i.set(s),l.set(!0)}async function R(s){const n=c(i).find(r=>r.uuid===s);return n||await a(`${m}/${s}`)}const I={subscribe:i.subscribe,connections:i,loadConnections:x,getConnection:R};export{I as C,E as U};
