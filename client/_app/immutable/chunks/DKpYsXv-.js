import{d as f,w as p}from"./ClzUMQ0P.js";import{g as d,p as m,b as g,d as R}from"./BEf3cR2P.js";import{l as r}from"./CDvIr29H.js";function c(e){return{...e,privileges:e.privileges?e.privileges.map(s=>s.uuid):[]}}const a="psama/role",u=p(!1),n=p([]),v=f(n,e=>e.map(s=>[s.name,s.uuid||""]),[]);async function w(){if(r(u))return;const e=await d(a);n.set(e.map(c)),u.set(!0)}async function b(e){const t=r(n).find(i=>i.uuid===e);if(t)return t;const o=await d(`${a}/${e}`);return c(o)}async function x(e){const s=await m(a,[{...e,privileges:e.privileges.map(i=>({uuid:i}))}]),t=c(s.content[0]),o=r(n);o.push(t),n.set(o)}async function y(e){const s=await g(a,[{...e,privileges:e.privileges.map(l=>({uuid:l}))}]),t=c(s.content[0]),o=r(n),i=o.findIndex(l=>l.uuid===t.uuid);i===-1?o.push(t):o[i]=t,n.set(o)}async function I(e){await R(`${a}/${e}`);const s=r(n),t=s.findIndex(o=>o.uuid===e);t>-1&&(s.splice(t,1),n.set(s))}const L={subscribe:n.subscribe,roles:n,roleList:v,loadRoles:w,getRole:b,addRole:x,updateRole:y,deleteRole:I};export{L as R,x as a,b as g,w as l,n as r,y as u};
