import{d,w as c,g as m}from"./B9BhT3Ut.js";import{g as u,k as o,p as y}from"./tvkVmxlD.js";function g(e){const t=new Date(e),s=t.toLocaleString("default",{year:"numeric"}),a=t.toLocaleString("default",{month:"2-digit"}),r=t.toLocaleString("default",{day:"2-digit"});return s+"-"+a+"-"+r}function i(e){let t,s;try{const r=JSON.parse(e.query.query);t=r==null?void 0:r.query,r!=null&&r.commonAreaUUID&&(s={commonId:r==null?void 0:r.commonAreaUUID})}catch{t={}}return{uuid:e.uuid,user:e.user,name:e.name,archived:e.archived,metadata:e.metadata,query:t,federated:s,queryId:e.query.uuid,startTime:g(e.query.startTime),rawStartTime:e.query.startTime}}const n=c([]),v=c(void 0),D=c({}),I=d(n,e=>e.filter(t=>!t.archived).sort((t,s)=>s.rawStartTime-t.rawStartTime)),S=d(n,e=>e.filter(t=>t.archived));async function p(){const e=await u(o.NamedDataSet);n.set(e.map(i))}async function w(e){const t=m(n),s=t.findIndex(l=>l.uuid===e);if(s===-1)return Promise.reject("Could not find dataset in store.");const a=t[s],r={queryId:a==null?void 0:a.queryId,name:a==null?void 0:a.name,metadata:a==null?void 0:a.metadata,archived:!(a!=null&&a.archived)},f=await y(`${o.NamedDataSet}/${e}`,r);t[s]=i(f),n.set(t)}async function T(e){const t=m(n),s=t.findIndex(r=>r.uuid===e);if(s>-1)return t[s];const a=await u(`${o.NamedDataSet}/${e}`);return i(a)}n.subscribe;export{I as a,S as b,v as c,D as f,T as g,p as l,w as t};
