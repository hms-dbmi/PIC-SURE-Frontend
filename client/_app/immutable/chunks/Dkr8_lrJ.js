import{w as f,g as r}from"./DlIBaGjY.js";import{g as d,P as i,p,c as m}from"./BRrMSDP5.js";function a(s){return{...s,connection:s.connection?s.connection.uuid:"",roles:s.roles?s.roles.map(o=>o.uuid):[]}}const u=f(!1),t=f([]);async function U(){if(r(u))return;const s=await d(i.Users);t.set(s.map(a)),u.set(!0)}async function w(s){const e=r(t).find(c=>c.uuid===s);if(e)return e;const n=await d(`${i.Users}/${s}`);return a(n)}async function y(s,o){let e=r(t);return e.length===0&&(await U(),e=r(t)),e.find(n=>n.email===s&&n.connection===o)}async function x(s){const o=await m(i.Users,[s]),e=a(o[0]),n=r(t);n.push(e),t.set(n)}async function h(s){const o=await p(i.Users,[s]),e=a(o[0]),n=r(t),c=n.findIndex(l=>l.uuid===e.uuid);c===-1?n.push(e):n[c]=e,t.set(n)}const $={subscribe:t.subscribe,users:t,loadUsers:U,getUser:w};export{$ as U,y as a,x as b,w as g,h as u};
