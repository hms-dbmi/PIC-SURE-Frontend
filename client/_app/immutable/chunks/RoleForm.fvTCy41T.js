import{s as Y,e as m,a as E,c as g,b as T,l as q,g as L,f as N,m as u,i as X,h as i,U,O as B,W as Z,n as H,R as $,w as ee,t as te,d as le,j as ae}from"./scheduler.bui7uCNy.js";import{e as J}from"./each.Ct-HShz-.js";import{S as ne,i as se}from"./index.Divvo4fc.js";import{g as re}from"./entry.D9nKiiu7.js";import{g as ie}from"./stores.ClIv_1MU.js";import"./ProgressBar.svelte_svelte_type_style_lang.B7SkmbeT.js";import{t as K}from"./Validation.CZHOOfu3.js";import{R as oe}from"./Roles.CFgBlLBg.js";function Q(n,e,l){const h=n.slice();return h[3]=e[l][0],h[12]=e,h[13]=l,h}function V(n){let e,l,h,x,b=n[3]+"",t,k,c,d;function y(){n[8].call(l,n[13])}return{c(){e=m("label"),l=m("input"),h=E(),x=m("p"),t=te(b),k=E(),this.h()},l(v){e=g(v,"LABEL",{class:!0});var a=T(e);l=g(a,"INPUT",{class:!0,type:!0}),h=L(a),x=g(a,"P",{});var R=T(x);t=le(R,b),R.forEach(N),k=L(a),a.forEach(N),this.h()},h(){u(l,"class","checkbox"),u(l,"type","checkbox"),u(e,"class","flex items-center space-x-2 svelte-1hg36ee")},m(v,a){X(v,e,a),i(e,l),l.checked=n[2][n[13]].checked,i(e,h),i(e,x),i(x,t),i(e,k),c||(d=B(l,"change",y),c=!0)},p(v,a){n=v,a&4&&(l.checked=n[2][n[13]].checked),a&1&&b!==(b=n[3]+"")&&ae(t,b)},d(v){v&&N(e),c=!1,d()}}}function ue(n){let e,l,h,x="Name:",b,t,k,c,d,y="Description:",v,a,R,_,o,C="Privileges:",z,D,S,G="Save",F,w,M="Cancel",O,W,P=J(n[0]),f=[];for(let s=0;s<P.length;s+=1)f[s]=V(Q(n,P,s));return{c(){e=m("form"),l=m("label"),h=m("span"),h.textContent=x,b=E(),t=m("input"),k=E(),c=m("label"),d=m("span"),d.textContent=y,v=E(),a=m("input"),R=E(),_=m("fieldset"),o=m("legend"),o.textContent=C,z=E();for(let s=0;s<f.length;s+=1)f[s].c();D=E(),S=m("button"),S.textContent=G,F=E(),w=m("a"),w.textContent=M,this.h()},l(s){e=g(s,"FORM",{});var p=T(e);l=g(p,"LABEL",{class:!0});var r=T(l);h=g(r,"SPAN",{"data-svelte-h":!0}),q(h)!=="svelte-m2peuz"&&(h.textContent=x),b=L(r),t=g(r,"INPUT",{type:!0,class:!0,pattern:!0,minlength:!0,maxlength:!0}),r.forEach(N),k=L(p),c=g(p,"LABEL",{class:!0});var A=T(c);d=g(A,"SPAN",{"data-svelte-h":!0}),q(d)!=="svelte-n5lbfe"&&(d.textContent=y),v=L(A),a=g(A,"INPUT",{type:!0,class:!0,pattern:!0,minlength:!0,maxlength:!0}),A.forEach(N),R=L(p),_=g(p,"FIELDSET",{"data-testid":!0,class:!0});var I=T(_);o=g(I,"LEGEND",{"data-svelte-h":!0}),q(o)!=="svelte-k8qk28"&&(o.textContent=C),z=L(I);for(let j=0;j<f.length;j+=1)f[j].l(I);I.forEach(N),D=L(p),S=g(p,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),q(S)!=="svelte-uo67us"&&(S.textContent=G),F=L(p),w=g(p,"A",{href:!0,class:!0,"data-svelte-h":!0}),q(w)!=="svelte-muwtns"&&(w.textContent=M),p.forEach(N),this.h()},h(){u(t,"type","text"),u(t,"class","input"),t.required=!0,u(t,"pattern",K),u(t,"minlength","1"),u(t,"maxlength","255"),u(l,"class","label required svelte-1hg36ee"),u(a,"type","text"),u(a,"class","input"),a.required=!0,u(a,"pattern",K),u(a,"minlength","1"),u(a,"maxlength","255"),u(c,"class","label required svelte-1hg36ee"),u(_,"data-testid","privilege-checkboxes"),u(_,"class","svelte-1hg36ee"),u(S,"type","submit"),u(S,"class","btn variant-ghost-primary hover:variant-filled-primary"),u(w,"href","/admin/authorization"),u(w,"class","btn variant-ghost-secondary hover:variant-filled-secondary")},m(s,p){X(s,e,p),i(e,l),i(l,h),i(l,b),i(l,t),U(t,n[3]),i(e,k),i(e,c),i(c,d),i(c,v),i(c,a),U(a,n[1]),i(e,R),i(e,_),i(_,o),i(_,z);for(let r=0;r<f.length;r+=1)f[r]&&f[r].m(_,null);i(e,D),i(e,S),i(e,F),i(e,w),O||(W=[B(t,"input",n[6]),B(a,"input",n[7]),B(e,"submit",Z(n[4]))],O=!0)},p(s,[p]){if(p&8&&t.value!==s[3]&&U(t,s[3]),p&2&&a.value!==s[1]&&U(a,s[1]),p&5){P=J(s[0]);let r;for(r=0;r<P.length;r+=1){const A=Q(s,P,r);f[r]?f[r].p(A,p):(f[r]=V(A),f[r].c(),f[r].m(_,null))}for(;r<f.length;r+=1)f[r].d(1);f.length=P.length}},i:H,o:H,d(s){s&&N(e),$(f,s),O=!1,ee(W)}}}function ce(n,e,l){const h=ie(),{addRole:x,updateRole:b}=oe;let{role:t=void 0}=e,{privilegeList:k}=e,c=t?t.name:"",d=t?t.description:"",y=k.map(([o,C])=>({uuid:C,checked:t?t.privileges.includes(C):!1}));async function v(){let o={name:c,description:d,privileges:y.filter(C=>C.checked).map(C=>C.uuid)};try{t?(o={...o,uuid:t.uuid},await b(o)):await x(o),h.trigger({message:`Successfully saved ${o?"new role":"role"} '${c}'`,background:"variant-filled-success"}),re("/admin/authorization")}catch(C){console.error(C),h.trigger({message:`An error occured while saving ${o?"new role":"role"} '${c}'`,background:"variant-filled-error"})}}function a(){c=this.value,l(3,c)}function R(){d=this.value,l(1,d)}function _(o){y[o].checked=this.checked,l(2,y)}return n.$$set=o=>{"role"in o&&l(5,t=o.role),"privilegeList"in o&&l(0,k=o.privilegeList)},[k,d,y,c,v,t,a,R,_]}class be extends ne{constructor(e){super(),se(this,e,ce,ue,Y,{role:5,privilegeList:0})}}export{be as R};
