import"./Bzak7iHL.js";import{p as K,f as v,k as t,u as E,d as u,r as d,s as I,t as Q,b as o,c as V,aH as we,h as oe,i as ne,e as te,a as A,n as le,j as de,l as se}from"./DhSNEPDw.js";import{e as q,i as ee}from"./ByI6iVq5.js";import{g as z,a as Se,s as N}from"./CJ66PCUx.js";import{p as i,s as ce,a as J}from"./DpjY2ypC.js";import{L as Ce,M as De,N as ae,g as Be,P as me,O as ye,c as Oe,Q as Le,l as Pe,t as Ie,R as ue,u as fe}from"./BNC-bmXQ.js";import{s as F,d as je}from"./DVtHS8ol.js";import{i as M}from"./BG76zvuN.js";import{u as ve,n as ge,L as ke}from"./bwStxD3u.js";import{p as Ae}from"./CftmxiRQ.js";import{f as W,b as k}from"./BZHGrlEE.js";import{o as Me}from"./xU7jw7XU.js";import{a as Ee}from"./Jhkhy7E3.js";import{h as We}from"./DgX2KM8m.js";import{g as He}from"./BPde4ukL.js";import{s as Re}from"./COZ3s8UQ.js";import{E as ze}from"./nxdkf_Tf.js";import{M as Fe}from"./B9gq-btx.js";var Ue=v("<button>&times;</button>"),Ge=v('<div><div data-testid="toast-message"><span> </span> <span> </span></div> <!></div>');function Ne(C,e){K(e,!0);const f=ve(Ce,()=>({...e.toast,parent:e.parent,index:e.index})),m=E(()=>De(f,ge)),D=E(()=>{switch(t(m).type){case"success":return e.stateSuccess;case"warning":return e.stateWarning;case"error":return e.stateError;default:return e.stateInfo}});var S=Ge();z(S,n=>({class:`${e.base??""} ${e.width??""} ${e.padding??""} ${e.rounded??""} ${t(D)??""} ${e.classes??""}`,...n,"data-testid":"toast-root"}),[()=>t(m).getRootProps()],void 0,"svelte-rtmh8b");var g=u(S),w=u(g);z(w,n=>({class:`${e.titleBase??""} ${e.titleClasses??""}`,...n,"data-testid":"toast-title"}),[()=>t(m).getTitleProps()],void 0,"svelte-rtmh8b");var j=u(w,!0);d(w);var _=I(w,2);z(_,n=>({class:`${e.descriptionBase??""} ${e.descriptionClasses??""}`,...n,"data-testid":"toast-description"}),[()=>t(m).getDescriptionProps()],void 0,"svelte-rtmh8b");var O=u(_,!0);d(_),d(g);var L=I(g,2);{var h=n=>{var b=Ue();z(b,p=>({class:`${e.btnDismissBase??""} ${e.btnDismissClasses??""}`,title:e.btnDismissTitle,"aria-label":e.btnDismissAriaLabel,...p,"data-testid":"toast-dismiss"}),[()=>t(m).getCloseTriggerProps()],void 0,"svelte-rtmh8b"),o(n,b)};M(L,n=>{t(m).closable&&n(h)})}d(S),Q(()=>{Se(g,1,`${e.messageBase??""} ${e.messageClasses??""}`),F(j,t(m).title),F(O,t(m).description)}),o(C,S),V()}var Qe=v("<div></div>");function Ct(C,e){const f=we();K(e,!0);const m=i(e,"base",3,"flex justify-between items-center gap-3"),D=i(e,"width",3,"min-w-xs"),S=i(e,"padding",3,"p-3"),g=i(e,"rounded",3,"rounded-container"),w=i(e,"classes",3,""),j=i(e,"messageBase",3,"grid"),_=i(e,"messageClasses",3,""),O=i(e,"titleBase",3,"font-semibold"),L=i(e,"titleClasses",3,""),h=i(e,"descriptionBase",3,"text-sm"),n=i(e,"descriptionClasses",3,""),b=i(e,"btnDismissBase",3,"btn-icon hover:preset-tonal"),p=i(e,"btnDismissClasses",3,""),P=i(e,"btnDismissTitle",3,"Dismiss"),x=i(e,"btnDismissAriaLabel",3,"Dismiss"),B=i(e,"stateInfo",3,"preset-outlined-surface-200-800 preset-filled-surface-50-950"),s=i(e,"stateSuccess",3,"preset-filled-success-500"),r=i(e,"stateWarning",3,"preset-filled-warning-500"),a=i(e,"stateError",3,"preset-filled-error-500"),l=ve(ae.machine,()=>({id:f,store:e.toaster})),c=E(()=>ae.connect(l,ge));var T=Qe();z(T,y=>({...y,"data-testid":"toaster-root"}),[()=>t(c).getGroupProps()]),q(T,23,()=>t(c).getToasts(),y=>y.id,(y,X,H,U)=>{Ne(y,{get base(){return m()},get width(){return D()},get padding(){return S()},get rounded(){return g()},get classes(){return w()},get messageBase(){return j()},get messageClasses(){return _()},get titleBase(){return O()},get titleClasses(){return L()},get descriptionBase(){return h()},get descriptionClasses(){return n()},get btnDismissBase(){return b()},get btnDismissClasses(){return p()},get btnDismissTitle(){return P()},get btnDismissAriaLabel(){return x()},get stateInfo(){return B()},get stateError(){return a()},get stateWarning(){return r()},get stateSuccess(){return s()},get toast(){return t(X)},get index(){return t(H)},get parent(){return l}})}),d(T),o(C,T),V()}function qe(C,e){Oe(me.TOS+"/accept",{}).then(()=>{const f=Le();f&&Pe(f).then(()=>{e(!1)})}).catch(f=>{console.error(f),Ie.error({description:"An error occured while saving user terms acceptance."})})}function Je(){ye().then(()=>{k.termsOfService.rejectionUrl?window.location.href=k.termsOfService.rejectionUrl:He("/login")})}function ie(C,e){e()!==void 0&&e(!1)}var Ke=v('<button type="button" data-testid="terms-reject-btn" class="btn border preset-tonal-primary hover:preset-filled-primary-500">Reject</button> <button type="button" data-testid="terms-accept-btn" class="btn preset-filled-primary-500">Accept</button>',1),Ve=v('<button type="button" data-testid="terms-close-btn" class="btn border preset-tonal-primary hover:preset-filled-primary-500">Close</button>'),Xe=v('<div id="terms-of-service"><!></div> <footer class="modal-footer flex justify-end space-x-2 mt-6"><!></footer>',1),Ye=v('<button type="button" data-testid="terms-close-btn" class="btn border preset-tonal-primary hover:preset-filled-primary-500">Close</button>'),Ze=v("<!> <!>",1);function $e(C,e){K(e,!0);const f=()=>J(ue,"$isLoggedIn",D),m=()=>J(fe,"$user",D),[D,S]=ce();let g=i(e,"modalOpen",15,!1),w=oe(ne(Promise.resolve(""))),j=E(()=>W.enforceTermsOfService&&f()&&!m().acceptedTOS);function _(){se(w,Be(me.TOS+"/latest",{},!1),!0)}Me(_);var O=te(),L=A(O);Ee(L,()=>t(w),h=>{ke(h,{})},(h,n)=>{var b=Xe(),p=A(b),P=u(p);We(P,()=>Re(t(n))),d(p);var x=I(p,2),B=u(x);{var s=a=>{var l=Ke(),c=A(l);c.__click=[Je];var T=I(c,2);T.__click=[qe,g],o(a,l)},r=a=>{var l=Ve();l.__click=[ie,g],o(a,l)};M(B,a=>{t(j)?a(s):a(r,!1)})}d(x),o(h,b)},h=>{var n=Ze(),b=A(n);ze(b,{"data-testid":"terms-api-error",children:(x,B)=>{le();var s=de("Could not load terms of service. Please contact an administrator.");o(x,s)},$$slots:{default:!0}});var p=I(b,2);{var P=x=>{var B=Ye();B.__click=[ie,g],o(x,B)};M(p,x=>{g()!==void 0&&x(P)})}o(h,n)}),o(C,O),V(),S()}je(["click"]);var et=v('<li class="text-center"><a class="hover:underline"> </a></li>'),tt=v('<ul class="basis-1/8"><li class="font-bold text-center"> </li> <!></ul>'),st=v('<div id="sitemap-footer"><div class="flex flex-wrap place-content-center"></div></div>'),rt=v("<li><!></li>"),at=v('<li><a class="hover:underline text-[0.74rem]"> </a></li>'),it=v('<!> <footer id="main-footer" class="flex relativem mt-4"><ul><!> <!></ul></footer>',1);function Dt(C,e){K(e,!0);const f=()=>J(fe,"$user",D),m=()=>J(ue,"$isLoggedIn",D),[D,S]=ce();let g=i(e,"showSitemap",19,()=>{var s,r;return((r=(s=k)==null?void 0:s.footer)==null?void 0:r.showSitemap)||!1}),w=E(()=>{var s,r,a;return!g()||((a=(r=(s=k)==null?void 0:s.footer)==null?void 0:r.excludeSitemapOn)==null?void 0:a.find(l=>Ae.url.pathname.includes(l)))}),j=E(()=>{var s,r;return(r=(s=k)==null?void 0:s.sitemap)==null?void 0:r.map(a=>({...a,show:(!a.privilege||f().privileges&&f().privileges.includes(a.privilege))&&(!a.feature||W[a.feature])}))}),_=oe(ne(W.enforceTermsOfService&&m()&&!f().acceptedTOS)),O=E(()=>{var s;return!W.enforceTermsOfService||!m()||m()&&!!((s=f())!=null&&s.acceptedTOS)});var L=it(),h=A(L);{var n=s=>{var r=st(),a=u(r);q(a,21,()=>t(j),ee,(l,c)=>{var T=te(),y=A(T);{var X=H=>{var U=tt(),Y=u(U),be=u(Y,!0);d(Y);var _e=I(Y,2);q(_e,17,()=>t(c).links,ee,(he,R)=>{var re=te(),pe=A(re);{var xe=Z=>{var $=et(),G=u($),Te=u(G,!0);d(G),d($),Q(()=>{N(G,"target",t(R).newTab?"_blank":"_self"),N(G,"href",t(R).url),F(Te,t(R).title)}),o(Z,$)};M(pe,Z=>{(!t(R).feature||W[t(R).feature])&&Z(xe)})}o(he,re)}),d(U),Q(()=>F(be,t(c).category)),o(H,U)};M(y,H=>{t(c).show&&H(X)})}o(l,T)}),d(a),d(r),o(s,r)};M(h,s=>{var r,a;!t(w)&&((a=(r=k)==null?void 0:r.sitemap)==null?void 0:a.length)>0&&s(n)})}var b=I(h,2),p=u(b),P=u(p);{var x=s=>{var r=rt(),a=u(r);Fe(a,{"data-testid":"terms-of-service",width:"w-3/4",height:"h-full",triggerBase:"hover:underline text-[0.74rem]",withDefault:!1,footerButtons:!1,get closeable(){return t(O)},get open(){return t(_)},set open(c){se(_,c,!0)},trigger:c=>{le();var T=de("Terms of Service");o(c,T)},children:(c,T)=>{$e(c,{get modalOpen(){return t(_)},set modalOpen(y){se(_,y,!0)}})},$$slots:{trigger:!0,default:!0}}),d(r),o(s,r)};M(P,s=>{W.termsOfService&&s(x)})}var B=I(P,2);q(B,17,()=>{var s,r;return(r=(s=k)==null?void 0:s.footer)==null?void 0:r.links},ee,(s,r)=>{var a=at(),l=u(a),c=u(l,!0);d(l),d(a),Q(()=>{N(l,"target",t(r).newTab?"_blank":"_self"),N(l,"href",t(r).url),F(c,t(r).title)}),o(s,a)}),d(p),d(b),o(C,L),V(),S()}export{Dt as F,Ct as T};
