import{p as o,u as d}from"./User.KscV_1bU.js";import{p as f}from"./stores.CPF93CS5.js";import{w as h}from"./entry.Df3FuYeh.js";import{r as u}from"./scheduler.bui7uCNy.js";const l="picsure/proxy/dictionary-api/",p="picsure/proxy/dictionary-api/concepts",m="picsure/proxy/dictionary-api/concepts/detail/",g=h({}),a=new Map;function y(s,t){!s||!t||(a.size>100&&a.clear(),a.set(s,t))}function b(s="",t,n){let e={facets:t,search:s};return u(f).url.pathname.includes("/discover")||(e=c(e)),o(`${p}?page_number=${n.pageNumber}&page_size=${n.pageSize}`,e)}function w(s){const t=s.map(n=>({name:n.name,values:n.facets.filter(e=>e.count===0).map(e=>e.name)})).reduce((n,e)=>(n[e.name]=e.values,n),{});console.log("Found the following facets that should be hidden: {}",t),g.set(t)}async function q(s,t){let n={facets:t,search:s};u(f).url.pathname.includes("/discover")||(n=c(n));try{const e=await o(`${l}facets/`,n);return t.length===0&&s.length===0&&w(e),e}catch(e){throw console.error("Failed to update facets from search:",e),e}}async function z(s,t){const n=`${m}${t}`,e=String.raw`${s.replace(/\\\\/g,"\\")}`;if(a.has(e))return a.get(e);const r=await o(n,e);if(!r)throw new Error("No response");return y(e,r),r}function c(s){var n;const t=(n=u(d))==null?void 0:n.queryTemplate;if(t){const r=t.categoryFilters["\\_consents\\"];s.consents=r}return s}async function U(s=!1){let t={facets:[],search:"",consents:[]};return s||(t=c(t)),(await o(`${p}?page_number=1&page_size=1`,t)).totalElements}async function x(s=!1){let t={facets:[],search:"",consents:[]};s||(t=c(t));const e=(await o(`${l}facets/`,t)).find(i=>i.name==="dataset_id");return e?s?e.facets.length:e.facets.filter(i=>i.count>0).length:0}export{x as a,U as b,z as g,g as h,b as s,q as u};
