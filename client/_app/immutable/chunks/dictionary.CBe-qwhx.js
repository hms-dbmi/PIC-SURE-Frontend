import{p as o,u as d,g as h}from"./User.C-oF0fl0.js";import{p as f}from"./stores.BNv7cvyh.js";import{w as m}from"./entry.Bvh0VnfG.js";import{r as u}from"./scheduler.bui7uCNy.js";const l="picsure/proxy/dictionary-api/",p="picsure/proxy/dictionary-api/concepts",g="picsure/proxy/dictionary-api/concepts/detail/",y="picsure/proxy/dictionary-api/dashboard-drawer/",w=m({}),n=new Map;function $(s,t){!s||!t||(n.size>100&&n.clear(),n.set(s,t))}function U(s="",t,r){let e={facets:t,search:s};return u(f).url.pathname.includes("/discover")||(e=c(e)),o(`${p}?page_number=${r.pageNumber}&page_size=${r.pageSize}`,e)}function C(s){const t=s.map(r=>({name:r.name,values:r.facets.filter(e=>e.count===0).map(e=>e.name)})).reduce((r,e)=>(r[e.name]=e.values,r),{});console.log("Found the following facets that should be hidden: {}",t),w.set(t)}async function q(s,t){let r={facets:t,search:s};u(f).url.pathname.includes("/discover")||(r=c(r));try{const e=await o(`${l}facets/`,r);return t.length===0&&s.length===0&&C(e),e}catch(e){throw console.error("Failed to update facets from search:",e),e}}async function x(s,t){const r=`${g}${t}`,e=String.raw`${s.replace(/\\\\/g,"\\")}`;if(n.has(e))return n.get(e);const a=await o(r,e);if(!a)throw new Error("No response");return $(e,a),a}function c(s){var r;const t=(r=u(d))==null?void 0:r.queryTemplate;if(t){const a=t.categoryFilters["\\_consents\\"];s.consents=a}return s}async function z(s=!1){let t={facets:[],search:"",consents:[]};return s||(t=c(t)),(await o(`${p}?page_number=1&page_size=1`,t)).totalElements}async function S(s=!1){let t={facets:[],search:"",consents:[]};s||(t=c(t));const e=(await o(`${l}facets/`,t)).find(i=>i.name==="dataset_id");return e?s?e.facets.length:e.facets.filter(i=>i.count>0).length:0}async function v(s){return h(`${y}${s}`)}export{S as a,z as b,v as c,x as g,w as h,U as s,q as u};
