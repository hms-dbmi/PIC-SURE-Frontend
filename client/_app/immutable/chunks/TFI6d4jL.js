var R=Object.defineProperty;var V=(i,t,a)=>t in i?R(i,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[t]=a;var r=(i,t,a)=>V(i,typeof t!="symbol"?t+"":t,a);import"./CHRSknKA.js";import{g as n}from"./DlIBaGjY.js";import{r as g}from"./yAhaO9Md.js";import{f as O,h as q}from"./CwvcP1kx.js";import{e as v}from"./BK8ReYLX.js";class u{constructor(t){r(this,"categoryFilters");r(this,"numericFilters");r(this,"requiredFields");r(this,"anyRecordOf");r(this,"anyRecordOfMulti");r(this,"fields");r(this,"crossCountFields");r(this,"variantInfoFilters");r(this,"expectedResultType");var s;this.categoryFilters=(t==null?void 0:t.categoryFilters)||{},this.numericFilters=(t==null?void 0:t.numericFilters)||{},this.requiredFields=(t==null?void 0:t.requiredFields)||[],this.anyRecordOf=(t==null?void 0:t.anyRecordOf)||[],this.anyRecordOfMulti=(t==null?void 0:t.anyRecordOfMulti)||[],this.crossCountFields=(t==null?void 0:t.crossCountFields)||void 0,this.fields=(t==null?void 0:t.fields)||[];const a=((s=t==null?void 0:t.variantInfoFilters)==null?void 0:s[0])||{categoryVariantInfoFilters:{},numericVariantInfoFilters:{}};this.variantInfoFilters=[a],this.expectedResultType=(t==null?void 0:t.expectedResultType)||"COUNT"}addCategoryFilter(t,a){this.categoryFilters[t]=a}removeCategoryFilter(t){delete this.categoryFilters[t]}addNumericFilter(t,a,s){this.numericFilters[t]={min:a.toString(),max:s.toString()}}addCategoryVariantInfoFilters(t){this.variantInfoFilters[0].categoryVariantInfoFilters={Gene_with_variant:t.Gene_with_variant,Variant_consequence_calculated:t.Variant_consequence_calculated,Variant_frequency_as_text:t.Variant_frequency_as_text}}addAnyRecordOfMulti(t){this.anyRecordOfMulti.push(t)}setCrossCountFields(t){this.crossCountFields=t}addSnpFilter(t){t.forEach(a=>{this.categoryFilters[a.search]=a.constraint.split(",")})}addRequiredField(t){this.requiredFields.push(t)}addField(t){this.fields.push(t)}addAnyRecordOf(t){this.anyRecordOf.push(t)}hasGenomicFilter(){var e,o,c,d,l,h,F,f,_;const t=((c=(o=(e=this.variantInfoFilters[0])==null?void 0:e.categoryVariantInfoFilters)==null?void 0:o.Gene_with_variant)==null?void 0:c.length)||0,a=((h=(l=(d=this.variantInfoFilters[0])==null?void 0:d.categoryVariantInfoFilters)==null?void 0:l.Variant_consequence_calculated)==null?void 0:h.length)||0,s=((_=(f=(F=this.variantInfoFilters[0])==null?void 0:F.categoryVariantInfoFilters)==null?void 0:f.Variant_frequency_as_text)==null?void 0:_.length)||0;return t+a+s}hasFilter(){return Object.keys(this.categoryFilters).length+Object.keys(this.numericFilters).length+this.hasGenomicFilter()+this.requiredFields.length+this.anyRecordOf.length}}const C="\\DCC Harmonized data set",I="\\_harmonized_consent\\",x="\\_topmed_consents\\";function M(i=!0,t=n(g).hpdsAuth,a="COUNT"){let s=new u;return n(O).forEach(e=>{e.filterType==="Categorical"?e.displayType==="restrict"?s.addCategoryFilter(e.id,e.categoryValues):s.addRequiredField(e.id):e.filterType==="numeric"?s.addNumericFilter(e.id,e.min||"",e.max||""):e.filterType==="genomic"?s.addCategoryVariantInfoFilters({Gene_with_variant:e.Gene_with_variant,Variant_consequence_calculated:e.Variant_consequence_calculated,Variant_frequency_as_text:e.Variant_frequency_as_text}):e.filterType==="snp"?s.addSnpFilter(e.snpValues):e.filterType==="AnyRecordOf"&&s.addAnyRecordOfMulti(e.concepts)}),n(v).forEach(e=>{e.conceptPath&&s.addField(e.conceptPath)}),s.expectedResultType=a,{query:s,resourceUUID:t}}function N(i=!1,t=n(g).hpdsAuth,a="COUNT"){let s=new u;return s.expectedResultType=a,{query:s,resourceUUID:t}}const k=i=>(!m(i.categoryFilters)&&!m(i.numericFilters)&&!p(i.fields)&&!p(i.requiredFields)&&i.removeCategoryFilter(I),n(q)||i.removeCategoryFilter(x),i),m=i=>Object.keys(i).some(t=>t.includes(C)),p=i=>i.some(t=>t.includes(C));export{u as Q,M as a,N as g,k as u};
