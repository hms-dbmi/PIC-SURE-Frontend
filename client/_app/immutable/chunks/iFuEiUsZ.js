import{w as u}from"./BMKj-mzl.js";import{g as p,p as w,b as C,d as m}from"./BF5nqrJG.js";import{l as c}from"./CDvIr29H.js";const a="psama/connection",r=u(!1),o=u([]);async function d(){if(c(r))return;const s=await p(a);o.set(s),r.set(!0)}async function f(s){let e=c(o);e.length===0&&(await d(),e=c(o));const n=e.find(t=>t.uuid===s);if(n)return n;throw new Error("Connection not found.")}async function b(s){const n=(await w(a,[s])).content[0],t=c(o);t.push(n),o.set(t)}async function g(s){const n=(await C(a,[s]))[0],t=c(o),i=t.findIndex(l=>l.uuid===n.uuid);i===-1?t.push(n):t[i]=n,o.set(t)}async function x(s){const e=await f(s);await m(`${a}/${e.id}`);const n=c(o),t=n.findIndex(i=>i.uuid===s);t>-1&&(n.splice(t,1),o.set(n))}const _={subscribe:o.subscribe,connections:o,loadConnections:d,getConnection:f,addConnection:b,updateConnection:g,deleteConnection:x};export{_ as C,b as a,o as c,x as d,f as g,d as l,g as u};
