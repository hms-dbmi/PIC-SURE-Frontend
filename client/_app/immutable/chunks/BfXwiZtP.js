import{f as _,a as n,p as Te,c as te,t as ie}from"./CtfeAAbw.js";import{p as N,c as u,r as l,s as L,g as s,h as E,t as M,a as Q,b as ne,d as le,f as k,n as de,e as se}from"./B4GrenNm.js";import{e as J,i as ee}from"./BdG0KSB2.js";import{e as F,b as Ce,s as q}from"./BPiAbArq.js";import{p as i,s as ce,a as K}from"./DvPjbdiY.js";import{v as Se,w as ye,x as ae,g as Be,P as ue,y as Oe,c as Pe,z as De,l as Ie,t as Le,A as fe,u as me}from"./yAhaO9Md.js";import{s as U}from"./DxSOTiY2.js";import{i as z}from"./CSsnQ7i2.js";import{u as ve,n as ge,L as je}from"./B7pZD2Tm.js";import{p as ke}from"./DRUiW6Zw.js";import{f as R,b as j}from"./CHRSknKA.js";import{o as ze}from"./DlIBaGjY.js";import{d as Ee}from"./D7VV4X-8.js";import{a as Me}from"./bf3FOAR_.js";import{h as Ae}from"./BeImZ7I_.js";import{p as We}from"./CEVJ7K31.js";import{g as Fe}from"./CsA2x4iF.js";import{E as Re}from"./BVg5wqNm.js";import{M as Ue}from"./CtCNvYvu.js";var Ge=_("<button>&times;</button>"),He=_('<div><div data-testid="toast-message"><span> </span> <span> </span></div> <!></div>');function qe(D,e){N(e,!0);const f=ve(Se,()=>({...e.toast,parent:e.parent,index:e.index})),m=E(()=>ye(f,ge)),y=E(()=>{switch(s(m).type){case"success":return e.stateSuccess;case"warning":return e.stateWarning;case"error":return e.stateError;default:return e.stateInfo}});var h=He();let T;var C=u(h),B=u(C);let S;var I=u(B,!0);l(B);var O=L(B,2);let b;var P=u(O,!0);l(O),l(C);var x=L(C,2);{var w=v=>{var d=Ge();let g;M(t=>g=F(d,g,{class:`${e.btnDismissBase??""} ${e.btnDismissClasses??""}`,...t,"data-testid":"toast-dismiss"},"svelte-vdfzso"),[()=>s(m).getCloseTriggerProps()]),n(v,d)};z(x,v=>{s(m).closable&&v(w)})}l(h),M((v,d,g)=>{T=F(h,T,{class:`${e.base??""} ${e.width??""} ${e.padding??""} ${e.rounded??""} ${s(y)??""} ${e.classes??""}`,...v,"data-testid":"toast-root"},"svelte-vdfzso"),Ce(C,1,`${e.messageBase??""} ${e.messageClasses??""}`),S=F(B,S,{class:`${e.titleBase??""} ${e.titleClasses??""}`,...d,"data-testid":"toast-title"},"svelte-vdfzso"),U(I,s(m).title),b=F(O,b,{class:`${e.descriptionBase??""} ${e.descriptionClasses??""}`,...g,"data-testid":"toast-description"},"svelte-vdfzso"),U(P,s(m).description)},[()=>s(m).getRootProps(),()=>s(m).getTitleProps(),()=>s(m).getDescriptionProps()]),n(D,h),Q()}var Je=_("<div></div>");function yt(D,e){const f=Te();N(e,!0);const m=i(e,"base",3,"flex justify-between items-center gap-3"),y=i(e,"width",3,"min-w-xs"),h=i(e,"padding",3,"p-3"),T=i(e,"rounded",3,"rounded-container"),C=i(e,"classes",3,""),B=i(e,"messageBase",3,"grid"),S=i(e,"messageClasses",3,""),I=i(e,"titleBase",3,"font-semibold"),O=i(e,"titleClasses",3,""),b=i(e,"descriptionBase",3,"text-sm"),P=i(e,"descriptionClasses",3,""),x=i(e,"btnDismissBase",3,"btn-icon hover:preset-tonal"),w=i(e,"btnDismissClasses",3,""),v=i(e,"stateInfo",3,"preset-outlined-surface-200-800 preset-filled-surface-50-950"),d=i(e,"stateSuccess",3,"preset-filled-success-500"),g=i(e,"stateWarning",3,"preset-filled-warning-500"),t=i(e,"stateError",3,"preset-filled-error-500"),r=ve(ae.machine,()=>({id:f,store:e.toaster})),a=E(()=>ae.connect(r,ge));var o=Je();let c;J(o,23,()=>s(a).getToasts(),p=>p.id,(p,A,V,G)=>{qe(p,{get base(){return m()},get width(){return y()},get padding(){return h()},get rounded(){return T()},get classes(){return C()},get messageBase(){return B()},get messageClasses(){return S()},get titleBase(){return I()},get titleClasses(){return O()},get descriptionBase(){return b()},get descriptionClasses(){return P()},get btnDismissBase(){return x()},get btnDismissClasses(){return w()},get stateInfo(){return v()},get stateError(){return t()},get stateWarning(){return g()},get stateSuccess(){return d()},get toast(){return s(A)},get index(){return s(V)},parent:r})}),l(o),M(p=>c=F(o,c,{...p,"data-testid":"toaster-root"}),[()=>s(a).getGroupProps()]),n(D,o),Q()}function Ke(D,e){Pe(ue.TOS+"/accept",{}).then(()=>{const f=De();f&&Ie(f).then(()=>{e(!1)})}).catch(f=>{console.error(f),Le.error({description:"An error occured while saving user terms acceptance."})})}function Ne(){Oe().then(()=>{j.termsOfService.rejectionUrl?window.location.href=j.termsOfService.rejectionUrl:Fe("/login")})}function oe(D,e){e()!==void 0&&e(!1)}var Qe=_('<button type="button" data-testid="terms-reject-btn" class="btn border preset-tonal-primary hover:preset-filled-primary-500">Reject</button> <button type="button" data-testid="terms-accept-btn" class="btn preset-filled-primary-500">Accept</button>',1),Ve=_('<button type="button" data-testid="terms-close-btn" class="btn border preset-tonal-primary hover:preset-filled-primary-500">Close</button>'),Xe=_('<div id="terms-of-service"><!></div> <footer class="modal-footer flex justify-end space-x-2 mt-6"><!></footer>',1),Ye=_('<button type="button" data-testid="terms-close-btn" class="btn border preset-tonal-primary hover:preset-filled-primary-500">Close</button>'),Ze=_("<!> <!>",1);function $e(D,e){N(e,!0);const[f,m]=ce(),y=()=>K(fe,"$isLoggedIn",f),h=()=>K(me,"$user",f);let T=i(e,"modalOpen",15,!1),C=ne(le(Promise.resolve(""))),B=E(()=>R.enforceTermsOfService&&y()&&!h().acceptedTOS);function S(){se(C,Be(ue.TOS+"/latest",{},!1),!0)}ze(S);var I=te(),O=k(I);Me(O,()=>s(C),b=>{je(b,{})},(b,P)=>{var x=Xe(),w=k(x),v=u(w);Ae(v,()=>We.sanitize(s(P))),l(w);var d=L(w,2),g=u(d);{var t=a=>{var o=Qe(),c=k(o);c.__click=[Ne];var p=L(c,2);p.__click=[Ke,T],n(a,o)},r=a=>{var o=Ve();o.__click=[oe,T],n(a,o)};z(g,a=>{s(B)?a(t):a(r,!1)})}l(d),n(b,x)},b=>{var P=Ze(),x=k(P);Re(x,{"data-testid":"terms-api-error",children:(d,g)=>{de();var t=ie("Could not load terms of service. Please contact an administrator.");n(d,t)},$$slots:{default:!0}});var w=L(x,2);{var v=d=>{var g=Ye();g.__click=[oe,T],n(d,g)};z(w,d=>{T()!==void 0&&d(v)})}n(b,P)}),n(D,I),Q(),m()}Ee(["click"]);var et=_('<li class="text-center"><a class="hover:underline"> </a></li>'),tt=_('<ul class="basis-1/8"><li class="font-bold text-center"> </li> <!></ul>'),st=_('<div id="sitemap-footer"><div class="flex flex-wrap place-content-center"></div></div>'),rt=_("<li><!></li>"),at=_('<li><a class="hover:underline text-[0.74rem]"> </a></li>'),ot=_('<!> <footer id="main-footer" class="flex relativem mt-4"><ul><!> <!></ul></footer>',1);function Bt(D,e){N(e,!0);const[f,m]=ce(),y=()=>K(me,"$user",f),h=()=>K(fe,"$isLoggedIn",f);let T=i(e,"showSitemap",19,()=>{var t,r;return((r=(t=j)==null?void 0:t.footer)==null?void 0:r.showSitemap)||!1}),C=E(()=>{var t,r,a;return!T()||((a=(r=(t=j)==null?void 0:t.footer)==null?void 0:r.excludeSitemapOn)==null?void 0:a.find(o=>ke.url.pathname.includes(o)))}),B=E(()=>{var t,r;return(r=(t=j)==null?void 0:t.sitemap)==null?void 0:r.map(a=>({...a,show:(!a.privilege||y().privileges&&y().privileges.includes(a.privilege))&&(!a.feature||R[a.feature])}))}),S=ne(le(R.enforceTermsOfService&&h()&&!y().acceptedTOS)),I=E(()=>{var t;return!R.enforceTermsOfService||!h()||h()&&!!((t=y())!=null&&t.acceptedTOS)});var O=ot(),b=k(O);{var P=t=>{var r=st(),a=u(r);J(a,21,()=>s(B),ee,(o,c)=>{var p=te(),A=k(p);{var V=G=>{var X=tt(),Y=u(X),_e=u(Y,!0);l(Y);var be=L(Y,2);J(be,17,()=>s(c).links,ee,(pe,W)=>{var re=te(),he=k(re);{var xe=Z=>{var $=et(),H=u($),we=u(H,!0);l(H),l($),M(()=>{q(H,"target",s(W).newTab?"_blank":"_self"),q(H,"href",s(W).url),U(we,s(W).title)}),n(Z,$)};z(he,Z=>{(!s(W).feature||R[s(W).feature])&&Z(xe)})}n(pe,re)}),l(X),M(()=>U(_e,s(c).category)),n(G,X)};z(A,G=>{s(c).show&&G(V)})}n(o,p)}),l(a),l(r),n(t,r)};z(b,t=>{var r,a;!s(C)&&((a=(r=j)==null?void 0:r.sitemap)==null?void 0:a.length)>0&&t(P)})}var x=L(b,2),w=u(x),v=u(w);{var d=t=>{var r=rt(),a=u(r);Ue(a,{"data-testid":"terms-of-service",width:"w-3/4",height:"h-full",triggerBase:"hover:underline text-[0.74rem]",withDefault:!1,footerButtons:!1,get closeable(){return s(I)},get open(){return s(S)},set open(c){se(S,c,!0)},trigger:c=>{de();var p=ie("Terms of Service");n(c,p)},children:(c,p)=>{$e(c,{get modalOpen(){return s(S)},set modalOpen(A){se(S,A,!0)}})},$$slots:{trigger:!0,default:!0}}),l(r),n(t,r)};z(v,t=>{t(d)})}var g=L(v,2);J(g,17,()=>{var t,r;return(r=(t=j)==null?void 0:t.footer)==null?void 0:r.links},ee,(t,r)=>{var a=at(),o=u(a),c=u(o,!0);l(o),l(a),M(()=>{q(o,"target",s(r).newTab?"_blank":"_self"),q(o,"href",s(r).url),U(c,s(r).title)}),n(t,a)}),l(w),l(x),n(D,O),Q(),m()}export{Bt as F,yt as T};
