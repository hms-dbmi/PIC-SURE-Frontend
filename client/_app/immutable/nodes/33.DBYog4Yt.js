import{s as R,q as v,i as d,n as c,f as l,e as _,t as x,c as b,b as g,d as E,m as u,h as I,r as T,a as q,p as A,g as B,o as L,a3 as M}from"../chunks/scheduler.bui7uCNy.js";import{h as N,u as O}from"../chunks/await_block.B6WJ5gpV.js";import{S as C,i as G,d as $,e as k,m as w,t as p,a as h,f as y}from"../chunks/index.CNwEczq-.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.BuMCQOqK.js";import{P as z}from"../chunks/ProgressBar.9v3SLPZo.js";import{b as F}from"../chunks/configuration.LanpiT2M.js";import{C as H}from"../chunks/Content.BmAiAmv1.js";import{T as j}from"../chunks/Table.CtPI0KtF.js";import{w as P}from"../chunks/entry.Df3FuYeh.js";import{u as J,g as K}from"../chunks/User.KscV_1bU.js";function Q(o){let e,a;return{c(){e=_("a"),a=x("More Info"),this.h()},l(t){e=b(t,"A",{href:!0,class:!0,target:!0});var n=g(e);a=E(n,"More Info"),n.forEach(l),this.h()},h(){u(e,"href",o[0]),u(e,"class","btn variant-ghost-primary hover:variant-filled-primary"),u(e,"target","_blank")},m(t,n){d(t,e,n),I(e,a)},p:c,d(t){t&&l(e)}}}function U(o){let e;return{c(){e=_("i"),this.h()},l(a){e=b(a,"I",{class:!0}),g(e).forEach(l),this.h()},h(){u(e,"class","fa-regular fa-circle-check text-3xl text-success-500")},m(a,t){d(a,e,t)},p:c,d(a){a&&l(e)}}}function V(o){let e;function a(r,s){return r[1]?U:Q}let n=a(o)(o);return{c(){n.c(),e=v()},l(r){n.l(r),e=v()},m(r,s){n.m(r,s),d(r,e,s)},p(r,[s]){n.p(r,s)},i:c,o:c,d(r){r&&l(e),n.d(r)}}}function W(o,e,a){let{data:t={row:{additional_info_link:"",consentGranted:!1}}}=e,n=t.row.additional_info_link,r=t.row.consentGranted;return o.$$set=s=>{"data"in s&&a(2,t=s.data)},[n,r,t]}class X extends C{constructor(e){super(),G(this,e,W,V,R,{data:2})}}const D=P([]),S=P([]);function Y(){return K("picsure/proxy/dictionary-api/dashboard")}function Z(){return!!localStorage.getItem("token")}async function ee(){var s,m;const o=await Y();D.set(o.columns);const e=T(J),a=Z()&&(e==null?void 0:e.queryTemplate);let t=[];a&&(t=((m=(s=e.queryTemplate)==null?void 0:s.categoryFilters)==null?void 0:m["\\_consents\\"])||[]);const r=o.rows.map(te(t)).sort((f,i)=>f.consentGranted===i.consentGranted?ne(f,i):f.consentGranted?-1:1);S.set(r)}function te(o){return e=>{if(!e.accession)return{...e,consentGranted:!1};const a=e.accession.toString();if(/^phs\d+\.v\d+\.p\d+\.c\d+$/.test(a)){const n=a.replace(/\.v\d+\.p\d+/,"");return{...e,consentGranted:o.includes(n)}}return{...e,consentGranted:o.includes(a)}}}function ne(o,e){var n,r;const a=((n=o.abbreviation)==null?void 0:n.toString())||"",t=((r=e.abbreviation)==null?void 0:r.toString())||"";return a.localeCompare(t)}function ae(o){return{c,l:c,m:c,p:c,i:c,o:c,d:c}}function re(o){let e,a;return e=new j({props:{tableName:le,data:o[1],columns:o[0],cellOverides:o[2],defaultRowsPerPage:o[1].length,search:!1,showPagination:!1,stickyHeader:!0}}),{c(){$(e.$$.fragment)},l(t){k(e.$$.fragment,t)},m(t,n){w(e,t,n),a=!0},p(t,n){const r={};n&2&&(r.data=t[1]),n&1&&(r.columns=t[0]),n&2&&(r.defaultRowsPerPage=t[1].length),e.$set(r)},i(t){a||(p(e.$$.fragment,t),a=!0)},o(t){h(e.$$.fragment,t),a=!1},d(t){y(e,t)}}}function oe(o){let e,a;return e=new z({props:{animIndeterminate:"anim-progress-bar"}}),{c(){$(e.$$.fragment)},l(t){k(e.$$.fragment,t)},m(t,n){w(e,t,n),a=!0},p:c,i(t){a||(p(e.$$.fragment,t),a=!0)},o(t){h(e.$$.fragment,t),a=!1},d(t){y(e,t)}}}function se(o){let e,a,t={ctx:o,current:null,token:null,hasCatch:!1,pending:oe,then:re,catch:ae,blocks:[,,,]};return N(o[3],t),{c(){e=_("section"),t.block.c(),this.h()},l(n){e=b(n,"SECTION",{id:!0,class:!0});var r=g(e);t.block.l(r),r.forEach(l),this.h()},h(){u(e,"id","data-container"),u(e,"class","")},m(n,r){d(n,e,r),t.block.m(e,t.anchor=null),t.mount=()=>e,t.anchor=null,a=!0},p(n,r){o=n,O(t,o,r)},i(n){a||(p(t.block),a=!0)},o(n){for(let r=0;r<3;r+=1){const s=t.blocks[r];h(s)}a=!1},d(n){n&&l(e),t.block.d(),t.token=null,t=null}}}function ce(o){let e,a,t;return document.title=F.applicationName,a=new H({props:{title:"Data Dashboard",class:"content-center",full:!0,$$slots:{default:[se]},$$scope:{ctx:o}}}),{c(){e=q(),$(a.$$.fragment)},l(n){A("svelte-1uz9aip",document.head).forEach(l),e=B(n),k(a.$$.fragment,n)},m(n,r){d(n,e,r),w(a,n,r),t=!0},p(n,[r]){const s={};r&67&&(s.$$scope={dirty:r,ctx:n}),a.$set(s)},i(n){t||(p(a.$$.fragment,n),t=!0)},o(n){h(a.$$.fragment,n),t=!1},d(n){n&&l(e),y(a,n)}}}const le="ExplorerTable";function ie(o,e,a){let t,n,r=[],s=[];const m={additional_info_link:X},f=ee();return L(()=>{t=D.subscribe(i=>a(0,r=i)),n=S.subscribe(i=>{a(1,s=i)})}),M(()=>{t&&t(),n&&n()}),[r,s,m,f]}class ke extends C{constructor(e){super(),G(this,e,ie,ce,R,{})}}export{ke as component};
