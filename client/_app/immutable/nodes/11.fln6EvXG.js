import{f as h,a as u}from"../chunks/CtfeAAbw.js";import{o as v}from"../chunks/DlIBaGjY.js";import{p as S,a as w,c as T,r as y}from"../chunks/B4GrenNm.js";import{p as s}from"../chunks/DRUiW6Zw.js";import{g as n}from"../chunks/CsA2x4iF.js";import{f as I}from"../chunks/CHRSknKA.js";import{c as O}from"../chunks/BBo6I-Ix.js";import{f as L}from"../chunks/CwvcP1kx.js";import{p as k}from"../chunks/M_WnVc2Q.js";import{L as E}from"../chunks/B7pZD2Tm.js";import{s as x,l as P}from"../chunks/yAhaO9Md.js";var b=h('<section class="w-full h-full flex flex-col justify-center items-center"><!></section>');function B(c,l){S(l,!0);async function m(){var f,p;let r="/",t;r=sessionStorage.getItem("redirect")||"/",t=sessionStorage.getItem("type");const a=t?(f=s.data)==null?void 0:f.providers.find(e=>e.type===t):void 0;if(!a)throw new Error("Provider not found");const d=await O(a);let o=((p=s.url.hash)==null?void 0:p.split("&"))||[];if(s.url.search.startsWith("?")&&(o=s.url.search.substring(1).split("&")||[]),!o||o.length===0)return new Error("Provider configuration error");await d.authenticate(o).then(e=>{if(!e||!(e!=null&&e.token))throw new Error("User not found");e.acceptedTOS=String(e.acceptedTOS)==="true",I.enforceTermsOfService&&!e.acceptedTOS?(x(e.token),n(r)):P(e.token).then(()=>n(r))})}v(async()=>{k.set(!1),m().catch(t=>{console.error("Login Error: ",t),n("/login/error")});let r=sessionStorage.getItem("filters");if(r){let t=JSON.parse(r||"[]");L.set(t),setTimeout(()=>sessionStorage.setItem("filters","[]"),500)}});var i=b(),g=T(i);E(g,{ring:!0,size:"large",label:"Logging you in"}),y(i),u(c,i),w()}export{B as component};
