import{r as lt}from"../chunks/PD1Wq3xD.js";import{f as ge}from"../chunks/CHRSknKA.js";import{G as nt,ax as dt,ay as ct,O as vt,i as ut,u as Me,az as ft,y as mt,A as gt,t as ht}from"../chunks/BRrMSDP5.js";import{b as pt}from"../chunks/Bt-Xh7oU.js";import{f as d,a as s,p as bt,c as he,t as Pe}from"../chunks/CtfeAAbw.js";import{o as Ae,a as We}from"../chunks/DlIBaGjY.js";import{c as o,s as w,r as i,t as L,p as le,g as r,h as V,a as ne,f as ae,F as xe,e as se,b as me,n as Te,u as Ue}from"../chunks/B4GrenNm.js";import{i as T}from"../chunks/CSsnQ7i2.js";import{s as oe}from"../chunks/BWMYve5J.js";import{p as R,r as _t,s as fe,a as U,c as Ce}from"../chunks/DvPjbdiY.js";import{p as K}from"../chunks/McouLZAx.js";import{g as ke,b as xt}from"../chunks/BNhMDwfB.js";import{T as yt,F as kt}from"../chunks/CcrXzoTY.js";import{r as wt,b as Ye,c as Qe,d as Ft,f as Ie,h as Xe,e as Re,i as Rt,j as Pt,k as Ct,l as Et,m as St}from"../chunks/CpfTO1e4.js";import{s as Z}from"../chunks/DxSOTiY2.js";import{e as pe,i as we}from"../chunks/BdG0KSB2.js";import{b as ve,e as Be,s as ue}from"../chunks/BPiAbArq.js";import{g as Tt,d as be}from"../chunks/D7VV4X-8.js";import{c as It,u as At,n as Ot,L as Ze}from"../chunks/DYQPks66.js";import{c as Bt}from"../chunks/Beo73Wd8.js";import{L as Dt}from"../chunks/IdnDkL5k.js";import{P as zt}from"../chunks/DKsm-Jm2.js";import{E as ze,c as jt,e as Nt}from"../chunks/BK8ReYLX.js";import{t as ye,b as qe,a as He,s as Je}from"../chunks/C4-uZRU6.js";import{e as Ke}from"../chunks/BqrDejZS.js";import{r as Lt,l as $t,h as Vt}from"../chunks/W6mqOHTd.js";import{g as Ve}from"../chunks/DOfTSHX0.js";import{p as Gt,k as Mt}from"../chunks/Dkvo87CO.js";import{M as je,a as et}from"../chunks/D7DxCjf8.js";import{A as Wt}from"../chunks/1NpI-4io.js";import{C as Ee}from"../chunks/C8guQpMT.js";import{a as tt}from"../chunks/bf3FOAR_.js";import{S as _e,c as Ut}from"../chunks/C5XwwNd9.js";import{E as Le}from"../chunks/BVg5wqNm.js";import{p as Se}from"../chunks/M_WnVc2Q.js";import{o as Ge,a as Yt}from"../chunks/Pl3Wknuh.js";import{f as Qt}from"../chunks/bY-Ac27V.js";var Xt=d("<div><!></div>"),Zt=d("<div><!></div>"),qt=d("<div><!></div>"),Ht=d('<section data-testid="app-bar-headline"><!></section>'),Jt=d('<header role="toolbar" data-testid="app-bar"><section data-testid="app-bar-toolbar"><!> <!> <!></section> <!></header>');function Kt(a,e){const l=R(e,"base",3,"w-full flex flex-col"),g=R(e,"background",3,"bg-surface-100-900"),p=R(e,"spaceY",3,"space-y-4"),c=R(e,"border",3,""),b=R(e,"padding",3,"p-4"),y=R(e,"shadow",3,""),F=R(e,"classes",3,""),m=R(e,"toolbarBase",3,"flex justify-between"),x=R(e,"toolbarGridCols",3,"grid-cols-[auto_1fr_auto]"),h=R(e,"toolbarGap",3,"gap-4"),v=R(e,"toolbarClasses",3,""),P=R(e,"leadBase",3,"flex"),f=R(e,"leadSpaceX",3,"space-x-4 rtl:space-x-reverse"),k=R(e,"leadPadding",3,""),_=R(e,"leadClasses",3,""),u=R(e,"centerBase",3,"grow"),C=R(e,"centerAlign",3,"text-center"),E=R(e,"centerPadding",3,""),S=R(e,"centerClasses",3,""),D=R(e,"trailBase",3,"flex"),A=R(e,"trailSpaceX",3,"space-x-4 rtl:space-x-reverse"),z=R(e,"trailPadding",3,""),Y=R(e,"trailClasses",3,""),Q=R(e,"headlineBase",3,"w-full"),X=R(e,"headlineClasses",3,"");var G=Jt(),J=o(G),t=o(J);{var n=B=>{var N=Xt(),re=o(N);oe(re,()=>e.lead),i(N),L(()=>ve(N,1,`${P()??""} ${f()??""} ${k()??""} ${_()??""}`)),s(B,N)};T(t,B=>{e.lead&&B(n)})}var O=w(t,2);{var j=B=>{var N=Zt(),re=o(N);oe(re,()=>e.children),i(N),L(()=>ve(N,1,`${u()??""} ${C()??""} ${E()??""} ${S()??""}`)),s(B,N)};T(O,B=>{e.children&&B(j)})}var M=w(O,2);{var W=B=>{var N=qt(),re=o(N);oe(re,()=>e.trail),i(N),L(()=>ve(N,1,`${D()??""} ${A()??""} ${z()??""} ${Y()??""}`)),s(B,N)};T(M,B=>{e.trail&&B(W)})}i(J);var q=w(J,2);{var H=B=>{var N=Ht(),re=o(N);oe(re,()=>e.headline),i(N),L(()=>ve(N,1,`${Q()??""} ${X()??""}`)),s(B,N)};T(q,B=>{e.headline&&B(H)})}i(G),L(()=>{ve(G,1,`${l()??""} ${g()??""} ${p()??""} ${c()??""} ${b()??""} ${y()??""} ${F()??""}`),ve(J,1,`${m()??""} ${x()??""} ${h()??""} ${v()??""}`)}),s(a,G)}var ea=vt("avatar").parts("root","image","fallback"),De=ea.build(),at=a=>{var e;return((e=a.ids)==null?void 0:e.root)??`avatar:${a.id}`},rt=a=>{var e;return((e=a.ids)==null?void 0:e.image)??`avatar:${a.id}:image`},ta=a=>{var e;return((e=a.ids)==null?void 0:e.fallback)??`avatar:${a.id}:fallback`},aa=a=>a.getById(at(a)),Ne=a=>a.getById(rt(a));function ra(a,e){const{state:l,send:g,prop:p,scope:c}=a,b=l.matches("loaded");return{loaded:b,setSrc(y){const F=Ne(c);F==null||F.setAttribute("src",y)},setLoaded(){g({type:"img.loaded",src:"api"})},setError(){g({type:"img.error",src:"api"})},getRootProps(){return e.element({...De.root.attrs,dir:p("dir"),id:at(c)})},getImageProps(){return e.img({...De.image.attrs,hidden:!b,dir:p("dir"),id:rt(c),"data-state":b?"visible":"hidden",onLoad(){g({type:"img.loaded",src:"element"})},onError(){g({type:"img.error",src:"element"})}})},getFallbackProps(){return e.element({...De.fallback.attrs,dir:p("dir"),id:ta(c),hidden:b,"data-state":b?"hidden":"visible"})}}}var ia=nt({initialState(){return"loading"},effects:["trackImageRemoval","trackSrcChange"],on:{"src.change":{target:"loading"},"img.unmount":{target:"error"}},states:{loading:{entry:["checkImageStatus"],on:{"img.loaded":{target:"loaded",actions:["invokeOnLoad"]},"img.error":{target:"error",actions:["invokeOnError"]}}},error:{on:{"img.loaded":{target:"loaded",actions:["invokeOnLoad"]}}},loaded:{on:{"img.error":{target:"error",actions:["invokeOnError"]}}}},implementations:{actions:{invokeOnLoad({prop:a}){var e;(e=a("onStatusChange"))==null||e({status:"loaded"})},invokeOnError({prop:a}){var e;(e=a("onStatusChange"))==null||e({status:"error"})},checkImageStatus({send:a,scope:e}){const l=Ne(e);if(!(l!=null&&l.complete))return;const g=sa(l)?"img.loaded":"img.error";a({type:g,src:"ssr"})}},effects:{trackImageRemoval({send:a,scope:e}){const l=aa(e);return ct(l,{callback(g){Array.from(g[0].removedNodes).find(b=>b.nodeType===Node.ELEMENT_NODE&&b.matches("[data-scope=avatar][data-part=image]"))&&a({type:"img.unmount"})}})},trackSrcChange({send:a,scope:e}){const l=Ne(e);return dt(l,{attributes:["src","srcset"],callback(){a({type:"src.change"})}})}}}});function sa(a){return a.complete&&a.naturalWidth!==0&&a.naturalHeight!==0}It()(["dir","id","ids","onStatusChange","getRootNode"]);var oa=d("<img/>"),la=d("<figure><span><!></span> <!></figure>");function na(a,e){const l=bt();le(e,!0);const g=R(e,"base",3,"overflow-hidden isolate"),p=R(e,"background",3,"bg-surface-400-600"),c=R(e,"size",3,"size-16"),b=R(e,"font",3,""),y=R(e,"border",3,""),F=R(e,"rounded",3,"rounded-full"),m=R(e,"shadow",3,""),x=R(e,"classes",3,""),h=R(e,"imageBase",3,"w-full object-cover"),v=R(e,"imageClasses",3,""),P=R(e,"style",3,""),f=R(e,"fallbackBase",3,"w-full h-full flex justify-center items-center"),k=R(e,"fallbackClasses",3,""),_=_t(e,["$$slots","$$events","$$legacy","src","srcset","name","base","background","size","font","border","rounded","shadow","classes","imageBase","imageClasses","style","fallbackBase","fallbackClasses","children"]),u=At(ia,()=>({id:l,..._})),C=V(()=>ra(u,Ot));function E(t){return t.split(" ").map(n=>n[0]).join("")}var S=la();let D;var A=o(S);let z;var Y=o(A);{var Q=t=>{var n=he(),O=ae(n);oe(O,()=>e.children),s(t,n)},X=t=>{var n=Pe();L(O=>Z(n,O),[()=>E(e.name)]),s(t,n)};T(Y,t=>{e.children?t(Q):t(X,!1)})}i(A);var G=w(A,2);{var J=t=>{var n=oa();let O;L(j=>O=Be(n,O,{...j,src:e.src,srcset:e.srcset,alt:e.name,class:`${h()??""} ${v()??""}`,"data-testid":"avatar-image"}),[()=>r(C).getImageProps()]),Tt(n),s(t,n)};T(G,t=>{(e.src||e.srcset)&&t(J)})}i(S),L((t,n)=>{D=Be(S,D,{...t,class:`${g()??""} ${p()??""} ${c()??""} ${b()??""} ${y()??""} ${F()??""} ${m()??""} ${x()??""}`,style:P(),"data-testid":"avatar"}),z=Be(A,z,{...n,class:`${f()??""} ${k()??""}`,"data-testid":"avatar-fallback"})},[()=>r(C).getRootProps(),()=>r(C).getFallbackProps()]),s(a,S),ne()}const da=({url:a})=>{!ge.login.open&&pt&&(!localStorage.getItem("token")||ut(localStorage.getItem("token")||""))&&(Me.set({}),lt(302,`/login?redirectTo=${a.pathname}`))},ri=Object.freeze(Object.defineProperty({__proto__:null,load:da},Symbol.toStringTag,{value:"Module"}));var ca=d('<div style="display: contents"><main class="w-full h-full"><div id="appShell" class="w-full h-full flex flex-col overflow-hidden" data-testid="app-shell"><!> <div class="flex-auto w-full h-full flex overflow-hidden"><div id="page" class="flex-1 overflow-x-hidden flex flex-col"><main id="page-content" class="flex-auto"><!></main> <footer id="page-footer" class="flex-none"><!></footer></div> <!></div></div></main></div>');function va(a,e){var l=ca(),g=o(l),p=o(g),c=o(p);oe(c,()=>e.header??xe);var b=w(c,2),y=o(b),F=o(y),m=o(F);oe(m,()=>e.children??xe),i(F);var x=w(F,2),h=o(x);oe(h,()=>e.pageFooter??xe),i(x),i(y);var v=w(y,2);oe(v,()=>e.sidebarRight??xe),i(b),i(p),i(g),i(l),s(a,l)}function ua(a){a.stopImmediatePropagation(),ke(`/login?redirectTo=${K.url.pathname}`)}var fa=d('<a href="/" aria-current="page" data-testid="logo-home-link" class="content-center"><!></a>'),ma=(a,e)=>mt(r(e),!1),ga=d('<div class="flex flex-col items-center"><p class="pb-6"> </p> <button id="user-logout-btn" class="btn preset-filled-primary-500 w-fit" title="Logout">Logout</button></div>'),ha=d('<button id="user-login-btn" title="Login" class="btn preset-tonal-primary border border-primary-500 hover:preset-filled-primary-500">Login</button>'),pa=d('<div id="user-session-avatar" class="content-center"><!></div>'),ba=d('<li><a class="nav-link"> </a></li>'),_a=d('<nav id="page-navigation"><ul></ul></nav>');function xa(a,e){le(e,!0);const[l,g]=fe(),p=()=>U(ft,"$userRoutes",l),c=()=>U(Me,"$user",l),b=()=>U(gt,"$isLoggedIn",l);let y,F=me(void 0);function m({path:h,id:v}){return"nav-link"+(v?"-"+v:h.replaceAll("/","-"))}let x=V(()=>h=>{if(h.children){for(const v of h.children)if(K.url.pathname.includes(v.path))return"page";return}return K.url.pathname.includes(h.path)?"page":void 0});Ae(async()=>{var h;if(K){const v=sessionStorage.getItem("type");v&&(y=(h=K.data)==null?void 0:h.providers.find(P=>P.type===v),se(F,await Bt(y),!0))}}),Kt(a,{padding:"py-0 pl-2 pr-5",background:"bg-surface-50-950",toolbarClasses:"flex-none z-10",lead:P=>{var f=fa(),k=o(f);Dt(k,{height:4,class:"mx-1"}),i(f),s(P,f)},trail:P=>{var f=pa(),k=o(f);{var _=C=>{zt(C,{trigger:S=>{const D=V(()=>(c().email||"").toUpperCase());na(S,{get name(){return r(D)},background:"preset-tonal-primary hover:preset-tonal-secondary",border:"border hover:border-primary-400",font:"text-2xl",size:"size-12",classes:"m-3"})},children:(S,D)=>{var A=ga(),z=o(A),Y=o(z,!0);i(z);var Q=w(z,2);Q.__click=[ma,F],i(A),L(()=>Z(Y,c().email)),s(S,A)},$$slots:{trigger:!0,default:!0}})},u=C=>{var E=ha();E.__click=[ua],s(C,E)};T(k,C=>{c()&&c().privileges&&c().email&&b()?C(_):C(u,!1)})}i(f),s(P,f)},children:(P,f)=>{var k=_a(),_=o(k);pe(_,5,p,we,(u,C)=>{var E=ba(),S=o(E),D=o(S,!0);i(S),i(E),L((A,z)=>{ue(S,"id",A),ue(S,"href",r(C).path),ue(S,"aria-current",z),Z(D,r(C).text)},[()=>m(r(C)),()=>r(x)(r(C))]),s(u,E)}),i(_),i(k),s(P,k)},$$slots:{lead:!0,trail:!0,default:!0}}),ne(),g()}be(["click"]);var ya=d("<div> </div>"),ka=d('<div data-testid="any-record-of-filter-modal"><header><h1 class="text-lg font-normal"> </h1></header> <!></div>');function wa(a,e){le(e,!0);var l=ka(),g=o(l),p=o(g),c=o(p,!0);i(p),i(g);var b=w(g,2);{var y=m=>{var x=he(),h=ae(x);pe(h,17,()=>e.filter.concepts,we,(v,P)=>{var f=ya(),k=o(f,!0);i(f),L(()=>Z(k,r(P))),s(v,f)}),s(m,x)},F=m=>{var x=Pe("No filter provided");s(m,x)};T(b,m=>{e.filter.filterType==="AnyRecordOf"?m(y):m(F,!1)})}i(l),L(()=>{var m,x,h,v;return Z(c,`${(x=(m=e.filter)==null?void 0:m.concepts)==null?void 0:x.length} variable(s) in ${((h=e.filter.searchResult)==null?void 0:h.display)||((v=e.filter.searchResult)==null?void 0:v.name)||e.filter.variableName} category`)}),s(a,l),ne()}function Fa(a,e,l,g){e.filter.filterType==="genomic"?(Gt(e.filter),ke("/explorer/genome-filter?edit="+Ve.Genomic)):e.filter.filterType==="snp"?(Mt(e.filter),ke("/explorer/genome-filter?edit="+Ve.SNP)):(Ce(Ye,e.filter),Ce(Qe,e.filter.searchResult))}const Ra=function(a,e){return wt(e.filter.uuid)};var Pa=(a,e)=>(a.key==="Enter"||a.key===" ")&&e(a),Ca=d('<div class="flex-auto variable svelte-88jmke" tabindex="0" role="button"> </div>'),Ea=d('<div class="text-left"> </div>'),Sa=d('<button type="button" title="Edit Filter" class="bg-initial text-black-500 hover:text-primary-600"><i class="fa-solid fa-pen-to-square"></i> <span class="sr-only">Edit Filter</span></button>'),Ta=d('<i class="fa-solid fa-pen-to-square"></i> <span class="sr-only">Edit Filter</span>',1),Ia=d('<button type="button" title="See details" class="bg-initial text-black-500 hover:text-primary-600"><i></i> <span class="sr-only">See details</span></button>'),Aa=d("<div> </div>"),Oa=d('<section class="p-1 whitespace-pre-wrap"> <!></section>'),Ba=d('<div class="flex flex-col card bg-surface-100 p-1 m-1"><header class="card-header p-1 flex svelte-88jmke"><!> <div class="actions svelte-88jmke"><!> <button type="button" title="Remove Filter" class="bg-initial text-black-500 hover:text-primary-600"><i class="fa-solid fa-times-circle"></i> <span class="sr-only">Remove Filter</span></button> <!></div></header> <!></div>');function Da(a,e){le(e,!0);const[l,g]=fe(),p=()=>U(Ye,"$activeFilter",l),c=()=>U(Qe,"$activeSearch",l);let b=me(!1),y=me("fa-caret-up");const F=V(()=>["genomic","snp"].includes(e.filter.filterType)),m=V(()=>e.filter.filterType==="AnyRecordOf");let x=me(!1),h=me(!1);const v=function(t){if(t.filterType==="Categorical")if(t.displayType==="restrict"){let n=t.categoryValues.length===1?"value":"values";return`Restricting to ${t.categoryValues.length} ${n}.`}else return t.displayType==="any"||t.displayType==="anyRecordOf"?"Restricting to any value.":t.description;else{if(t.filterType==="AnyRecordOf")return"Restricting to children of the selected value.";if(t.filterType==="numeric")switch(t.displayType){case"any":return"Restricting to any value.";case"between":return`Restricting to between ${t.min} and ${t.max}.`;case"greaterThan":return`Restricting to greater than ${t.min}.`;case"lessThan":return`Restricting to less than ${t.max}.`;default:return t.description||"N/A"}else if(t.filterType==="genomic"||t.filterType==="snp")return t.description}},P=function(t){var n,O,j,M;return(n=t.searchResult)!=null&&n.studyAcronym&&((O=t.searchResult)!=null&&O.dataset)?`${t.searchResult.studyAcronym} (${t.searchResult.dataset})`:((j=t.searchResult)==null?void 0:j.studyAcronym)||((M=t.searchResult)==null?void 0:M.dataset)||""},f=function(t){t.stopPropagation(),t.preventDefault(),se(b,!r(b)),se(y,r(b)?"fa-caret-down":"fa-caret-up",!0)};var k=Ba(),_=o(k),u=o(_);{var C=t=>{var n=Ca();n.__click=f,n.__keydown=[Pa,f];var O=o(n,!0);i(n),L(()=>Z(O,e.filter.variableName)),s(t,n)},E=t=>{const n=V(()=>`any-record-of-filter-modal-${e.filter.id}`);je(t,{title:"View Variables in Filter",get"data-testid"(){return r(n)},withDefault:!1,get open(){return r(h)},set open(j){se(h,j,!0)},trigger:j=>{var M=Ea(),W=o(M);i(M),L(()=>{var q,H,B,N;return Z(W,`${((H=(q=e.filter)==null?void 0:q.concepts)==null?void 0:H.length)??""} variable(s) in ${(((B=e.filter.searchResult)==null?void 0:B.display)||((N=e.filter.searchResult)==null?void 0:N.name)||e.filter.variableName)??""}
            category`)}),s(j,M)},children:(j,M)=>{wa(j,{get filter(){return e.filter}})},$$slots:{trigger:!0,default:!0}})};T(u,t=>{r(m)?t(E,!1):t(C)})}var S=w(u,2),D=o(S);{var A=t=>{var n=Sa();n.__click=[Fa,e,p,c],s(t,n)},z=(t,n)=>{{var O=j=>{je(j,{title:"Edit Filter",triggerBase:"bg-initial text-black-500 hover:text-primary-600",withDefault:!1,get open(){return r(x)},set open(W){se(x,W,!0)},trigger:W=>{var q=Ta();Te(2),s(W,q)},children:(W,q)=>{Wt(W,{get data(){return e.filter.searchResult},get existingFilter(){return e.filter},onclose:()=>se(x,!1)})},$$slots:{trigger:!0,default:!0}})};T(t,j=>{r(m)||j(O)},n)}};T(D,t=>{r(F)?t(A):t(z,!1)})}var Y=w(D,2);Y.__click=[Ra,e];var Q=w(Y,2);{var X=t=>{var n=Ia();n.__click=f;var O=o(n);Te(2),i(n),L(()=>ve(O,1,`fa-solid ${r(y)??""}`,"svelte-88jmke")),s(t,n)};T(Q,t=>{r(m)||t(X)})}i(S),i(_);var G=w(_,2);{var J=t=>{var n=Oa(),O=o(n),j=w(O);{var M=W=>{var q=Aa(),H=o(q);i(q),L(B=>Z(H,`Values: ${B??""}`),[()=>e.filter.categoryValues.join(", ")]),s(W,q)};T(j,W=>{e.filter.filterType==="Categorical"&&e.filter.displayType!=="any"&&e.filter.displayType!=="anyRecordOf"&&W(M)})}i(n),L((W,q)=>Z(O,`${W??""}
      ${q??""} `),[()=>v(e.filter),()=>P(e.filter)]),ye(3,n,()=>Je,()=>({axis:"y"})),s(t,n)};T(G,t=>{r(b)&&t(J)})}i(k),L(()=>{ue(k,"id",e.filter.uuid),ue(k,"data-testid",`added-filter-${e.filter.id??""}`)}),ye(1,k,()=>qe,()=>({easing:Ke})),ye(2,k,()=>He,()=>({duration:300})),s(a,k),ne(),g()}be(["click","keydown"]);const za=function(a,e,l){e(l.variable.id)};var ja=d('<div class="flex flex-col card bg-surface-100 p-1 m-1"><header class="card-header p-1 flex"><div class="flex-auto"> </div> <button type="button" title="Remove Export" class="btn-icon-color" aria-label="Remove Export"><i class="fa-solid fa-times-circle"></i></button></header></div>');function Na(a,e){le(e,!0);const{removeExport:l}=ze;var g=ja(),p=o(g),c=o(p),b=o(c,!0);i(c);var y=w(c,2);y.__click=[za,l,e],i(p),i(g),L(()=>{var F,m;ue(g,"id",e.variable.studyId?`${e.variable.studyId}-${e.variable.conceptPath}`:e.variable.conceptPath),ue(g,"data-testid",`added-export-${e.variable.conceptPath??""}`),Z(b,e.variable.display||((F=e.variable.searchResult)==null?void 0:F.display)||((m=e.variable.searchResult)==null?void 0:m.name))}),ye(3,g,()=>He,()=>({duration:300})),s(a,g),ne()}be(["click"]);var La=d('<span class="text-4xl font-bold"></span>'),$a=d('<span id="result-count-error" class="text-xs ml-1 h-full !flex flex-col"><i class="fa-solid fa-circle-exclamation text-warning-900-100 pt-[5px] hover:text-warning-400-600" title="One or more sites had an error for this count."></i> <span class="sr-only">One or more sites had an error for this count.</span></span>'),Va=d('<div class="flex flex-row h-full"><span id="result-count-number" class="text-4xl"> </span> <!></div>'),Ga=d('<span id="result-count"><!></span>'),Ma=d('<div class="flex flex-col items-center mt-2"><!> <h4 class="text-center"> </h4></div>'),Wa=d('<p class="text-[0.6rem] !m-0">Some sites did not return patient counts for your query. See <a href="/explorer/cohort" class="anchor font-bold">Cohort Details</a> for more information.</p>'),Ua=d("<!> <!>",1);function Ya(a,e){le(e,!0);const[l,g]=fe(),p=()=>U(Lt,"$resultCounts",l);let c=me(!1);function b(v){return Ut(v.filter(_e.fullfiled).map(({value:P})=>P))}function y(v){return v.filter(_e.fullfiled).length===0||v.some(_e.rejected)}Ue(()=>{se(c,!1),p().forEach(v=>{Promise.allSettled(_e.list(v)).then(P=>{y(P)&&se(c,!0)})})});var F=Ua(),m=ae(F);pe(m,1,p,we,(v,P)=>{var f=Ma(),k=o(f);tt(k,()=>Promise.allSettled(_e.list(r(P))),C=>{Ze(C,{ring:!0,size:"mini"})},(C,E)=>{var S=Ga();const D=V(()=>b(r(E))),A=V(()=>y(r(E)));var z=o(S);{var Y=X=>{var G=La();G.textContent="N/A",s(X,G)},Q=X=>{var G=Va(),J=o(G),t=o(J,!0);i(J);var n=w(J,2);{var O=j=>{var M=$a();s(j,M)};T(n,j=>{r(A)&&j(O)})}i(G),L(()=>Z(t,r(D))),s(X,G)};T(z,X=>{r(E).filter(_e.fullfiled).length===0?X(Y):X(Q,!1)})}i(S),s(C,S)});var _=w(k,2),u=o(_,!0);i(_),i(f),L(()=>Z(u,r(P).label)),s(v,f)});var x=w(m,2);{var h=v=>{Le(v,{color:"warning",iconSize:"2xl",children:(P,f)=>{var k=Wa();s(P,k)},$$slots:{default:!0}})};T(x,v=>{r(c)&&v(h)})}s(a,F),ne(),g()}var Qa=()=>ke("/explorer/export"),Xa=d('<div class="h-11 mt-4"><button id="export-data-button" type="button" class="btn preset-filled-primary-500">Prepare for Analysis</button></div>'),Za=(a,e)=>se(e,!0),qa=d('<button data-testid="clear-all-results-btn" class="anchor text-sm flex-none">Reset</button>'),Ha=d('<p class="text-center">No filters added</p>'),Ja=d('<header class="text-left ml-1">Filters</header>'),Ka=d('<div class="px-4 mb-1 w-80"><!> <section class="py-1"></section></div>'),er=d('<div class="px-4 mb-1 w-80"><header class="text-left ml-1" data-testid="export-header">Added Variables</header> <section class="py-1"></section></div>'),tr=d('<div class="flex flex-col items-center mt-7"><hr class="svelte-6n5r83"/> <h5 class="text-center text-xl mt-7">Tool Suite</h5> <div class="flex flex-row flex-wrap justify-items-center gap-4 w-80 justify-center"><!> <!> <!> <!></div></div>'),ar=d('<!> <section id="results-panel" class="flex flex-col items-center pt-8 pr-10 w-64"><!> <!> <div id="export-filters" class="flex flex-col items-center mt-7 w-80"><hr class="svelte-6n5r83"/> <div class="flex content-center mt-7"><h5 class="text-xl flex-auto mr-2 mb-2">Filtered Data Summary</h5> <!></div> <!> <!></div> <!></section>',1);function rr(a,e){le(e,!0);const[l,g]=fe(),p=()=>U(Ie,"$filters",l),c=()=>U(Nt,"$exports",l),b=()=>U(Vt,"$hasNonZeroResult",l),y=()=>U(Xe,"$hasGenomicFilter",l);let F=null,m=K.url.pathname,x=V(()=>K.url.pathname.includes("/discover")),h=V(()=>K.url.pathname.includes("/explorer")),v=me(!1),P=V(()=>p().length!==0||ge.explorer.exportsEnableExport&&c().length!==0),f=V(()=>ge.explorer.allowExport&&!r(x)&&r(P)&&b()),k=V(()=>p().length!==0&&!p().every(I=>I.filterType==="genomic"||I.filterType==="snp"||I.filterType==="AnyRecordOf")),_=V(()=>r(h)&&ge.explorer.distributionExplorer&&r(k)),u=V(()=>r(x)&&ge.discoverFeautures.distributionExplorer&&r(k)),C=V(()=>r(h)&&ge.explorer.variantExplorer&&y()),E=V(()=>r(h)&&ge.explorer.enableCohortDetails),S=V(()=>r(E)||(p().length!==0||c().length!==0)&&(r(_)||r(u)||r(C)));function D(){F||(F=Ie.subscribe(()=>$t(r(x))))}function A(){F&&(F(),F=null)}Ue(()=>{K.url.pathname.startsWith(m)||(m=K.url.pathname,A(),D())}),Ae(D),We(A);var z=ar(),Y=ae(z);je(Y,{title:"Clear All Filters",withDefault:!0,confirmText:"Yes",cancelText:"No",onconfirm:()=>{Ft(),jt()},get open(){return r(v)},set open(I){se(v,I,!0)},children:(I,$)=>{Te();var ee=Pe("Are you sure you want to clear all filters?");s(I,ee)},$$slots:{default:!0}});var Q=w(Y,2),X=o(Q);Ya(X,{});var G=w(X,2);{var J=I=>{var $=Xa(),ee=o($);ee.__click=[Qa],i($),ye(3,ee,()=>qe,()=>({easing:Ke})),s(I,$)};T(G,I=>{r(f)&&I(J)})}var t=w(G,2),n=w(o(t),2),O=w(o(n),2);{var j=I=>{var $=qa();$.__click=[Za,v],s(I,$)};T(O,I=>{r(P)&&I(j)})}i(n);var M=w(n,2);{var W=I=>{var $=Ha();s(I,$)},q=I=>{var $=Ka(),ee=o($);{var ie=ce=>{var Fe=Ja();s(ce,Fe)};T(ee,ce=>{p().length!==0&&ce(ie)})}var de=w(ee,2);pe(de,5,p,we,(ce,Fe)=>{Da(ce,{get filter(){return r(Fe)}})}),i(de),i($),s(I,$)};T(M,I=>{p().length===0&&c().length===0?I(W):I(q,!1)})}var H=w(M,2);{var B=I=>{var $=er(),ee=w(o($),2);pe(ee,5,c,ie=>ie.id,(ie,de)=>{Na(ie,{get variable(){return r(de)}})}),i(ee),i($),s(I,$)};T(H,I=>{c().length!==0&&I(B)})}i(t);var N=w(t,2);{var re=I=>{var $=tr(),ee=w(o($),4),ie=o(ee);{var de=te=>{const Oe=V(()=>K.url.pathname.includes("explorer/cohort"));Ee(te,{href:"/explorer/cohort","data-testid":"cohort-details-btn",title:"Cohort Details",icon:"fa-solid fa-users",size:"md",get active(){return r(Oe)}})};T(ie,te=>{r(E)&&te(de)})}var ce=w(ie,2);{var Fe=te=>{Ee(te,{href:"/explorer/distributions","data-testid":"distributions-btn",title:"Variable Distributions",icon:"fa-solid fa-chart-pie",size:"md"})};T(ce,te=>{r(_)&&te(Fe)})}var $e=w(ce,2);{var it=te=>{Ee(te,{href:"/discover/distributions","data-testid":"distributions-btn",title:"Variable Distributions",icon:"fa-solid fa-chart-pie",size:"md"})};T($e,te=>{r(u)&&te(it)})}var st=w($e,2);{var ot=te=>{const Oe=V(()=>K.url.pathname.includes("explorer/variant"));Ee(te,{href:"/explorer/variant","data-testid":"variant-explorer-btn",title:"Variant Explorer",icon:"fa-solid fa-dna",size:"md",get active(){return r(Oe)}})};T(st,te=>{r(C)&&te(ot)})}i(ee),i($),s(I,$)};T(N,I=>{r(S)&&I(re)})}i(Q),ye(3,Q,()=>Je,()=>({axis:"x"})),s(a,z),ne(),g()}be(["click"]);var ir=d('<div id="side-panel"><div id="side-panel-bar" class="svelte-uj3z3w"><button type="button" id="results-panel-toggle" class="btn-icon btn-icon-sm preset-tonal-primary border border-primary-500 hover:preset-filled-primary-500 svelte-uj3z3w" aria-label="Toggle Results Panel"><i></i></button></div> <!></div>');function sr(a,e){le(e,!0);const[l,g]=fe(),p=()=>U(Ie,"$filters",l),c=()=>U(y,"$exports",l),b=()=>U(Se,"$panelOpen",l);let{exports:y}=ze,F,m;function x(){Se.set(!0)}Ae(()=>{F=Ie.subscribe(()=>{var u;((u=p())==null?void 0:u.length)!==0&&x()}),m=ze.subscribe(()=>{var u;((u=c())==null?void 0:u.length)!==0&&x()})}),We(()=>{F&&F(),m&&m()});var h=ir(),v=o(h),P=o(v);P.__click=()=>{Se.update(u=>!u)};var f=o(P);i(P),i(v);var k=w(v,2);{var _=u=>{rr(u,{})};T(k,u=>{b()&&u(_)})}i(h),L(()=>{ve(h,1,`flex ${b()?"open":"closed"}-panel`),ue(P,"title",`${b()?"Hide":"Show"} Results`),ve(f,1,`fa-solid ${b()?"fa-arrow-right":"fa-arrow-left"}`)}),s(a,h),ne(),g()}be(["click"]);function or(a,e){const[l,g]=fe(),p=()=>U(Ge,"$drawerState",l);let c=R(e,"position",3,"right"),b=R(e,"width",3,"w-[480px]");const y=c()==="left"?"justify-start":"justify-end";et(a,{get open(){return p()},onOpenChange:m=>Ce(Ge,m.open),triggerBase:"btn preset-tonal",get contentBase(){return`bg-surface-50-950 p-4 space-y-4 shadow-xl ${b()??""} h-screen overflow-auto`},positionerJustify:y,positionerAlign:"",positionerPadding:"",transitionsPositionerIn:{x:-480,duration:200},transitionsPositionerOut:{x:-480,duration:200},ids:{content:"drawer"},get trigger(){return e.trigger},content:m=>{var x=he(),h=ae(x);oe(h,()=>e.children??xe),s(m,x)},$$slots:{content:!0}}),g()}var lr=d('<h2 data-testid="drawer-title" class="text-2xl font-bold ml-4"></h2>'),nr=d('<li class="ml-8"> </li>'),dr=d('<ul class="list-disc"></ul>'),cr=d('<li class="m-2"><strong class="capitalize"> </strong>: <!></li>'),vr=a=>a.stopPropagation(),ur=d('<div class="flex justify-center items-center mb-4"><a class="btn preset-tonal-primary border border-primary-500 hover:preset-filled-primary-500" target="_blank">More Info</a></div>'),fr=d('<ul data-testid="drawer-details" class="m-4 p-4"></ul> <!>',1),mr=d("<!> <hr/> <!>",1);function gr(a,e){var P,f,k;le(e,!0);const[l,g]=fe(),p=()=>U(Yt,"$activeRow",l),c=((P=p())==null?void 0:P.dataset_id)||"",b=((f=p())==null?void 0:f.name)||"",y=((k=p())==null?void 0:k.additional_info_link)||"";async function F(){const _=await Qt(c);if(!_||Object.keys(_).length===0)throw new Error("No details found");return _.datasetId&&delete _.datasetId,_.studyFullname&&delete _.studyFullname,_}var m=mr(),x=ae(m);{var h=_=>{var u=lr();u.textContent=b,s(_,u)};T(x,_=>{b&&_(h)})}var v=w(x,4);tt(v,F,_=>{Ze(_,{ring:!0,size:"medium"})},(_,u)=>{var C=fr(),E=ae(C);pe(E,21,()=>Object.entries(r(u)),we,(A,z)=>{let Y=()=>r(z)[0],Q=()=>r(z)[1];var X=he(),G=ae(X);{var J=t=>{var n=cr(),O=o(n),j=o(O,!0);i(O);var M=w(O,2);{var W=H=>{var B=dr();pe(B,21,Q,we,(N,re)=>{var I=he(),$=ae(I);{var ee=ie=>{var de=nr(),ce=o(de,!0);i(de),L(()=>Z(ce,r(re))),s(ie,de)};T($,ie=>{r(re)&&ie(ee)})}s(N,I)}),i(B),s(H,B)},q=H=>{var B=Pe();L(()=>Z(B,Q())),s(H,B)};T(M,H=>{Array.isArray(Q())?H(W):H(q,!1)})}i(n),L(H=>Z(j,H),[()=>Y().replace(/([A-Z])/g," $1").toLowerCase().trim()]),s(t,n)};T(G,t=>{Q()&&t(J)})}s(A,X)}),i(E);var S=w(E,2);{var D=A=>{var z=ur(),Y=o(z);ue(Y,"href",y||"#"),Y.__click=[vr],i(z),s(A,z)};T(S,A=>{y&&A(D)})}s(_,C)},_=>{Le(_,{title:"An Error Occured",children:(u,C)=>{Te();var E=Pe("We're having trouble fetching the dataset details right now. Please try again later.");s(u,E)},$$slots:{default:!0}})}),s(a,m),ne(),g()}be(["click"]);var hr=d('<p> </p> <p> </p> <div><button class="btn preset-outlined-warning-500 hover:preset-filled-warning-500">Remove Invalid Filters</button> <button class="btn preset-outlined-warning-500 hover:preset-filled-warning-500"> </button></div>',1);function pr(a,e){le(e,!0);const[l,g]=fe(),p=()=>U(Re,"$filterWarning",l);let c=R(e,"open",15,!1);const b={stigmatizing:{message:"Your selected filters contain stigmatizing variables and/or genomic filters, which are not supported with Discover",backTo:"Explore",path:"/discover",back:"/explorer",resetQuery:()=>{Pt(),Ct()}},notAuthorized:{message:"You are not authorized to access the data in Explore based on your selected filters.",backTo:"Discover",path:"/explorer",back:"/discover",resetQuery:()=>Rt()},undefined:{message:"",backTo:"",path:"/",back:"/",resetQuery:()=>{}}},y=V(()=>b[p()||"undefined"]);function F(){const x=r(y).back;Re.set(void 0),c(!1),ke(x,{keepFocus:!1})}function m(){const x=r(y).path;r(y).resetQuery(),Se.set(!1),Re.set(void 0),c(!1),ke(x,{keepFocus:!1})}et(a,{get open(){return c()},onOpenChange:h=>c(h.open),contentBase:"overflow-auto max-w-screen w-1/2 max-h-screen",backdropClasses:"backdrop-blur-sm",ids:{content:"modal-component"},content:h=>{Le(h,{"data-testid":"sendfilter-warning",color:"warning",children:(v,P)=>{var f=hr(),k=ae(f),_=o(k,!0);i(k);var u=w(k,2),C=o(u);i(u);var E=w(u,2),S=o(E);S.__click=m;var D=w(S,2);D.__click=F;var A=o(D);i(D),i(E),L(()=>{Z(_,r(y).message),Z(C,`Would you like to remove the invalid filters or go back to ${r(y).backTo??""}?`),Z(A,`Back to ${r(y).backTo??""}`)}),s(v,f)},$$slots:{default:!0}})},$$slots:{content:!0}}),ne(),g()}be(["click"]);var br=d('<div id="sidebar-right" class="flex overflow-auto"><!></div>'),_r=d("<!> <!> <!> <!>",1);function ii(a,e){le(e,!0);const[l,g]=fe(),p=()=>U(Et,"$hasInvalidFilter",l),c=()=>U(Xe,"$hasGenomicFilter",l),b=()=>U(St,"$hasUnallowedFilter",l);let y=me(!1);Ae(()=>{document.body.classList.add("started")});let F=V(()=>(K.url.pathname.includes("/explorer")||K.url.pathname.includes("/discover"))&&!K.url.pathname.includes("/export")&&!K.url.pathname.includes("/distributions"));xt(({to:f,cancel:k})=>{const _=(f==null?void 0:f.url.pathname.includes("/explorer"))&&p(),u=(f==null?void 0:f.url.pathname.includes("/discover"))&&(c()||b());(u||_)&&(u?Ce(Re,"stigmatizing"):_&&Ce(Re,"notAuthorized"),k(),se(y,!0))});var m=_r(),x=ae(m);yt(x,{toaster:ht});var h=w(x,2);pr(h,{get open(){return r(y)},set open(f){se(y,f,!0)}});var v=w(h,2);or(v,{position:"right",width:"w-1/2",children:(f,k)=>{gr(f,{})},$$slots:{default:!0}});var P=w(v,2);va(P,{header:u=>{xa(u,{})},sidebarRight:u=>{var C=he(),E=ae(C);{var S=D=>{var A=br(),z=o(A);sr(z,{}),i(A),s(D,A)};T(E,D=>{r(F)&&D(S)})}s(u,C)},pageFooter:u=>{kt(u,{})},children:(u,C)=>{var E=he(),S=ae(E);oe(S,()=>e.children??xe),s(u,E)}}),s(a,m),ne(),g()}export{ii as component,ri as universal};
