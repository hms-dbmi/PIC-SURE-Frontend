import{f as M,a as N}from"../chunks/CtfeAAbw.js";import{p as U,u as j,a as k,t as _,s as m,c as o,e as r,b as y,g as e,$ as z,r as l}from"../chunks/B4GrenNm.js";import{h as D,s as F}from"../chunks/DxSOTiY2.js";import{r as x}from"../chunks/BPiAbArq.js";import{e as O}from"../chunks/D7VV4X-8.js";import{b as w}from"../chunks/CJCVGGPV.js";import{s as P,a as T}from"../chunks/DvPjbdiY.js";import{b as Z}from"../chunks/CHRSknKA.js";import{C as B}from"../chunks/DpviI_uJ.js";import{b as G,t as v}from"../chunks/yAhaO9Md.js";import{b as H}from"../chunks/D62jt1bd.js";var J=M('<form class="flex flex-col items-center m-8"><fieldset data-testid="manual-role-form" class="grid gap-4 my-3"><label class="label required"><span>Study with Consent Code (e.g. phs001514):</span> <input type="text" class="input" required minlength="1" maxlength="255" pattern="[a-zA-Z0-9._-]+" title="Only letters, numbers, dots, underscores and hyphens are allowed"/></label> <label class="label"><span>Consent Code (optional, c followed by numbers):</span> <input type="text" class="input" minlength="1" maxlength="255" pattern="(\\c\\d+)?" title="Consent code must be empty or a c followed by numbers (e.g. c1, c23)"/></label> <div class="flex flex-row justify-center"><button class="btn preset-filled-primary-500 max-w-fit" type="submit"> </button></div></fieldset></form>');function re(R,C){U(C,!0);const[A,S]=P(),E=()=>T(G,"$isAdmin",A);let n=y(""),i=y(""),t=y(!1);j(()=>{e(t)||(r(n,""),r(i,""))});async function I(d){if(d.preventDefault(),e(t))return;r(t,!0);let p=e(i)?e(n)+"."+e(i):e(n);const s=encodeURI(p);if(s!==p){v.error({title:"Error: study-identifier contains invalid characters"}),r(t,!1);return}try{(await H(s)).status===200&&v.success({title:"Role added successfully"})}catch(a){v.error({title:"Error: Failed to add role",description:a instanceof Error?a.message:"Unknown error"})}finally{r(t,!1)}}D(d=>{_(()=>z.title=`${Z.applicationName??""} | New Role`)}),B(R,{title:"Manual Role",children:(d,p)=>{var s=J(),a=o(s),u=o(a),g=m(o(u),2);x(g),l(u);var c=m(u,2),h=m(o(c),2);x(h),l(c);var $=m(c,2),f=o($),q=o(f,!0);l(f),l($),l(a),l(s),_(()=>{a.disabled=!E()||e(t),f.disabled=e(t),F(q,e(t)?"Adding Role...":"Add Role")}),O("submit",s,I),w(g,()=>e(n),b=>r(n,b)),w(h,()=>e(i),b=>r(i,b)),N(d,s)},$$slots:{default:!0}}),k(),S()}export{re as component};
