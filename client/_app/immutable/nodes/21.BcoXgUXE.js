import"../chunks/Bzak7iHL.js";import{p as q,o as M,k as e,h as y,l as r,c as N,t as _,f as U,s as m,d as o,b as j,$ as z,r as l}from"../chunks/DhSNEPDw.js";import{h as D,e as F,s as O}from"../chunks/DVtHS8ol.js";import{r as x}from"../chunks/CJ66PCUx.js";import{b as w}from"../chunks/DPXw0ygh.js";import{s as P,a as T}from"../chunks/DpjY2ypC.js";import{b as Z}from"../chunks/BZHGrlEE.js";import{C as B}from"../chunks/DCcVgSs7.js";import{b as G,t as h}from"../chunks/BNC-bmXQ.js";import{b as H}from"../chunks/DQg6N8Wr.js";var J=U('<form class="flex flex-col items-center m-8"><fieldset data-testid="manual-role-form" class="grid gap-4 my-3"><label class="label required"><span>Study with Consent Code (e.g. phs001514):</span> <input type="text" class="input" required minlength="1" maxlength="255" pattern="[a-zA-Z0-9._-]+" title="Only letters, numbers, dots, underscores and hyphens are allowed"/></label> <label class="label"><span>Consent Code (optional, c followed by numbers):</span> <input type="text" class="input" minlength="1" maxlength="255" pattern="(\\c\\d+)?" title="Consent code must be empty or a c followed by numbers (e.g. c1, c23)"/></label> <div class="flex flex-row justify-center"><button class="btn preset-filled-primary-500 max-w-fit" type="submit"> </button></div></fieldset></form>');function ae(R,C){q(C,!0);const A=()=>T(G,"$isAdmin",S),[S,E]=P();let n=y(""),i=y(""),t=y(!1);M(()=>{e(t)||(r(n,""),r(i,""))});async function I(d){if(d.preventDefault(),e(t))return;r(t,!0);let c=e(i)?e(n)+"."+e(i):e(n);const s=encodeURI(c);if(s!==c){h.error({title:"Error: study-identifier contains invalid characters"}),r(t,!1);return}try{(await H(s)).status===200&&h.success({title:"Role added successfully"})}catch(a){h.error({title:"Error: Failed to add role",description:a instanceof Error?a.message:"Unknown error"})}finally{r(t,!1)}}D(d=>{_(()=>z.title=`${Z.applicationName??""} | New Role`)}),B(R,{title:"Manual Role",children:(d,c)=>{var s=J(),a=o(s),p=o(a),v=m(o(p),2);x(v),l(p);var u=m(p,2),g=m(o(u),2);x(g),l(u);var $=m(u,2),f=o($),k=o(f,!0);l(f),l($),l(a),l(s),_(()=>{a.disabled=!A()||e(t),f.disabled=e(t),O(k,e(t)?"Adding Role...":"Add Role")}),F("submit",s,I),w(v,()=>e(n),b=>r(n,b)),w(g,()=>e(i),b=>r(i,b)),j(d,s)},$$slots:{default:!0}}),N(),E()}export{ae as component};
