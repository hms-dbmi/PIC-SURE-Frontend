import{c as ne,a as s,f as v}from"../chunks/CtfeAAbw.js";import{o as le}from"../chunks/DlIBaGjY.js";import{p as ce,e as ee,b as te,f as G,a as de,c as d,g as e,s as g,r as l,t as J,n as oe,h as R}from"../chunks/B4GrenNm.js";import{s as ve}from"../chunks/DxSOTiY2.js";import{a as ie}from"../chunks/bf3FOAR_.js";import{i as T}from"../chunks/CSsnQ7i2.js";import{e as X,i as Y}from"../chunks/BdG0KSB2.js";import{s as F,b as he,c as be}from"../chunks/BPiAbArq.js";import{t as we,f as ye}from"../chunks/C4-uZRU6.js";import{b as Te}from"../chunks/BCz5OXXD.js";import{p as D}from"../chunks/McouLZAx.js";import{b as A,f as Le}from"../chunks/CHRSknKA.js";import{t as ke}from"../chunks/BRrMSDP5.js";import{h as Pe}from"../chunks/BeImZ7I_.js";import{d as Ie}from"../chunks/D7VV4X-8.js";import{p as Z}from"../chunks/DvPjbdiY.js";import{p as Ne}from"../chunks/CEVJ7K31.js";import{c as Se}from"../chunks/Beo73Wd8.js";import{r as Ce}from"../chunks/bY-Ac27V.js";import{L as je}from"../chunks/IdnDkL5k.js";import{E as ze}from"../chunks/BVg5wqNm.js";import{L as se}from"../chunks/DYQPks66.js";var Ae=(P,a,h,I)=>{P.stopImmediatePropagation(),a(h(),I.provider.type)},Ee=v('<img class="mr-2 h-8"/>'),qe=v('<div class="help-text svelte-1gvr6jh"><!></div>'),Be=v('<button type="button"><!> <span> </span></button> <!>',1),He=v('<button type="button" disabled class="btn preset-filled-primary-500 m-1 w-full" title="No provider selected" aria-label="No provider selected. Please select a provider from the dropdown menu above."><span>Login</span></button>');function $(P,a){var q,B,C;ce(a,!0);const h=Z(a,"buttonText",3,"Log In"),I=Z(a,"redirectTo",3,"/"),K=Z(a,"class",3,""),O=`login-button-${(B=(q=a.provider)==null?void 0:q.name)==null?void 0:B.toLowerCase()}`;let b=te(void 0),x=te(""),E=async(m,_)=>{(await Se(a.provider)).login(m,_).then(()=>{Ce()})};(C=a.provider)!=null&&C.imagesrc&&ee(b,"./"+a.provider.imagesrc),le(()=>ee(x,Ne.sanitize(a.helpText),!0));var w=ne(),N=G(w);{var S=m=>{var _=Be(),o=G(_);F(o,"data-testid",O),o.__click=[Ae,E,I,a];var u=d(o);{var y=p=>{var n=Ee();J(()=>{F(n,"src",e(b)),F(n,"alt",a.provider.imageAlt)}),s(p,n)};T(u,p=>{e(b)&&p(y)})}var L=g(u,2),U=d(L,!0);l(L),l(o);var V=g(o,2);{var H=p=>{var n=qe(),W=d(n);Pe(W,()=>e(x)),l(n),s(p,n)};T(V,p=>{var n;a.helpText&&!((n=a.provider)!=null&&n.alt)&&p(H)})}J(()=>{he(o,1,be(K()??"btn preset-filled-primary-500 m-1"),"svelte-1gvr6jh"),ve(U,h())}),s(m,_)},Q=m=>{var _=He();s(m,_)};T(N,m=>{a.provider?m(S):m(Q,!1)})}s(P,w),de()}Ie(["click"]);var Me=v("<div></div>"),Re=v(`No main authentication providers are registered. Please add them to your
              configuration. Click <a class="anchor" href="https://pic-sure.gitbook.io/pic-sure-developer-guide/configuring-pic-sure" target="_blank">Here</a> to learn how.`,1),De=v('<option class="capitalize svelte-8v8woc"> </option>'),Fe=v('<select id="login-select" required class="svelte-8v8woc"><option disabled selected class="svelte-8v8woc">Select a provider</option><!></select> <!>',1),Ge=v('<a class="btn preset-outlined-primary-500 text-primary-500 hover:preset-filled-primary-500 hover:text-white mb-4 w-full"></a>'),Je=v('<div id="alt-logins" class="grid grid-cols-1 gap-4 mb-4 w-full"></div>'),Ke=v('<div id="login-box" class="w-max mt-2"><header class="flex flex-col items-center"><!></header> <div class="flex flex-col items-center justify-center"><div id="main-logins" class="grid grid-cols-1 gap-4 mb-4 w-full"><!> <!></div> <!> <!></div></div>'),Oe=v('<section id="logins" class="flex flex-col items-center h-screen w-full text-center place-content-center text-lg"><div id="title-box" class="flex flex-col items-center text-center mb-8 max-w-3/4"><h1 data-testid="login-title" class="mb-6 w-full flex gap-2 items-center justify-center"><!></h1> <p data-testid="login-description" class="text-2xl"></p></div> <!></section>');function ft(P,a){var C,m,_;ce(a,!0);const h=D.url.searchParams.get("redirectTo")||"/",I=(C=A)==null?void 0:C.applicationName,K=(m=A)==null?void 0:m.login.description,O=(_=A)==null?void 0:_.login.openPicsureLinkText;let b;le(()=>{b=sessionStorage.getItem("logout-reason"),b&&(ke.error({title:b}),sessionStorage.removeItem("logout-reason"))});let x=te(""),E=R(()=>{var o,u;return e(x)&&e(x)!==""?(u=(o=D.data)==null?void 0:o.providers)==null?void 0:u.find(y=>y.name===e(x)):void 0});var w=Oe(),N=d(w),S=d(N),Q=d(S);je(Q,{class:"flex-none",height:7.5}),l(S);var q=g(S,2);q.textContent=K,l(N);var B=g(N,2);ie(B,()=>{var o;return(o=D.data)==null?void 0:o.providers},o=>{se(o,{ring:!0,size:"medium"})},(o,u)=>{var y=Ke(),L=d(y),U=d(L);{var V=t=>{var r=Me();r.textContent=I,s(t,r)};T(U,t=>{var r,i;(i=(r=A)==null?void 0:r.login)!=null&&i.showSiteName&&t(V)})}l(L);var H=g(L,2),p=d(H),n=d(p);{var W=t=>{ze(t,{children:(r,i)=>{oe();var c=Re();oe(2),s(r,c)},$$slots:{default:!0}})};T(n,t=>{var r;((r=e(u))==null?void 0:r.length)===0&&t(W)})}var me=g(n,2);{var pe=t=>{var r=Fe(),i=G(r),c=d(i);c.value=c.__value="";var f=g(c);X(f,17,()=>e(u),Y,(k,M)=>{var z=De(),ae={},xe=d(z,!0);l(z),J(()=>{ae!==(ae=e(M).name)&&(z.value=(z.__value=e(M).name)??""),ve(xe,e(M).description||e(M).name)}),s(k,z)}),l(i);var j=g(i,2);const _e=R(()=>{var k;return(k=e(E))==null?void 0:k.helptext});$(j,{buttonText:"Log In",get provider(){return e(E)},redirectTo:h,get helpText(){return e(_e)},class:"btn preset-filled-primary-500 w-full"}),Te(i,()=>e(x),k=>ee(x,k)),s(t,r)},fe=t=>{var r=ne(),i=G(r);X(i,17,()=>e(u),Y,(c,f)=>{const j=R(()=>e(f).description||e(f).name);$(c,{get buttonText(){return e(j)},get provider(){return e(f)},redirectTo:h,get helpText(){return e(f).helptext},class:"btn preset-filled-primary-500 w-full"})}),s(t,r)};T(me,t=>{e(u).length>3?t(pe):t(fe,!1)})}l(p);var re=g(p,2);{var ue=t=>{var r=Ge();r.textContent=O,J(()=>{var i,c;return F(r,"href",((c=(i=A)==null?void 0:i.login)==null?void 0:c.openPicsureLink)||"/")}),s(t,r)};T(re,t=>{Le.login.open&&t(ue)})}var ge=g(re,2);ie(ge,()=>{var t;return(t=D.data)==null?void 0:t.altProviders},t=>{se(t,{ring:!0})},(t,r)=>{var i=Je();X(i,21,()=>e(r),Y,(c,f)=>{const j=R(()=>e(f).description||e(f).name);$(c,{get buttonText(){return e(j)},get provider(){return e(f)},redirectTo:h,get helpText(){return e(f).helptext},class:"btn-sm preset-outlined-primary-500 text-primary-500 hover:preset-filled-primary-500 hover:text-white"})}),l(i),s(t,i)}),l(H),l(y),s(o,y)}),l(w),we(1,w,()=>ye,()=>({duration:600,x:"100%"})),s(P,w),de()}export{ft as component};
