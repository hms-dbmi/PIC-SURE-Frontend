import{s as G,e as k,a1 as ye,a as S,c as y,b as C,a2 as $e,f as v,g as T,m as _,i as O,h as p,t as L,d as V,j as ge,n as P,a8 as we,l as _e,k as A,o as Ee,$ as Ce,p as Ie,a0 as Se,x as Te}from"../chunks/CseAM1pm.js";import{S as W,i as Y,g as Q,b as B,t as I,a as x,d as N,e as R,m as U,f as M,j as xe}from"../chunks/CUD_i9MT.js";import{e as F,u as je,o as Oe}from"../chunks/Ba1MNdbe.js";import{b as D}from"../chunks/CukpoKTN.js";import{d as pe,w as J,g as se}from"../chunks/zOfZnRfh.js";import{S as Pe}from"../chunks/D-aXlKIS.js";import{f as K,p as X}from"../chunks/Cbw8H9n5.js";import{a as Z}from"../chunks/C0mPNYJF.js";import{a as De,b as qe}from"../chunks/WtKcDEMi.js";import{h as re,u as Le}from"../chunks/CndaLTDj.js";import"../chunks/C8tRaeKn.js";import{P as Ve}from"../chunks/CEpVNBhg.js";const ee="picsure/query/sync",z=J(!1),le=J(!1),te=J([]),ve=pe(te,r=>r.filter(e=>!e.auth)),be=pe(te,r=>r.filter(e=>e.auth));function ae(r){return r!=null&&r.errorType?Promise.reject("api error"):r}function ne(r,e){var s,o,m;const t=((m=(o=(s=D)==null?void 0:s.landing)==null?void 0:o.statFields[r])==null?void 0:m.map(c=>c.conceptPath))||[];if(t.length===0)return Promise.reject(`${r} feilds were not configured`);const a=Z(K(),e);return a.query.setCrossCountFields(t),X(ee,a).then(ae).then(c=>Object.values(c).reduce((u,i)=>u+i,0))}function Ne(){var a,l;const r=((l=(a=D)==null?void 0:a.landing)==null?void 0:l.statFields.consent)||[];if(r.length===0)return Promise.reject("consent feilds were not configured");const e=r.reduce((s,o)=>({...s,[o.conceptPath]:[...s[o.conceptPath]||[],o.id]}),{}),t=Z(K(),"COUNT");return Object.entries(e).forEach(([s,o])=>t.query.addCategoryFilter(s,o)),X(ee,t).then(ae)}const oe={"dict:facets:dataset_id":r=>De(r,"dataset_id"),"dict:concepts":r=>qe(r),"query:blank":r=>X(ee,Z(r)).then(ae),"query:biosample":()=>ne("biosample","OBSERVATION_CROSS_COUNT"),"query:genomic":()=>ne("genomic","CROSS_COUNT"),"query:consent":()=>Ne(),hardcoded:(r,e)=>Promise.resolve((e==null?void 0:e.value)||0)};async function Re(){var t,a;const r=((a=(t=D)==null?void 0:t.landing)==null?void 0:a.stats)||[];if(r.length===0)return;le.set(!1),z.set(!1);const e=r.filter(l=>!!oe[l.key]).reduce((l,s)=>{const o=[...l],m=(s==null?void 0:s.auth)===void 0?!0:s.auth;return(s==null?void 0:s.auth)===void 0||s.auth,m&&K()&&o.push({...s,auth:!0,value:oe[s.key](!1,s)}),o},[]);te.set(e),Promise.allSettled(e.map(l=>l.value)).then(l=>{l.some(s=>s.status==="rejected")&&z.set(!0),le.set(!0)})}function ie(r,e,t){const a=r.slice();return a[5]=e[t],a}function Ue(r){let e;return{c(){e=k("i"),this.h()},l(t){e=y(t,"I",{class:!0}),C(e).forEach(v),this.h()},h(){_(e,"class","fa-solid fa-circle-exclamation p-1 mb-4 mt-1")},m(t,a){O(t,e,a)},p:P,i:P,o:P,d(t){t&&v(e)}}}function Me(r){let e,t=(r[8]&&r[8].toLocaleString())+"",a;return{c(){e=k("strong"),a=L(t),this.h()},l(l){e=y(l,"STRONG",{class:!0});var s=C(e);a=V(s,t),s.forEach(v),this.h()},h(){_(e,"class","p-1 mb-3")},m(l,s){O(l,e,s),p(e,a)},p(l,s){s&8&&t!==(t=(l[8]&&l[8].toLocaleString())+"")&&ge(a,t)},i:P,o:P,d(l){l&&v(e)}}}function Fe(r){let e,t;return e=new Ve({props:{width:"w-10",meter:"stroke-surface-50 dark:stroke-surface-900",track:"stroke-secondary-500/30",value:void 0}}),{c(){N(e.$$.fragment)},l(a){R(e.$$.fragment,a)},m(a,l){U(e,a,l),t=!0},p:P,i(a){t||(I(e.$$.fragment,a),t=!0)},o(a){x(e.$$.fragment,a),t=!1},d(a){M(e,a)}}}function ce(r,e){let t,a,l,s,o,m,c=e[5].label+"",u,i,g,h={ctx:e,current:null,token:null,hasCatch:!0,pending:Fe,then:Me,catch:Ue,value:8,blocks:[,,,]};return re(l=e[5].value,h),{key:r,first:null,c(){t=k("div"),a=k("div"),h.block.c(),o=S(),m=k("p"),u=L(c),i=S(),this.h()},l(f){t=y(f,"DIV",{class:!0});var n=C(t);a=y(n,"DIV",{"data-testid":!0,class:!0});var b=C(a);h.block.l(b),b.forEach(v),o=T(n),m=y(n,"P",{});var w=C(m);u=V(w,c),w.forEach(v),i=T(n),n.forEach(v),this.h()},h(){_(a,"data-testid",s="value-"+e[2]+"-"+e[5].key+"-"+e[5].label),_(a,"class","flex flex-col justify-center items-center text-2xl"),_(t,"class","p-4 [&:not(:last-child)]:border-r border-surface-400-500-token"),this.first=t},m(f,n){O(f,t,n),p(t,a),h.block.m(a,h.anchor=null),h.mount=()=>a,h.anchor=null,p(t,o),p(t,m),p(m,u),p(t,i),g=!0},p(f,n){e=f,h.ctx=e,n&8&&l!==(l=e[5].value)&&re(l,h)||Le(h,e,n),(!g||n&12&&s!==(s="value-"+e[2]+"-"+e[5].key+"-"+e[5].label))&&_(a,"data-testid",s),(!g||n&8)&&c!==(c=e[5].label+"")&&ge(u,c)},i(f){g||(I(h.block),g=!0)},o(f){for(let n=0;n<3;n+=1){const b=h.blocks[n];x(b)}g=!1},d(f){f&&v(t),h.block.d(),h.token=null,h=null}}}function He(r){let e,t,a,l,s,o=[],m=new Map,c,u,i,g=F(r[3]);const h=f=>`${f[2]}-${f[5].key}-${f[5].label}`;for(let f=0;f<g.length;f+=1){let n=ie(r,g,f),b=h(n);m.set(b,o[f]=ce(b,n))}return{c(){e=k("div"),t=k("div"),a=new ye(!1),l=S(),s=k("div");for(let f=0;f<o.length;f+=1)o[f].c();this.h()},l(f){e=y(f,"DIV",{"data-testid":!0,class:!0});var n=C(e);t=y(n,"DIV",{class:!0});var b=C(t);a=$e(b,!1),b.forEach(v),l=T(n),s=y(n,"DIV",{class:!0});var w=C(s);for(let d=0;d<o.length;d+=1)o[d].l(w);w.forEach(v),n.forEach(v),this.h()},h(){a.a=null,_(t,"class","w-2/4"),_(s,"class",c="grid grid-cols-"+r[3].length+" grid-flow-col justify-center p-4 my-4 gap-y-9 "+(r[3].length>4?"w-full":"w-1/2")),_(e,"data-testid",u="data-summary-"+r[2]),_(e,"class","w-full flex flex-col items-center")},m(f,n){O(f,e,n),p(e,t),a.m(r[1],t),p(e,l),p(e,s);for(let b=0;b<o.length;b+=1)o[b]&&o[b].m(s,null);i=!0},p(f,[n]){(!i||n&2)&&a.p(f[1]),n&12&&(g=F(f[3]),Q(),o=je(o,n,h,1,f,g,m,s,Oe,ce,null,ie),B()),(!i||n&8&&c!==(c="grid grid-cols-"+f[3].length+" grid-flow-col justify-center p-4 my-4 gap-y-9 "+(f[3].length>4?"w-full":"w-1/2")))&&_(s,"class",c),(!i||n&4&&u!==(u="data-summary-"+f[2]))&&_(e,"data-testid",u)},i(f){if(!i){for(let n=0;n<g.length;n+=1)I(o[n]);i=!0}},o(f){for(let n=0;n<o.length;n+=1)x(o[n]);i=!1},d(f){f&&v(e);for(let n=0;n<o.length;n+=1)o[n].d()}}}function Ae(r,e,t){let a,l,s=P,o=()=>(s(),s=we(m,i=>t(3,l=i)),m);r.$$.on_destroy.push(()=>s());let{stats:m}=e;o();let{description:c}=e,{auth:u=!1}=e;return r.$$set=i=>{"stats"in i&&o(t(0,m=i.stats)),"description"in i&&t(1,c=i.description),"auth"in i&&t(4,u=i.auth)},r.$$.update=()=>{r.$$.dirty&16&&t(2,a=u?"auth":"open")},[m,c,a,l,u]}class ke extends W{constructor(e){super(),Y(this,e,Ae,He,G,{stats:0,description:1,auth:4})}}function ue(r){var a,l;let e,t;return e=new ke({props:{stats:be,auth:!0,description:(l=(a=D)==null?void 0:a.landing)==null?void 0:l.authExplanation}}),{c(){N(e.$$.fragment)},l(s){R(e.$$.fragment,s)},m(s,o){U(e,s,o),t=!0},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){x(e.$$.fragment,s),t=!1},d(s){M(e,s)}}}function fe(r){var a,l;let e,t;return e=new ke({props:{stats:ve,description:(l=(a=D)==null?void 0:a.landing)==null?void 0:l.explanation}}),{c(){N(e.$$.fragment)},l(s){R(e.$$.fragment,s)},m(s,o){U(e,s,o),t=!0},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){x(e.$$.fragment,s),t=!1},d(s){M(e,s)}}}function de(r){let e,t='<div><i class="fa-solid fa-circle-exclamation text-4xl"></i></div> <div class="alert-message"><p>We&#39;re having trouble fetching some data points right now. Please try again later.</p></div>';return{c(){e=k("div"),e.innerHTML=t,this.h()},l(a){e=y(a,"DIV",{id:!0,class:!0,"data-svelte-h":!0}),_e(e)!=="svelte-1tihk69"&&(e.innerHTML=t),this.h()},h(){_(e,"id","landing-errors"),_(e,"class","alert variant-filled-error text-error-50-900-token 200-700-token w-3/4 px-4 mb-6")},m(a,l){O(a,e,l)},d(a){a&&v(e)}}}function Qe(r){let e,t,a="Data Summary",l,s,o,m,c=r[0].length>0&&ue(),u=r[1].length>0&&fe(),i=r[2]&&de();return{c(){e=k("section"),t=k("h2"),t.textContent=a,l=S(),c&&c.c(),s=S(),u&&u.c(),o=S(),i&&i.c(),this.h()},l(g){e=y(g,"SECTION",{class:!0});var h=C(e);t=y(h,"H2",{class:!0,"data-svelte-h":!0}),_e(t)!=="svelte-c8j8ir"&&(t.textContent=a),l=T(h),c&&c.l(h),s=T(h),u&&u.l(h),o=T(h),i&&i.l(h),h.forEach(v),this.h()},h(){_(t,"class","m-4"),_(e,"class","flex flex-col items-center w-full p-4 bg-surface-300-600-token")},m(g,h){O(g,e,h),p(e,t),p(e,l),c&&c.m(e,null),p(e,s),u&&u.m(e,null),p(e,o),i&&i.m(e,null),m=!0},p(g,[h]){g[0].length>0?c?h&1&&I(c,1):(c=ue(),c.c(),I(c,1),c.m(e,s)):c&&(Q(),x(c,1,1,()=>{c=null}),B()),g[1].length>0?u?h&2&&I(u,1):(u=fe(),u.c(),I(u,1),u.m(e,o)):u&&(Q(),x(u,1,1,()=>{u=null}),B()),g[2]?i||(i=de(),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},i(g){m||(I(c),I(u),m=!0)},o(g){x(c),x(u),m=!1},d(g){g&&v(e),c&&c.d(),u&&u.d(),i&&i.d()}}}function Be(r,e,t){let a,l,s;return A(r,be,o=>t(0,a=o)),A(r,ve,o=>t(1,l=o)),A(r,z,o=>t(2,s=o)),Ee(()=>Re()),[a,l,s]}class ze extends W{constructor(e){super(),Y(this,e,Be,Qe,G,{})}}function he(r,e,t){const a=r.slice();return a[5]=e[t].title,a[6]=e[t].description,a[7]=e[t].icon,a[8]=e[t].url,a[9]=e[t].btnText,a}function me(r){let e,t,a=r[5]+"",l,s,o,m,c,u=r[6]+"",i,g,h,f=r[9]+"",n,b;return{c(){e=k("div"),t=k("div"),l=L(a),s=S(),o=k("i"),m=S(),c=k("div"),i=L(u),g=S(),h=k("a"),n=L(f),b=S(),this.h()},l(w){e=y(w,"DIV",{class:!0});var d=C(e);t=y(d,"DIV",{class:!0});var j=C(t);l=V(j,a),j.forEach(v),s=T(d),o=y(d,"I",{class:!0}),C(o).forEach(v),m=T(d),c=y(d,"DIV",{class:!0});var E=C(c);i=V(E,u),E.forEach(v),g=T(d),h=y(d,"A",{"data-testid":!0,href:!0,class:!0});var $=C(h);n=V($,f),$.forEach(v),b=T(d),d.forEach(v),this.h()},h(){var w;_(t,"class","text-3xl my-1"),_(o,"class","text-[5rem] my-3 text-secondary-500-400-token "+r[7]),_(c,"class","subtitle my-3"),_(h,"data-testid","landing-action-"+r[5]+"-btn"),_(h,"href",r[8]),_(h,"class","btn variant-filled-primary"),_(e,"class","flex flex-col items-center w-1/"+(((w=r[2])==null?void 0:w.length)||3))},m(w,d){O(w,e,d),p(e,t),p(t,l),p(e,s),p(e,o),p(e,m),p(e,c),p(c,i),p(e,g),p(e,h),p(h,n),p(e,b)},p:P,d(w){w&&v(e)}}}function Ge(r){var b,w;let e,t,a,l,s,o,m,c,u,i;document.title=D.applicationName;function g(d){r[3](d)}let h={placeholder:(w=(b=D)==null?void 0:b.landing)==null?void 0:w.searchPlaceholder,search:r[1]};r[0]!==void 0&&(h.searchTerm=r[0]),l=new Pe({props:h}),Ce.push(()=>xe(l,"searchTerm",g));let f=F(r[2]),n=[];for(let d=0;d<f.length;d+=1)n[d]=me(he(r,f,d));return u=new ze({}),{c(){e=S(),t=k("div"),a=k("section"),N(l.$$.fragment),o=S(),m=k("section");for(let d=0;d<n.length;d+=1)n[d].c();c=S(),N(u.$$.fragment),this.h()},l(d){Ie("svelte-1uz9aip",document.head).forEach(v),e=T(d),t=y(d,"DIV",{id:!0,class:!0});var E=C(t);a=y(E,"SECTION",{id:!0,class:!0});var $=C(a);R(l.$$.fragment,$),$.forEach(v),o=T(E),m=y(E,"SECTION",{id:!0,class:!0});var q=C(m);for(let H=0;H<n.length;H+=1)n[H].l(q);q.forEach(v),c=T(E),R(u.$$.fragment,E),E.forEach(v),this.h()},h(){_(a,"id","search-section"),_(a,"class","flex flex-col text-center items-center my-4 mt-auto w-2/3"),_(m,"id","actions-section"),_(m,"class","flex flex-row justify-evenly items-center w-2/3 mt-auto mb-8"),_(t,"id","landing"),_(t,"class","flex flex-wrap flex-col justify-evenly text-center items-center w-full h-full mt-8")},m(d,j){O(d,e,j),O(d,t,j),p(t,a),U(l,a,null),p(t,o),p(t,m);for(let E=0;E<n.length;E+=1)n[E]&&n[E].m(m,null);p(t,c),U(u,t,null),i=!0},p(d,[j]){const E={};if(!s&&j&1&&(s=!0,E.searchTerm=d[0],Se(()=>s=!1)),l.$set(E),j&4){f=F(d[2]);let $;for($=0;$<f.length;$+=1){const q=he(d,f,$);n[$]?n[$].p(q,j):(n[$]=me(q),n[$].c(),n[$].m(m,null))}for(;$<n.length;$+=1)n[$].d(1);n.length=f.length}},i(d){i||(I(l.$$.fragment,d),I(u.$$.fragment,d),i=!0)},o(d){x(l.$$.fragment,d),x(u.$$.fragment,d),i=!1},d(d){d&&(v(e),v(t)),M(l),Te(n,d),M(u)}}}function We(r,e,t){var c,u;let a="";const l=()=>!!localStorage.getItem("token");function s(){l()?se(`/explorer?search=${a}`):se(`/discover?search=${a}`)}const o=(u=(c=D)==null?void 0:c.landing)==null?void 0:u.actions.filter(i=>l()?i.showIfLoggedIn:i.isOpen||!i.showIfLoggedIn);function m(i){a=i,t(0,a)}return[a,s,o,m]}class ot extends W{constructor(e){super(),Y(this,e,We,Ge,G,{})}}export{ot as component};
