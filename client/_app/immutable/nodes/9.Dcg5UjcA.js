import"../chunks/Bzak7iHL.js";import{o as le}from"../chunks/B9BhT3Ut.js";import{p as de,l as te,h as re,e as ce,a as O,b as d,c as ve,f as m,d as s,k as e,s as g,r as i,t as P,n as ie,u as G}from"../chunks/pV5yBOfK.js";import{d as xe,s as q}from"../chunks/D3FUfhzK.js";import{a as se}from"../chunks/CF-XIK1E.js";import{i as k}from"../chunks/BAa5cEXk.js";import{e as Y,i as Z}from"../chunks/CFqqwPkz.js";import{s as K,a as be,c as ye,e as Te}from"../chunks/B3YVaWvx.js";import{t as we,f as Le}from"../chunks/Dj8TqXX2.js";import{p as J}from"../chunks/B9OKY7FI.js";import{b as M,f as ke}from"../chunks/i859GThY.js";import{t as Pe}from"../chunks/tvkVmxlD.js";import{h as Ie}from"../chunks/xQt8NbMC.js";import{p as $}from"../chunks/C2caA9Pm.js";import{c as Ne}from"../chunks/N6i2_EpV.js";import{s as Se}from"../chunks/COZ3s8UQ.js";import{r as ze}from"../chunks/D3-cXwBU.js";import{L as je}from"../chunks/D2cigjdB.js";import{E as Ae}from"../chunks/C6RsMIt9.js";import{L as ne}from"../chunks/BK-nQ0m1.js";var Ce=(I,a,y,N)=>{I.stopImmediatePropagation(),a(y(),N.provider.type)},Ee=m('<img class="mr-2 h-8"/>'),He=m('<div class="help-text svelte-18ne8hb"><!></div>'),Me=m('<button type="button"><!> <span> </span></button> <!>',1),qe=m('<button type="button" disabled class="btn preset-filled-primary-500 m-1 w-full" title="No provider selected" aria-label="No provider selected. Please select a provider from the dropdown menu above."><span>Login</span></button>');function ee(I,a){var j,R,D;de(a,!0);const y=$(a,"buttonText",3,"Log In"),N=$(a,"redirectTo",3,"/"),Q=$(a,"class",3,""),U=`login-button-${(R=(j=a.provider)==null?void 0:j.name)==null?void 0:R.toLowerCase()}`;let T=re(void 0),x=re(""),B=async(p,_)=>{(await Ne(a.provider)).login(p,_).then(()=>{ze()})};(D=a.provider)!=null&&D.imagesrc&&te(T,"./"+a.provider.imagesrc),le(()=>te(x,Se(a.helpText),!0));var w=ce(),S=O(w);{var z=p=>{var _=Me(),u=O(_);u.__click=[Ce,B,N,a];var c=s(u);{var h=f=>{var n=Ee();P(()=>{K(n,"src",e(T)),K(n,"alt",a.provider.imageAlt)}),d(f,n)};k(c,f=>{e(T)&&f(h)})}var b=g(c,2),A=s(b,!0);i(b),i(u);var W=g(u,2);{var X=f=>{var n=He(),F=s(n);Ie(F,()=>e(x)),i(n),d(f,n)};k(W,f=>{var n;a.helpText&&!((n=a.provider)!=null&&n.alt)&&f(X)})}P(()=>{K(u,"data-testid",U),be(u,1,ye(Q()??"btn preset-filled-primary-500 m-1"),"svelte-18ne8hb"),q(A,y())}),d(p,_)},V=p=>{var _=qe();d(p,_)};k(S,p=>{a.provider?p(z):p(V,!1)})}d(I,w),ve()}xe(["click"]);var Be=m("<div> </div>"),Re=m(`No main authentication providers are registered. Please add them to your
              configuration. Click <a class="anchor" href="https://pic-sure.gitbook.io/pic-sure-developer-guide/configuring-pic-sure" target="_blank">Here</a> to learn how.`,1),De=m('<option class="capitalize svelte-1p89lhy"> </option>'),Fe=m('<select id="login-select" required class="svelte-1p89lhy"><option disabled selected class="svelte-1p89lhy">Select a provider</option><!></select> <!>',1),Ge=m('<a class="btn preset-outlined-primary-500 text-primary-500 hover:preset-filled-primary-500 hover:text-white mb-4 w-full"> </a>'),Je=m('<div id="alt-logins" class="grid grid-cols-1 gap-4 mb-4 w-full"></div>'),Ke=m('<div id="login-box" class="w-max mt-2"><header class="flex flex-col items-center"><!></header> <div class="flex flex-col items-center justify-center"><div id="main-logins" class="grid grid-cols-1 gap-4 mb-4 w-full"><!> <!></div> <!> <!></div></div>'),Oe=m('<section id="logins" class="flex flex-col items-center h-screen w-full text-center place-content-center text-lg"><div id="title-box" class="flex flex-col items-center text-center mb-8 max-w-3/4"><h1 data-testid="login-title" class="mb-6 w-full flex gap-2 items-center justify-center"><!></h1> <p data-testid="login-description" class="text-2xl"> </p></div> <!></section>');function mt(I,a){var p,_,u;de(a,!0);const y=J.url.searchParams.get("redirectTo")||"/",N=(p=M)==null?void 0:p.applicationName,Q=(_=M)==null?void 0:_.login.description,U=(u=M)==null?void 0:u.login.openPicsureLinkText;let T;le(()=>{T=sessionStorage.getItem("logout-reason"),T&&(Pe.error({title:T}),sessionStorage.removeItem("logout-reason"))});let x=re(""),B=G(()=>{var c,h;return e(x)&&e(x)!==""?(h=(c=J.data)==null?void 0:c.providers)==null?void 0:h.find(b=>b.name===e(x)):void 0});var w=Oe(),S=s(w),z=s(S),V=s(z);je(V,{class:"flex-none",height:7.5}),i(z);var j=g(z,2),R=s(j,!0);i(j),i(S);var D=g(S,2);se(D,()=>{var c;return(c=J.data)==null?void 0:c.providers},c=>{ne(c,{ring:!0,size:"medium"})},(c,h)=>{var b=Ke(),A=s(b),W=s(A);{var X=t=>{var r=Be(),o=s(r,!0);i(r),P(()=>q(o,N)),d(t,r)};k(W,t=>{var r,o;(o=(r=M)==null?void 0:r.login)!=null&&o.showSiteName&&t(X)})}i(A);var f=g(A,2),n=s(f),F=s(n);{var me=t=>{Ae(t,{children:(r,o)=>{ie();var v=Re();ie(2),d(r,v)},$$slots:{default:!0}})};k(F,t=>{var r;((r=e(h))==null?void 0:r.length)===0&&t(me)})}var pe=g(F,2);{var ue=t=>{var r=Fe(),o=O(r),v=s(o);v.value=v.__value="";var l=g(v);Y(l,17,()=>e(h),Z,(E,L)=>{var H=De(),he=s(H,!0);i(H);var oe={};P(()=>{q(he,e(L).description||e(L).name),oe!==(oe=e(L).name)&&(H.value=(H.__value=e(L).name)??"")}),d(E,H)}),i(o);var C=g(o,2);{let E=G(()=>{var L;return(L=e(B))==null?void 0:L.helptext});ee(C,{buttonText:"Log In",get provider(){return e(B)},get redirectTo(){return y},get helpText(){return e(E)},class:"btn preset-filled-primary-500 w-full"})}Te(o,()=>e(x),E=>te(x,E)),d(t,r)},fe=t=>{var r=ce(),o=O(r);Y(o,17,()=>e(h),Z,(v,l)=>{{let C=G(()=>e(l).description||e(l).name);ee(v,{get buttonText(){return e(C)},get provider(){return e(l)},get redirectTo(){return y},get helpText(){return e(l).helptext},class:"btn preset-filled-primary-500 w-full"})}}),d(t,r)};k(pe,t=>{e(h).length>3?t(ue):t(fe,!1)})}i(n);var ae=g(n,2);{var ge=t=>{var r=Ge(),o=s(r,!0);i(r),P(()=>{var v,l;K(r,"href",((l=(v=M)==null?void 0:v.login)==null?void 0:l.openPicsureLink)||"/"),q(o,U)}),d(t,r)};k(ae,t=>{ke.login.open&&t(ge)})}var _e=g(ae,2);se(_e,()=>{var t;return(t=J.data)==null?void 0:t.altProviders},t=>{ne(t,{ring:!0})},(t,r)=>{var o=Je();Y(o,21,()=>e(r),Z,(v,l)=>{{let C=G(()=>e(l).description||e(l).name);ee(v,{get buttonText(){return e(C)},get provider(){return e(l)},get redirectTo(){return y},get helpText(){return e(l).helptext},class:"btn-sm preset-outlined-primary-500 text-primary-500 hover:preset-filled-primary-500 hover:text-white"})}}),i(o),d(t,o)}),i(f),i(b),d(c,b)}),i(w),P(()=>q(R,Q)),we(1,w,()=>Le,()=>({duration:600,x:"100%"})),d(I,w),ve()}export{mt as component};
