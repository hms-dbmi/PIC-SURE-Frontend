import{f as w,a as $,t as ot}from"../chunks/CtfeAAbw.js";import{p as F,c as n,r as o,s as v,f as it,g as e,t as T,h as E,a as G,n as lt,$ as nt,e as ct,b as dt}from"../chunks/B4GrenNm.js";import{s as q,h as ft}from"../chunks/DxSOTiY2.js";import{e as et,i as mt}from"../chunks/BdG0KSB2.js";import{s as N,b as W}from"../chunks/BPiAbArq.js";import{b as P}from"../chunks/CHRSknKA.js";import{g as K}from"../chunks/CsA2x4iF.js";import{S as vt}from"../chunks/C8xXU9Aq.js";import{d as st,w as H,g as ut,o as gt}from"../chunks/DlIBaGjY.js";import{i as M}from"../chunks/CSsnQ7i2.js";import{p as pt,a as D,s as rt}from"../chunks/DvPjbdiY.js";import{e as ht,f as xt,t as _t}from"../chunks/yAhaO9Md.js";import{b as $t,p as bt,S as z,c as wt}from"../chunks/EJhFMS5q.js";import{a as yt}from"../chunks/bf3FOAR_.js";import{h as St}from"../chunks/BeImZ7I_.js";import{p as jt}from"../chunks/CEVJ7K31.js";import{L as It}from"../chunks/B7pZD2Tm.js";import{E as Lt}from"../chunks/BVg5wqNm.js";const B=H(!1),Q=H(!1),J=H([]),X=st(J,c=>c.filter(r=>!r.auth)),Y=st(J,c=>c.filter(r=>r.auth));let Z="";async function Et(){var c,r;ht();try{const a=$t(((r=(c=P)==null?void 0:c.landing)==null?void 0:r.stats)||[]),g=a.map(({auth:d,key:f})=>[d,f].join(",")).join(";");if(Z===g)return;Z=g,await ut(xt),Q.set(!1),B.set(!1);const u=bt(a);J.set(u),Promise.allSettled(u.flatMap(z.list)).then(d=>{d.some(z.rejected)&&B.set(!0),Q.set(!0)})}catch(a){console.error(a),_t.error({title:"An error occured while loading statistics. If this problem persists, please contact an administrator."})}}var Pt=w('<i class="fa-solid fa-circle-exclamation p-1 mb-4 mt-1"></i>'),kt=w('<strong class="p-1 mb-3"> </strong> <!>',1),Rt=w('<div class="p-4 not-last:border-r border-surface-500"><div class="flex flex-col justify-center items-center text-2xl"><!></div> <p> </p></div>'),Tt=w('<div class="w-full flex flex-col items-center"><div class="w-2/4"><!></div> <div></div></div>');function tt(c,r){F(r,!0);const[a,g]=rt(),u=()=>D(r.stats,"$stats",a);let d=pt(r,"auth",3,!1),f=E(()=>d()?"auth":"open"),p=E(()=>u().length>4?"w-full":"w-1/2");const y={1:"grid-cols-1",2:"grid-cols-2",3:"grid-cols-3",4:"grid-cols-4",5:"grid-cols-5",6:"grid-cols-6",7:"grid-cols-7",8:"grid-cols-8",9:"grid-cols-9",10:"grid-cols-10",11:"grid-cols-11",12:"grid-cols-12"},k=E(()=>y[u().length]||"grid-cols-1");var m=Tt(),b=n(m),S=n(b);St(S,()=>jt.sanitize(r.description)),o(b);var x=v(b,2);et(x,5,u,t=>`${e(f)}-${t.key}-${t.label}`,(t,s)=>{var l=Rt(),i=n(l),O=n(i);yt(O,()=>Promise.allSettled(z.list(e(s))),_=>{It(_,{ring:!0,size:"mini"})},(_,j)=>{var C=kt(),I=it(C),R=n(I,!0);o(I);var V=v(I,2);{var L=h=>{var at=Pt();$(h,at)};M(V,h=>{e(j).some(z.rejected)&&h(L)})}T(h=>q(R,h),[()=>wt(e(j).filter(z.fullfiled).map(({value:h})=>h))]),$(_,C)}),o(i);var A=v(i,2),U=n(A,!0);o(A),o(l),T(()=>{N(i,"data-testid",`value-${e(f)??""}-${e(s).key??""}-${e(s).label??""}`),q(U,e(s).label)}),$(t,l)}),o(x),o(m),T(()=>{N(m,"data-testid",`data-summary-${e(f)??""}`),W(x,1,`grid ${e(k)??""} grid-flow-col justify-center p-4 my-4 gap-y-9 ${e(p)??""}`)}),$(c,m),G(),g()}var qt=w('<section class="flex flex-col items-center w-full p-4 bg-surface-100-900"><h2 class="m-4">Data Summary</h2> <!> <!> <!></section>');function zt(c,r){F(r,!0);const[a,g]=rt(),u=()=>D(Y,"$authStats",a),d=()=>D(X,"$stats",a),f=()=>D(B,"$hasError",a);gt(Et);var p=qt(),y=v(n(p),2);{var k=t=>{const s=E(()=>{var l,i;return(i=(l=P)==null?void 0:l.landing)==null?void 0:i.authExplanation});tt(t,{stats:Y,auth:!0,get description(){return e(s)}})};M(y,t=>{u().length>0&&t(k)})}var m=v(y,2);{var b=t=>{const s=E(()=>{var l,i;return(i=(l=P)==null?void 0:l.landing)==null?void 0:i.explanation});tt(t,{stats:X,get description(){return e(s)}})};M(m,t=>{d().length>0&&t(b)})}var S=v(m,2);{var x=t=>{Lt(t,{"data-testid":"landing-error",solid:!0,children:(s,l)=>{lt();var i=ot("We're having trouble fetching some data points right now. Please try again later.");$(s,i)},$$slots:{default:!0}})};M(S,t=>{f()&&t(x)})}o(p),$(c,p),G(),g()}var At=w('<div><div class="text-3xl my-1"> </div> <i></i> <div class="subtitle my-3"> </div> <a class="btn preset-filled-primary-500"> </a></div>'),Ct=w('<div id="landing" class="flex flex-wrap flex-col justify-evenly text-center items-center w-full h-full mt-8"><section id="search-section" class="flex flex-col text-center items-center my-auto w-2/3"><!></section> <section id="actions-section" class="flex flex-row justify-evenly items-center mb-auto w-2/3"></section> <!></div>');function ee(c,r){var S,x;F(r,!0);let a=dt("");const g=()=>!!localStorage.getItem("token");function u(){g()?K(`/explorer?search=${e(a)}`):K(`/discover?search=${e(a)}`)}const d=(x=(S=P)==null?void 0:S.landing)==null?void 0:x.actions.filter(t=>g()?t.showIfLoggedIn:t.isOpen||!t.showIfLoggedIn);var f=Ct();ft(t=>{T(()=>nt.title=P.applicationName)});var p=n(f),y=n(p);const k=E(()=>{var t,s;return(s=(t=P)==null?void 0:t.landing)==null?void 0:s.searchPlaceholder});vt(y,{get placeholder(){return e(k)},search:u,get searchTerm(){return e(a)},set searchTerm(t){ct(a,t,!0)}}),o(p);var m=v(p,2);et(m,21,()=>d,mt,(t,s)=>{let l=()=>e(s).title,i=()=>e(s).description,O=()=>e(s).icon,A=()=>e(s).url,U=()=>e(s).btnText;var _=At(),j=n(_),C=n(j,!0);o(j);var I=v(j,2),R=v(I,2),V=n(R,!0);o(R);var L=v(R,2),h=n(L,!0);o(L),o(_),T(()=>{W(_,1,`flex flex-col items-center w-1/${(d==null?void 0:d.length)||3}`),q(C,l()),W(I,1,`text-[5rem] my-3 text-secondary-600-400 ${O()??""}`),q(V,i()),N(L,"data-testid",`landing-action-${l()??""}-btn`),N(L,"href",A()),q(h,U())}),$(t,_)}),o(m);var b=v(m,2);zt(b,{}),o(f),$(c,f),G()}export{ee as component};
