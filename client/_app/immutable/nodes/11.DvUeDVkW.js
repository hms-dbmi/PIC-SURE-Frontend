import"../chunks/Bzak7iHL.js";import{o as h}from"../chunks/xU7jw7XU.js";import{p as u,f as v,b as S,c as w,d as T,r as y}from"../chunks/DhSNEPDw.js";import{p as s}from"../chunks/CftmxiRQ.js";import{g as n}from"../chunks/BPde4ukL.js";import{f as I}from"../chunks/BZHGrlEE.js";import{c as O}from"../chunks/LUVO2xEE.js";import{f as L}from"../chunks/DA3-ipRP.js";import{p as k}from"../chunks/B1n7kAsq.js";import{L as E}from"../chunks/bwStxD3u.js";import{s as b,l as x}from"../chunks/BNC-bmXQ.js";var P=v('<section class="w-full h-full flex flex-col justify-center items-center"><!></section>');function B(c,l){u(l,!0);async function m(){var f,p;let r="/",t;r=sessionStorage.getItem("redirect")||"/",t=sessionStorage.getItem("type");const a=t?(f=s.data)==null?void 0:f.providers.find(e=>e.type===t):void 0;if(!a)throw new Error("Provider not found");const d=await O(a);let o=((p=s.url.hash)==null?void 0:p.split("&"))||[];if(s.url.search.startsWith("?")&&(o=s.url.search.substring(1).split("&")||[]),!o||o.length===0)return new Error("Provider configuration error");await d.authenticate(o).then(e=>{if(!e||!(e!=null&&e.token))throw new Error("User not found");e.acceptedTOS=String(e.acceptedTOS)==="true",I.enforceTermsOfService&&!e.acceptedTOS?(b(e.token),n(r)):x(e.token).then(()=>n(r))})}h(async()=>{k.set(!1),m().catch(t=>{console.error("Login Error: ",t),n("/login/error")});let r=sessionStorage.getItem("filters");if(r){let t=JSON.parse(r||"[]");L.set(t),setTimeout(()=>sessionStorage.setItem("filters","[]"),500)}});var i=P(),g=T(i);E(g,{ring:!0,size:"large",label:"Logging you in"}),y(i),S(c,i),w()}export{B as component};
