import{c as se,a as i,f as d}from"../chunks/DKNWTM-D.js";import{o as be}from"../chunks/DpyMT7OB.js";import{p as ne,b as le,d as ce,f as K,a as de,c,g as e,s as g,r as s,t as O,n as ae,h as G}from"../chunks/KPVYLOSR.js";import{d as we,s as ve}from"../chunks/NtGCh5xy.js";import{a as oe}from"../chunks/DXJ436YI.js";import{i as y}from"../chunks/CDCmQmr-.js";import{e as W,i as X}from"../chunks/B5lqQSsR.js";import{s as J,b as ye,c as Te}from"../chunks/Be_LeCLl.js";import{t as Le,f as ke}from"../chunks/nsQMHjqs.js";import{b as Pe}from"../chunks/BwVKHEJU.js";import{a as Ie,s as Ne}from"../chunks/B2Bg6RTa.js";import{p as Se}from"../chunks/DjiALQWk.js";import{b as H}from"../chunks/BD7x6Jnt.js";import{t as Ce}from"../chunks/CWjZNTTC.js";import{h as je}from"../chunks/Bu63eCiy.js";import{p as Y}from"../chunks/CfrH0FQi.js";import{c as ze}from"../chunks/CmhHF9t-.js";import{r as Ae}from"../chunks/BPGq02fb.js";import{L as Ee}from"../chunks/DTPmYdw_.js";import{E as qe}from"../chunks/P3bGLiu7.js";import{L as ie}from"../chunks/BW_ShK1N.js";var Be=(I,a,N,S)=>{I.stopImmediatePropagation(),a(N(),S.provider.type)},He=d('<img class="mr-2 h-8"/>'),Me=d('<div class="help-text svelte-1gvr6jh"><!></div>'),Re=d('<button type="button"><!> <span> </span></button> <!>',1),De=d('<button type="button" disabled class="btn preset-filled-primary-500 m-1 w-full" title="No provider selected" aria-label="No provider selected. Please select a provider from the dropdown menu above."><span>Login</span></button>');function Z(I,a){var b,L,k;ne(a,!0);const N=Y(a,"buttonText",3,"Log In"),S=Y(a,"redirectTo",3,"/"),T=Y(a,"class",3,""),C=`login-button-${(L=(b=a.provider)==null?void 0:b.name)==null?void 0:L.toLowerCase()}`;let j=ce(void 0),Q=async(f,x)=>{(await ze(a.provider)).login(f,x).then(()=>{Ae()})};(k=a.provider)!=null&&k.imagesrc&&le(j,"./"+a.provider.imagesrc);var M=se(),z=K(M);{var h=f=>{var x=Re(),u=K(x);J(u,"data-testid",C),u.__click=[Be,Q,S,a];var A=c(u);{var D=m=>{var n=He();O(()=>{J(n,"src",e(j)),J(n,"alt",a.provider.imageAlt)}),i(m,n)};y(A,m=>{e(j)&&m(D)})}var E=g(A,2),v=c(E,!0);s(E),s(u);var _=g(u,2);{var w=m=>{var n=Me(),U=c(n);je(U,()=>a.helpText),s(n),i(m,n)};y(_,m=>{var n;a.helpText&&!((n=a.provider)!=null&&n.alt)&&m(w)})}O(()=>{ye(u,1,Te(T()??"btn preset-filled-primary-500 m-1"),"svelte-1gvr6jh"),ve(v,N())}),i(f,x)},R=f=>{var x=De();i(f,x)};y(z,f=>{a.provider?f(h):f(R,!1)})}i(I,M),de()}we(["click"]);var Fe=d("<div></div>"),Ge=d(`No main authentication providers are registered. Please add them to your
              configuration. Click <a class="anchor" href="https://pic-sure.gitbook.io/pic-sure-developer-guide/configuring-pic-sure" target="_blank">Here</a> to learn how.`,1),Je=d('<option class="capitalize svelte-8v8woc"> </option>'),Ke=d('<select id="login-select" class="select !w-fit svelte-8v8woc" required><option disabled selected class="svelte-8v8woc">Select a provider</option><!></select> <!>',1),Oe=d('<a class="btn preset-outlined-primary-500 text-primary-500 hover:preset-filled-primary-5 mb-4 w-full"></a>'),Qe=d('<div id="alt-logins" class="grid grid-cols-1 gap-4 mb-4 w-full"></div>'),Ue=d('<div id="login-box" class="w-max mt-2"><header class="flex flex-col items-center"><!></header> <div class="flex flex-col items-center justify-center"><div id="main-logins" class="grid grid-cols-1 gap-4 mb-4 w-full"><!> <!></div> <!> <!></div></div>'),Ve=d('<section id="logins" class="flex flex-col items-center h-screen w-full text-center place-content-center text-lg"><div id="title-box" class="flex flex-col items-center text-center mb-8 max-w-3/4"><h1 data-testid="login-title" class="mb-6 w-full flex gap-2 items-center justify-center"><!></h1> <p data-testid="login-description" class="text-2xl"></p></div> <!></section>');function ut(I,a){var A,D,E;ne(a,!0);const[N,S]=Ne(),T=()=>Ie(Se,"$page",N),C=T().url.searchParams.get("redirectTo")||"/",j=(A=H)==null?void 0:A.applicationName,Q=(D=H)==null?void 0:D.login.description,M=(E=H)==null?void 0:E.login.openPicsureLinkText;let z;be(()=>{z=sessionStorage.getItem("logout-reason"),z&&(Ce.error({title:z}),sessionStorage.removeItem("logout-reason"))});let h=ce(""),R=G(()=>{var v,_;return e(h)&&e(h)!==""?(_=(v=T().data)==null?void 0:v.providers)==null?void 0:_.find(w=>w.name===e(h)):void 0});var b=Ve(),L=c(b),k=c(L),f=c(k);Ee(f,{class:"flex-none",height:7.5}),s(k);var x=g(k,2);x.textContent=Q,s(L);var u=g(L,2);oe(u,()=>{var v;return(v=T().data)==null?void 0:v.providers},v=>{ie(v,{ring:!0,size:"medium"})},(v,_)=>{var w=Ue(),m=c(w),n=c(m);{var U=t=>{var r=Fe();r.textContent=j,i(t,r)};y(n,t=>{var r,o;(o=(r=H)==null?void 0:r.login)!=null&&o.showSiteName&&t(U)})}s(m);var $=g(m,2),V=c($),ee=c(V);{var me=t=>{qe(t,{children:(r,o)=>{ae();var l=Ge();ae(2),i(r,l)},$$slots:{default:!0}})};y(ee,t=>{var r;((r=e(_))==null?void 0:r.length)===0&&t(me)})}var pe=g(ee,2);{var fe=t=>{var r=Ke(),o=K(r),l=c(o);l.value=l.__value="";var p=g(l);W(p,17,()=>e(_),X,(P,F)=>{var B=Je(),re={},he=c(B,!0);s(B),O(()=>{re!==(re=e(F).name)&&(B.value=(B.__value=e(F).name)??""),ve(he,e(F).description||e(F).name)}),i(P,B)}),s(o);var q=g(o,2);const xe=G(()=>{var P;return(P=e(R))==null?void 0:P.helptext});Z(q,{buttonText:"Log In",get provider(){return e(R)},redirectTo:C,get helpText(){return e(xe)},class:"btn preset-filled-primary-500 w-full"}),Pe(o,()=>e(h),P=>le(h,P)),i(t,r)},ge=t=>{var r=se(),o=K(r);W(o,17,()=>e(_),X,(l,p)=>{const q=G(()=>e(p).description||e(p).name);Z(l,{get buttonText(){return e(q)},get provider(){return e(p)},redirectTo:C,get helpText(){return e(p).helptext},class:"btn preset-filled-primary-500 w-full"})}),i(t,r)};y(pe,t=>{e(_).length>3?t(fe):t(ge,!1)})}s(V);var te=g(V,2);{var ue=t=>{var r=Oe();r.textContent=M,O(()=>{var o,l;return J(r,"href",((l=(o=H)==null?void 0:o.login)==null?void 0:l.openPicsureLink)||"/")}),i(t,r)};y(te,t=>{t(ue)})}var _e=g(te,2);oe(_e,()=>{var t;return(t=T().data)==null?void 0:t.altProviders},t=>{ie(t,{ring:!0})},(t,r)=>{var o=Qe();W(o,21,()=>e(r),X,(l,p)=>{const q=G(()=>e(p).description||e(p).name);Z(l,{get buttonText(){return e(q)},get provider(){return e(p)},redirectTo:C,get helpText(){return e(p).helptext},class:"btn-sm preset-outlined-secondary-500 text-secondary-500 hover:preset-filled-secondary-500 hover:text-primary-500 w-full"})}),s(o),i(t,o)}),s($),s(w),i(v,w)}),s(b),Le(1,b,()=>ke,()=>({duration:600,x:"100%"})),i(I,b),de(),S()}export{ut as component};
