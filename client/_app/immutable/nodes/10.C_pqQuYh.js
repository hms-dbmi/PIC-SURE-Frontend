import{s as W,e as k,H as ye,a as S,c as y,b as C,z as $e,f as v,g as T,m as _,i as O,h as p,t as L,d as V,j as ge,n as P,a9 as we,l as _e,k as A,o as Ee,A as Ce,p as Ie,B as Se,x as Te}from"../chunks/CJ6ziB5E.js";import{S as Y,i as J,g as Q,b as z,t as I,a as x,d as N,e as U,m as R,f as H,h as xe}from"../chunks/CVe-HNkC.js";import{e as M,u as je,o as Oe}from"../chunks/B9MtYE6U.js";import{b as D}from"../chunks/Do7xJ0Gi.js";import{d as pe,w as K,g as ae}from"../chunks/D9QhBFw8.js";import{S as Pe}from"../chunks/BXtHHR7C.js";import{f as X,p as Z}from"../chunks/Ct076jVC.js";import{a as ee}from"../chunks/Cz7E3h2M.js";import{a as De,b as qe}from"../chunks/qLd7hq4-.js";import{h as le,u as Le}from"../chunks/B1UO4OkM.js";import"../chunks/DXVbyi0u.js";import{P as Ve}from"../chunks/jzPdkqxf.js";const te="picsure/query/sync",G=K(!1),ne=K(!1),se=K([]),ve=pe(se,a=>a.filter(e=>!e.auth)),be=pe(se,a=>a.filter(e=>e.auth));function re(a){return a!=null&&a.errorType?Promise.reject("api error"):a}function oe(a,e){var r,o,m;const t=((m=(o=(r=D)==null?void 0:r.landing)==null?void 0:o.statFields[a])==null?void 0:m.map(i=>i.conceptPath))||[];if(t.length===0)return Promise.reject(`${a} feilds were not configured`);const s=ee(X(),e);return s.query.setCrossCountFields(t),Z(te,s).then(re).then(i=>Object.values(i).reduce((u,c)=>u+c,0))}function Ne(){var s,l;const a=((l=(s=D)==null?void 0:s.landing)==null?void 0:l.statFields.consent)||[];if(a.length===0)return Promise.reject("consent feilds were not configured");const e=a.reduce((r,o)=>({...r,[o.conceptPath]:[...r[o.conceptPath]||[],o.id]}),{}),t=ee(X(),"COUNT");return Object.entries(e).forEach(([r,o])=>t.query.addCategoryFilter(r,o)),Z(te,t).then(re)}const B={"dict:facets:dataset_id":a=>De(a,"dataset_id"),"dict:concepts":a=>qe(a),"query:blank":a=>Z(te,ee(a)).then(re),"query:biosample":()=>oe("biosample","OBSERVATION_CROSS_COUNT"),"query:genomic":()=>oe("genomic","CROSS_COUNT"),"query:consent":()=>Ne(),hardcoded:(a,e)=>Promise.resolve((e==null?void 0:e.value)||0)};async function Ue(){var t,s;const a=((s=(t=D)==null?void 0:t.landing)==null?void 0:s.stats)||[];if(a.length===0)return;ne.set(!1),G.set(!1);const e=a.filter(l=>!!B[l.key]).reduce((l,r)=>{const o=[...l],m=(r==null?void 0:r.auth)===void 0?!0:r.auth,i=(r==null?void 0:r.auth)===void 0?!0:!r.auth;return m&&X()&&o.push({...r,auth:!0,value:B[r.key](!1,r)}),i&&o.push({...r,auth:!1,value:B[r.key](!0,r)}),o},[]);se.set(e),Promise.allSettled(e.map(l=>l.value)).then(l=>{l.some(r=>r.status==="rejected")&&G.set(!0),ne.set(!0)})}function ie(a,e,t){const s=a.slice();return s[5]=e[t],s}function Re(a){let e;return{c(){e=k("i"),this.h()},l(t){e=y(t,"I",{class:!0}),C(e).forEach(v),this.h()},h(){_(e,"class","fa-solid fa-circle-exclamation p-1 mb-4 mt-1")},m(t,s){O(t,e,s)},p:P,i:P,o:P,d(t){t&&v(e)}}}function He(a){let e,t=(a[8]&&a[8].toLocaleString())+"",s;return{c(){e=k("strong"),s=L(t),this.h()},l(l){e=y(l,"STRONG",{class:!0});var r=C(e);s=V(r,t),r.forEach(v),this.h()},h(){_(e,"class","p-1 mb-3")},m(l,r){O(l,e,r),p(e,s)},p(l,r){r&8&&t!==(t=(l[8]&&l[8].toLocaleString())+"")&&ge(s,t)},i:P,o:P,d(l){l&&v(e)}}}function Me(a){let e,t;return e=new Ve({props:{width:"w-10",meter:"stroke-surface-50 dark:stroke-surface-900",track:"stroke-secondary-500/30",value:void 0}}),{c(){N(e.$$.fragment)},l(s){U(e.$$.fragment,s)},m(s,l){R(e,s,l),t=!0},p:P,i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){x(e.$$.fragment,s),t=!1},d(s){H(e,s)}}}function ce(a,e){let t,s,l,r,o,m,i=e[5].label+"",u,c,g,h={ctx:e,current:null,token:null,hasCatch:!0,pending:Me,then:He,catch:Re,value:8,blocks:[,,,]};return le(l=e[5].value,h),{key:a,first:null,c(){t=k("div"),s=k("div"),h.block.c(),o=S(),m=k("p"),u=L(i),c=S(),this.h()},l(f){t=y(f,"DIV",{class:!0});var n=C(t);s=y(n,"DIV",{"data-testid":!0,class:!0});var b=C(s);h.block.l(b),b.forEach(v),o=T(n),m=y(n,"P",{});var w=C(m);u=V(w,i),w.forEach(v),c=T(n),n.forEach(v),this.h()},h(){_(s,"data-testid",r="value-"+e[2]+"-"+e[5].key+"-"+e[5].label),_(s,"class","flex flex-col justify-center items-center text-2xl"),_(t,"class","p-4 [&:not(:last-child)]:border-r border-surface-400-500-token"),this.first=t},m(f,n){O(f,t,n),p(t,s),h.block.m(s,h.anchor=null),h.mount=()=>s,h.anchor=null,p(t,o),p(t,m),p(m,u),p(t,c),g=!0},p(f,n){e=f,h.ctx=e,n&8&&l!==(l=e[5].value)&&le(l,h)||Le(h,e,n),(!g||n&12&&r!==(r="value-"+e[2]+"-"+e[5].key+"-"+e[5].label))&&_(s,"data-testid",r),(!g||n&8)&&i!==(i=e[5].label+"")&&ge(u,i)},i(f){g||(I(h.block),g=!0)},o(f){for(let n=0;n<3;n+=1){const b=h.blocks[n];x(b)}g=!1},d(f){f&&v(t),h.block.d(),h.token=null,h=null}}}function Fe(a){let e,t,s,l,r,o=[],m=new Map,i,u,c,g=M(a[3]);const h=f=>`${f[2]}-${f[5].key}-${f[5].label}`;for(let f=0;f<g.length;f+=1){let n=ie(a,g,f),b=h(n);m.set(b,o[f]=ce(b,n))}return{c(){e=k("div"),t=k("div"),s=new ye(!1),l=S(),r=k("div");for(let f=0;f<o.length;f+=1)o[f].c();this.h()},l(f){e=y(f,"DIV",{"data-testid":!0,class:!0});var n=C(e);t=y(n,"DIV",{class:!0});var b=C(t);s=$e(b,!1),b.forEach(v),l=T(n),r=y(n,"DIV",{class:!0});var w=C(r);for(let d=0;d<o.length;d+=1)o[d].l(w);w.forEach(v),n.forEach(v),this.h()},h(){s.a=null,_(t,"class","w-2/4"),_(r,"class",i="grid grid-cols-"+a[3].length+" grid-flow-col justify-center p-4 my-4 gap-y-9 "+(a[3].length>4?"w-full":"w-1/2")),_(e,"data-testid",u="data-summary-"+a[2]),_(e,"class","w-full flex flex-col items-center")},m(f,n){O(f,e,n),p(e,t),s.m(a[1],t),p(e,l),p(e,r);for(let b=0;b<o.length;b+=1)o[b]&&o[b].m(r,null);c=!0},p(f,[n]){(!c||n&2)&&s.p(f[1]),n&12&&(g=M(f[3]),Q(),o=je(o,n,h,1,f,g,m,r,Oe,ce,null,ie),z()),(!c||n&8&&i!==(i="grid grid-cols-"+f[3].length+" grid-flow-col justify-center p-4 my-4 gap-y-9 "+(f[3].length>4?"w-full":"w-1/2")))&&_(r,"class",i),(!c||n&4&&u!==(u="data-summary-"+f[2]))&&_(e,"data-testid",u)},i(f){if(!c){for(let n=0;n<g.length;n+=1)I(o[n]);c=!0}},o(f){for(let n=0;n<o.length;n+=1)x(o[n]);c=!1},d(f){f&&v(e);for(let n=0;n<o.length;n+=1)o[n].d()}}}function Ae(a,e,t){let s,l,r=P,o=()=>(r(),r=we(m,c=>t(3,l=c)),m);a.$$.on_destroy.push(()=>r());let{stats:m}=e;o();let{description:i}=e,{auth:u=!1}=e;return a.$$set=c=>{"stats"in c&&o(t(0,m=c.stats)),"description"in c&&t(1,i=c.description),"auth"in c&&t(4,u=c.auth)},a.$$.update=()=>{a.$$.dirty&16&&t(2,s=u?"auth":"open")},[m,i,s,l,u]}class ke extends Y{constructor(e){super(),J(this,e,Ae,Fe,W,{stats:0,description:1,auth:4})}}function ue(a){var s,l;let e,t;return e=new ke({props:{stats:be,auth:!0,description:(l=(s=D)==null?void 0:s.landing)==null?void 0:l.authExplanation}}),{c(){N(e.$$.fragment)},l(r){U(e.$$.fragment,r)},m(r,o){R(e,r,o),t=!0},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){x(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function fe(a){var s,l;let e,t;return e=new ke({props:{stats:ve,description:(l=(s=D)==null?void 0:s.landing)==null?void 0:l.explanation}}),{c(){N(e.$$.fragment)},l(r){U(e.$$.fragment,r)},m(r,o){R(e,r,o),t=!0},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){x(e.$$.fragment,r),t=!1},d(r){H(e,r)}}}function de(a){let e,t='<div><i class="fa-solid fa-circle-exclamation text-4xl"></i></div> <div class="alert-message"><p>We&#39;re having trouble fetching some data points right now. Please try again later.</p></div>';return{c(){e=k("div"),e.innerHTML=t,this.h()},l(s){e=y(s,"DIV",{id:!0,class:!0,"data-svelte-h":!0}),_e(e)!=="svelte-1tihk69"&&(e.innerHTML=t),this.h()},h(){_(e,"id","landing-errors"),_(e,"class","alert variant-filled-error text-error-50-900-token 200-700-token w-3/4 px-4 mb-6")},m(s,l){O(s,e,l)},d(s){s&&v(e)}}}function Be(a){let e,t,s="Data Summary",l,r,o,m,i=a[0].length>0&&ue(),u=a[1].length>0&&fe(),c=a[2]&&de();return{c(){e=k("section"),t=k("h2"),t.textContent=s,l=S(),i&&i.c(),r=S(),u&&u.c(),o=S(),c&&c.c(),this.h()},l(g){e=y(g,"SECTION",{class:!0});var h=C(e);t=y(h,"H2",{class:!0,"data-svelte-h":!0}),_e(t)!=="svelte-c8j8ir"&&(t.textContent=s),l=T(h),i&&i.l(h),r=T(h),u&&u.l(h),o=T(h),c&&c.l(h),h.forEach(v),this.h()},h(){_(t,"class","m-4"),_(e,"class","flex flex-col items-center w-full p-4 bg-surface-300-600-token")},m(g,h){O(g,e,h),p(e,t),p(e,l),i&&i.m(e,null),p(e,r),u&&u.m(e,null),p(e,o),c&&c.m(e,null),m=!0},p(g,[h]){g[0].length>0?i?h&1&&I(i,1):(i=ue(),i.c(),I(i,1),i.m(e,r)):i&&(Q(),x(i,1,1,()=>{i=null}),z()),g[1].length>0?u?h&2&&I(u,1):(u=fe(),u.c(),I(u,1),u.m(e,o)):u&&(Q(),x(u,1,1,()=>{u=null}),z()),g[2]?c||(c=de(),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},i(g){m||(I(i),I(u),m=!0)},o(g){x(i),x(u),m=!1},d(g){g&&v(e),i&&i.d(),u&&u.d(),c&&c.d()}}}function Qe(a,e,t){let s,l,r;return A(a,be,o=>t(0,s=o)),A(a,ve,o=>t(1,l=o)),A(a,G,o=>t(2,r=o)),Ee(()=>Ue()),[s,l,r]}class ze extends Y{constructor(e){super(),J(this,e,Qe,Be,W,{})}}function he(a,e,t){const s=a.slice();return s[5]=e[t].title,s[6]=e[t].description,s[7]=e[t].icon,s[8]=e[t].url,s[9]=e[t].btnText,s}function me(a){let e,t,s=a[5]+"",l,r,o,m,i,u=a[6]+"",c,g,h,f=a[9]+"",n,b;return{c(){e=k("div"),t=k("div"),l=L(s),r=S(),o=k("i"),m=S(),i=k("div"),c=L(u),g=S(),h=k("a"),n=L(f),b=S(),this.h()},l(w){e=y(w,"DIV",{class:!0});var d=C(e);t=y(d,"DIV",{class:!0});var j=C(t);l=V(j,s),j.forEach(v),r=T(d),o=y(d,"I",{class:!0}),C(o).forEach(v),m=T(d),i=y(d,"DIV",{class:!0});var E=C(i);c=V(E,u),E.forEach(v),g=T(d),h=y(d,"A",{"data-testid":!0,href:!0,class:!0});var $=C(h);n=V($,f),$.forEach(v),b=T(d),d.forEach(v),this.h()},h(){var w;_(t,"class","text-3xl my-1"),_(o,"class","text-[5rem] my-3 text-secondary-500-400-token "+a[7]),_(i,"class","subtitle my-3"),_(h,"data-testid","landing-action-"+a[5]+"-btn"),_(h,"href",a[8]),_(h,"class","btn variant-filled-primary"),_(e,"class","flex flex-col items-center w-1/"+(((w=a[2])==null?void 0:w.length)||3))},m(w,d){O(w,e,d),p(e,t),p(t,l),p(e,r),p(e,o),p(e,m),p(e,i),p(i,c),p(e,g),p(e,h),p(h,n),p(e,b)},p:P,d(w){w&&v(e)}}}function Ge(a){var b,w;let e,t,s,l,r,o,m,i,u,c;document.title=D.applicationName;function g(d){a[3](d)}let h={placeholder:(w=(b=D)==null?void 0:b.landing)==null?void 0:w.searchPlaceholder,search:a[1]};a[0]!==void 0&&(h.searchTerm=a[0]),l=new Pe({props:h}),Ce.push(()=>xe(l,"searchTerm",g));let f=M(a[2]),n=[];for(let d=0;d<f.length;d+=1)n[d]=me(he(a,f,d));return u=new ze({}),{c(){e=S(),t=k("div"),s=k("section"),N(l.$$.fragment),o=S(),m=k("section");for(let d=0;d<n.length;d+=1)n[d].c();i=S(),N(u.$$.fragment),this.h()},l(d){Ie("svelte-1uz9aip",document.head).forEach(v),e=T(d),t=y(d,"DIV",{id:!0,class:!0});var E=C(t);s=y(E,"SECTION",{id:!0,class:!0});var $=C(s);U(l.$$.fragment,$),$.forEach(v),o=T(E),m=y(E,"SECTION",{id:!0,class:!0});var q=C(m);for(let F=0;F<n.length;F+=1)n[F].l(q);q.forEach(v),i=T(E),U(u.$$.fragment,E),E.forEach(v),this.h()},h(){_(s,"id","search-section"),_(s,"class","flex flex-col text-center items-center my-4 mt-auto w-2/3"),_(m,"id","actions-section"),_(m,"class","flex flex-row justify-evenly items-center w-2/3 mt-auto mb-8"),_(t,"id","landing"),_(t,"class","flex flex-wrap flex-col justify-evenly text-center items-center w-full h-full mt-8")},m(d,j){O(d,e,j),O(d,t,j),p(t,s),R(l,s,null),p(t,o),p(t,m);for(let E=0;E<n.length;E+=1)n[E]&&n[E].m(m,null);p(t,i),R(u,t,null),c=!0},p(d,[j]){const E={};if(!r&&j&1&&(r=!0,E.searchTerm=d[0],Se(()=>r=!1)),l.$set(E),j&4){f=M(d[2]);let $;for($=0;$<f.length;$+=1){const q=he(d,f,$);n[$]?n[$].p(q,j):(n[$]=me(q),n[$].c(),n[$].m(m,null))}for(;$<n.length;$+=1)n[$].d(1);n.length=f.length}},i(d){c||(I(l.$$.fragment,d),I(u.$$.fragment,d),c=!0)},o(d){x(l.$$.fragment,d),x(u.$$.fragment,d),c=!1},d(d){d&&(v(e),v(t)),H(l),Te(n,d),H(u)}}}function We(a,e,t){var i,u;let s="";const l=()=>!!localStorage.getItem("token");function r(){l()?ae(`/explorer?search=${s}`):ae(`/discover?search=${s}`)}const o=(u=(i=D)==null?void 0:i.landing)==null?void 0:u.actions.filter(c=>l()?c.showIfLoggedIn:c.isOpen||!c.showIfLoggedIn);function m(c){s=c,t(0,s)}return[s,r,o,m]}class ot extends Y{constructor(e){super(),J(this,e,We,Ge,W,{})}}export{ot as component};
