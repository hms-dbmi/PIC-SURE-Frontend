import{s as R,q as v,i as d,n as c,f as l,e as _,t as T,c as b,b as g,d as x,m as u,h as E,r as I,a as q,p as A,g as B,o as L,a3 as M}from"../chunks/scheduler.bui7uCNy.js";import{h as N,u as O}from"../chunks/await_block.DenEio6G.js";import{S as C,i as G,d as $,e as k,m as w,t as p,a as h,f as y}from"../chunks/index.Divvo4fc.js";import"../chunks/ProgressBar.svelte_svelte_type_style_lang.B7SkmbeT.js";import{P as z}from"../chunks/ProgressBar.BewV8pu5.js";import{f as F,b as H}from"../chunks/configuration.CIpdfyUx.js";import{C as Q}from"../chunks/Content.DXI55Z0I.js";import{T as j}from"../chunks/Table.BpsTUvy6.js";import{w as P}from"../chunks/entry.D9nKiiu7.js";import{u as J,g as K}from"../chunks/User.D1BG6p9P.js";function U(s){let e,a;return{c(){e=_("a"),a=T("More Info"),this.h()},l(t){e=b(t,"A",{href:!0,class:!0,target:!0});var n=g(e);a=x(n,"More Info"),n.forEach(l),this.h()},h(){u(e,"href",s[0]),u(e,"class","btn variant-ghost-primary hover:variant-filled-primary"),u(e,"target","_blank")},m(t,n){d(t,e,n),E(e,a)},p:c,d(t){t&&l(e)}}}function V(s){let e;return{c(){e=_("i"),this.h()},l(a){e=b(a,"I",{class:!0}),g(e).forEach(l),this.h()},h(){u(e,"class","fa-regular fa-circle-check text-3xl text-success-500")},m(a,t){d(a,e,t)},p:c,d(a){a&&l(e)}}}function W(s){let e;function a(r,o){return r[1]?V:U}let n=a(s)(s);return{c(){n.c(),e=v()},l(r){n.l(r),e=v()},m(r,o){n.m(r,o),d(r,e,o)},p(r,[o]){n.p(r,o)},i:c,o:c,d(r){r&&l(e),n.d(r)}}}function X(s,e,a){let{data:t={row:{additional_info_link:"",consentGranted:!1}}}=e,n=t.row.additional_info_link,r=t.row.consentGranted;return s.$$set=o=>{"data"in o&&a(2,t=o.data)},[n,r,t]}class Y extends C{constructor(e){super(),G(this,e,X,W,R,{data:2})}}const D=P([]),S=P([]);function Z(){return K("picsure/proxy/dictionary-api/dashboard")}function ee(){return!!localStorage.getItem("token")}async function te(){var o,m;const s=await Z();D.set(s.columns);const e=I(J),a=F.useQueryTemplate&&ee()&&(e==null?void 0:e.queryTemplate);let t=[];a&&(t=((m=(o=e.queryTemplate)==null?void 0:o.categoryFilters)==null?void 0:m["\\_consents\\"])||[]);const r=s.rows.map(ne(t)).sort((f,i)=>f.consentGranted===i.consentGranted?ae(f,i):f.consentGranted?-1:1);S.set(r)}function ne(s){return e=>{if(!e.accession)return{...e,consentGranted:!1};const a=e.accession.toString();if(/^phs\d+\.v\d+\.p\d+\.c\d+$/.test(a)){const n=a.replace(/\.v\d+\.p\d+/,"");return{...e,consentGranted:s.includes(n)}}return{...e,consentGranted:s.includes(a)}}}function ae(s,e){var n,r;const a=((n=s.abbreviation)==null?void 0:n.toString())||"",t=((r=e.abbreviation)==null?void 0:r.toString())||"";return a.localeCompare(t)}function re(s){return{c,l:c,m:c,p:c,i:c,o:c,d:c}}function se(s){let e,a;return e=new j({props:{tableName:ie,data:s[1],columns:s[0],cellOverides:s[2],defaultRowsPerPage:s[1].length,search:!1,showPagination:!1,stickyHeader:!0}}),{c(){$(e.$$.fragment)},l(t){k(e.$$.fragment,t)},m(t,n){w(e,t,n),a=!0},p(t,n){const r={};n&2&&(r.data=t[1]),n&1&&(r.columns=t[0]),n&2&&(r.defaultRowsPerPage=t[1].length),e.$set(r)},i(t){a||(p(e.$$.fragment,t),a=!0)},o(t){h(e.$$.fragment,t),a=!1},d(t){y(e,t)}}}function oe(s){let e,a;return e=new z({props:{animIndeterminate:"anim-progress-bar"}}),{c(){$(e.$$.fragment)},l(t){k(e.$$.fragment,t)},m(t,n){w(e,t,n),a=!0},p:c,i(t){a||(p(e.$$.fragment,t),a=!0)},o(t){h(e.$$.fragment,t),a=!1},d(t){y(e,t)}}}function ce(s){let e,a,t={ctx:s,current:null,token:null,hasCatch:!1,pending:oe,then:se,catch:re,blocks:[,,,]};return N(s[3],t),{c(){e=_("section"),t.block.c(),this.h()},l(n){e=b(n,"SECTION",{id:!0,class:!0});var r=g(e);t.block.l(r),r.forEach(l),this.h()},h(){u(e,"id","data-container"),u(e,"class","")},m(n,r){d(n,e,r),t.block.m(e,t.anchor=null),t.mount=()=>e,t.anchor=null,a=!0},p(n,r){s=n,O(t,s,r)},i(n){a||(p(t.block),a=!0)},o(n){for(let r=0;r<3;r+=1){const o=t.blocks[r];h(o)}a=!1},d(n){n&&l(e),t.block.d(),t.token=null,t=null}}}function le(s){let e,a,t;return document.title=H.applicationName,a=new Q({props:{title:"Data Dashboard",class:"content-center",full:!0,$$slots:{default:[ce]},$$scope:{ctx:s}}}),{c(){e=q(),$(a.$$.fragment)},l(n){A("svelte-1uz9aip",document.head).forEach(l),e=B(n),k(a.$$.fragment,n)},m(n,r){d(n,e,r),w(a,n,r),t=!0},p(n,[r]){const o={};r&67&&(o.$$scope={dirty:r,ctx:n}),a.$set(o)},i(n){t||(p(a.$$.fragment,n),t=!0)},o(n){h(a.$$.fragment,n),t=!1},d(n){n&&l(e),y(a,n)}}}const ie="ExplorerTable";function ue(s,e,a){let t,n,r=[],o=[];const m={additional_info_link:Y},f=te();return L(()=>{t=D.subscribe(i=>a(0,r=i)),n=S.subscribe(i=>{a(1,o=i)})}),M(()=>{t&&t(),n&&n()}),[r,o,m,f]}class we extends C{constructor(e){super(),G(this,e,ue,le,R,{})}}export{we as component};
