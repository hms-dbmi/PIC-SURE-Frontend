{"version":3,"file":"Search-Bp0u75kz.js","sources":["../../../.svelte-kit/adapter-node/chunks/Search.js"],"sourcesContent":["import { w as writable } from \"./index2.js\";\nimport { s as searchDictionary } from \"./dictionary.js\";\nimport { g as get_store_value } from \"./lifecycle.js\";\nconst loading = writable(\n  Promise.resolve(void 0)\n);\nconst searchTerm = writable(\"\");\nconst selectedFacets = writable([]);\nconst error = writable(\"\");\nasync function search(searchTerm2, facets, state) {\n  if (!searchTerm2 && (!facets || !facets.length)) {\n    state?.setTotalRows(0);\n    return [];\n  }\n  const search2 = searchDictionary(searchTerm2.trim(), facets, {\n    pageNumber: state?.pageNumber ? state?.pageNumber - 1 : 0,\n    pageSize: state?.rowsPerPage\n  });\n  loading.set(search2);\n  const response = await search2.catch((e) => {\n    console.error(e);\n    state?.setTotalRows(0);\n    error.set(\n      \"An error occurred while searching. If the problem persists, please contact an administrator.\"\n    );\n    throw e;\n  });\n  if (!response) {\n    error.set(\n      \"An error occurred while searching. If the problem persists, please contact an administrator.\"\n    );\n  }\n  state?.setTotalRows(response?.totalElements ?? 0);\n  return response?.content ?? [];\n}\nasync function updateFacets(facetsToUpdate) {\n  const currentFacets = get_store_value(selectedFacets);\n  facetsToUpdate.forEach((facet) => {\n    const facetIndex = currentFacets.findIndex((f) => f.name === facet.name);\n    if (facetIndex !== -1) {\n      currentFacets.splice(facetIndex, 1);\n    } else {\n      currentFacets.push(facet);\n    }\n  });\n  selectedFacets.set(currentFacets.sort((a, b) => b.count - a.count));\n}\nfunction resetSearch() {\n  searchTerm.set(\"\");\n  selectedFacets.set([]);\n  error.set(\"\");\n}\nconst SearchStore = {\n  selectedFacets,\n  searchTerm,\n  error,\n  search,\n  updateFacets,\n  resetSearch\n};\nexport {\n  SearchStore as S,\n  searchTerm as a,\n  loading as l,\n  selectedFacets as s\n};\n"],"names":[],"mappings":";;;;AAGK,MAAC,OAAO,GAAG,QAAQ;AACxB,EAAE,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC;AACxB;AACK,MAAC,UAAU,GAAG,QAAQ,CAAC,EAAE;AACzB,MAAC,cAAc,GAAG,QAAQ,CAAC,EAAE;AAClC,MAAM,KAAK,GAAG,QAAQ,CAAC,EAAE,CAAC;AAC1B,eAAe,MAAM,CAAC,WAAW,EAAE,MAAM,EAAE,KAAK,EAAE;AAClD,EAAE,IAAI,CAAC,WAAW,KAAK,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE;AACnD,IAAI,KAAK,EAAE,YAAY,CAAC,CAAC,CAAC;AAC1B,IAAI,OAAO,EAAE;AACb;AACA,EAAE,MAAM,OAAO,GAAG,gBAAgB,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,MAAM,EAAE;AAC/D,IAAI,UAAU,EAAE,KAAK,EAAE,UAAU,GAAG,KAAK,EAAE,UAAU,GAAG,CAAC,GAAG,CAAC;AAC7D,IAAI,QAAQ,EAAE,KAAK,EAAE;AACrB,GAAG,CAAC;AACJ,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC;AACtB,EAAE,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK;AAC9C,IAAI,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;AACpB,IAAI,KAAK,EAAE,YAAY,CAAC,CAAC,CAAC;AAC1B,IAAI,KAAK,CAAC,GAAG;AACb,MAAM;AACN,KAAK;AACL,IAAI,MAAM,CAAC;AACX,GAAG,CAAC;AACJ,EAAE,IAAI,CAAC,QAAQ,EAAE;AACjB,IAAI,KAAK,CAAC,GAAG;AACb,MAAM;AACN,KAAK;AACL;AACA,EAAE,KAAK,EAAE,YAAY,CAAC,QAAQ,EAAE,aAAa,IAAI,CAAC,CAAC;AACnD,EAAE,OAAO,QAAQ,EAAE,OAAO,IAAI,EAAE;AAChC;AACA,eAAe,YAAY,CAAC,cAAc,EAAE;AAC5C,EAAE,MAAM,aAAa,GAAG,eAAe,CAAC,cAAc,CAAC;AACvD,EAAE,cAAc,CAAC,OAAO,CAAC,CAAC,KAAK,KAAK;AACpC,IAAI,MAAM,UAAU,GAAG,aAAa,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,KAAK,KAAK,CAAC,IAAI,CAAC;AAC5E,IAAI,IAAI,UAAU,KAAK,CAAC,CAAC,EAAE;AAC3B,MAAM,aAAa,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC;AACzC,KAAK,MAAM;AACX,MAAM,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC;AAC/B;AACA,GAAG,CAAC;AACJ,EAAE,cAAc,CAAC,GAAG,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC;AACrE;AACA,SAAS,WAAW,GAAG;AACvB,EAAE,UAAU,CAAC,GAAG,CAAC,EAAE,CAAC;AACpB,EAAE,cAAc,CAAC,GAAG,CAAC,EAAE,CAAC;AACxB,EAAE,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC;AACf;AACK,MAAC,WAAW,GAAG;AACpB,EAAE,cAAc;AAChB,EAAE,UAAU;AACZ,EAAE,KAAK;AACP,EAAE,MAAM;AACR,EAAE,YAAY;AACd,EAAE;AACF;;;;"}