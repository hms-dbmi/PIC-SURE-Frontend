{"version":3,"file":"ConnectionForm-C9Og6LTI.js","sources":["../../../.svelte-kit/adapter-node/chunks/ConnectionForm.js"],"sourcesContent":["import { A as push, E as attr, I as attr_class, C as pop, G as stringify, O as store_get, N as ensure_array_like, P as unsubscribe_stores } from \"./index.js\";\nimport \"./client2.js\";\nimport \"./Connections.js\";\nimport { c as isTopAdmin } from \"./User.js\";\nimport { p as parseFieldsFromJSON } from \"./Connection.js\";\nimport { E as ErrorAlert } from \"./ErrorAlert.js\";\nfunction RequiredFieldRow($$payload, $$props) {\n  push();\n  let {\n    field = { label: \"\", id: \"\" },\n    duplicate = false,\n    onsave = () => {\n    },\n    ondelete = () => {\n    }\n  } = $$props;\n  let label = field.label;\n  let id = field.id;\n  let dirtyForm = field.id !== id || field.label !== label;\n  const newField = field.label === \"\" || field.id === \"\";\n  let edit = newField;\n  $$payload.out += `<div class=\"flex gap-4 p-3 odd:bg-surface-100-900 even:bg-surface-50-950\"${attr(\"data-testid\", `required-field-row-${field.id ? field.id : \"new\"}`)}><label class=\"label flex-1\"><span>Label:</span> <input type=\"text\"${attr(\"value\", label)}${attr(\"disabled\", !edit, true)} class=\"input\" minlength=\"1\" maxlength=\"255\"/></label> <label class=\"label flex-1\"><span>ID:</span> <input type=\"text\"${attr(\"value\", id)}${attr(\"disabled\", !edit, true)}${attr_class(`input ${stringify(duplicate && \"preset-tonal-warning border border-warning-500 border-warning-600-400 focus:border-warning-800-200\")}`)} minlength=\"1\" maxlength=\"255\"/></label> <div class=\"flex-none content-end py-2\">`;\n  if (edit) {\n    $$payload.out += \"<!--[-->\";\n    $$payload.out += `<button type=\"button\" title=\"Save\" data-testid=\"required-field-save-btn\" class=\"btn-icon-color\"${attr(\"disabled\", !label || !id || !dirtyForm, true)}><i class=\"fa-solid fa-floppy-disk fa-xl\"></i> <span class=\"sr-only\">Save</span></button> `;\n    if (dirtyForm) {\n      $$payload.out += \"<!--[-->\";\n      $$payload.out += `<button type=\"button\" title=\"Reset and cancel\" class=\"btn-icon-color\" data-testid=\"required-field-reset-btn\"><i class=\"fa-solid fa-arrow-rotate-right fa-xl\"></i> <span class=\"sr-only\">Reset and cancel</span></button>`;\n    } else if (!newField && !dirtyForm) {\n      $$payload.out += \"<!--[1-->\";\n      $$payload.out += `<button type=\"button\" title=\"Cancel\" class=\"btn-icon-color\" data-testid=\"required-field-cancel-btn\"><i class=\"fa-solid fa-ban fa-xl\"></i> <span class=\"sr-only\">Cancel</span></button>`;\n    } else {\n      $$payload.out += \"<!--[!-->\";\n    }\n    $$payload.out += `<!--]-->`;\n  } else {\n    $$payload.out += \"<!--[!-->\";\n    $$payload.out += `<button type=\"button\" title=\"Edit\" class=\"btn-icon-color\" data-testid=\"required-field-edit-btn\"><i class=\"fa-solid fa-pen fa-xl\"></i> <span class=\"sr-only\">Edit</span></button>`;\n  }\n  $$payload.out += `<!--]--> <button type=\"button\" title=\"Delete\" class=\"btn-icon-color\" data-testid=\"required-field-delete-btn\"><i class=\"fa-solid fa-trash fa-xl\"></i> <span class=\"sr-only\">Delete</span></button></div></div>`;\n  pop();\n}\nfunction RequiredFieldsList($$payload, $$props) {\n  push();\n  var $$store_subs;\n  let { fields = \"[]\", onupdate = () => {\n  } } = $$props;\n  let fieldList = parseFieldsFromJSON(fields);\n  let enableNewField = fieldList.length === 0 || !store_get($$store_subs ??= {}, \"$isTopAdmin\", isTopAdmin);\n  let duplicates = fieldList.filter((checkField) => {\n    return fieldList.filter((field) => field !== checkField).filter((field) => field.id === checkField.id).length > 0;\n  });\n  function hasDuplicate(checkField) {\n    return !!duplicates.find((field) => field === checkField);\n  }\n  function updateFields(fields2) {\n    onupdate(JSON.stringify(fields2));\n  }\n  function saveField(previous, current) {\n    const newFields = [...fieldList];\n    if (previous.label === \"\" || previous.id === \"\") {\n      newFields.push(current);\n      enableNewField = false;\n    } else {\n      const fieldIndex = newFields.findIndex((f) => f.label === previous.label && f.id === previous.id);\n      if (fieldIndex > -1) {\n        newFields[fieldIndex] = current;\n      }\n    }\n    updateFields(newFields);\n  }\n  function deleteField(field) {\n    const newFields = fieldList.filter((f) => f.label !== field.label || f.id !== field.id);\n    updateFields(newFields);\n  }\n  const each_array = ensure_array_like(fieldList);\n  $$payload.out += `<fieldset class=\"border border-surface-300-700\"><legend class=\"px-2 ml-2\">Required Fields: <button type=\"button\" class=\"text-primary-700-300 hover:text-secondary-700-300\" aria-label=\"Add New Field\" title=\"Add New Field\" data-testid=\"required-field-new-btn\"${attr(\"disabled\", enableNewField, true)}><i${attr_class(`fa-solid fa-square-plus fa-xl ${stringify(enableNewField ? \"opacity-50\" : \"\")}`)}></i></button></legend> `;\n  if (enableNewField) {\n    $$payload.out += \"<!--[-->\";\n    RequiredFieldRow($$payload, {\n      onsave: saveField,\n      ondelete: () => enableNewField = false\n    });\n  } else {\n    $$payload.out += \"<!--[!-->\";\n  }\n  $$payload.out += `<!--]--> <!--[-->`;\n  for (let index = 0, $$length = each_array.length; index < $$length; index++) {\n    let field = each_array[index];\n    RequiredFieldRow($$payload, {\n      duplicate: hasDuplicate(field),\n      field,\n      onsave: saveField,\n      ondelete: deleteField\n    });\n  }\n  $$payload.out += `<!--]--> `;\n  if (duplicates.length > 0) {\n    $$payload.out += \"<!--[-->\";\n    ErrorAlert($$payload, {\n      \"data-testid\": \"validation-warn\",\n      color: \"warning\",\n      children: ($$payload2) => {\n        $$payload2.out += `<!---->Fields with the same ID may not function properly.`;\n      }\n    });\n  } else {\n    $$payload.out += \"<!--[!-->\";\n  }\n  $$payload.out += `<!--]--></fieldset>`;\n  if ($$store_subs) unsubscribe_stores($$store_subs);\n  pop();\n}\nfunction ConnectionForm($$payload, $$props) {\n  push();\n  var $$store_subs;\n  let { connection = void 0 } = $$props;\n  let label = connection?.label || \"\";\n  let id = connection?.id || \"\";\n  let subPrefix = connection?.subPrefix || \"\";\n  let requiredFields = connection?.requiredFields || \"[]\";\n  function updateRequiredFields(json) {\n    requiredFields = json;\n  }\n  $$payload.out += `<p class=\"mb-3 text-center\">For details on how to set up a Connection, please refer to the <a href=\"https://pic-sure.gitbook.io/pic-sure-developer-guide/configuring-pic-sure/all-in-one-authentication-configuration#additional-authentication-configuration-option-s\" target=\"_blank\" class=\"anchor\">PIC-SURE developer guide</a>.</p> <form><fieldset data-testid=\"connection-form\" class=\"grid gap-4 my-3\"${attr(\"disabled\", !store_get($$store_subs ??= {}, \"$isTopAdmin\", isTopAdmin), true)}>`;\n  if (connection?.uuid) {\n    $$payload.out += \"<!--[-->\";\n    $$payload.out += `<label class=\"label\"><span>UUID:</span> <input type=\"text\" class=\"input\"${attr(\"value\", connection?.uuid)}${attr(\"readonly\", true, true)}/></label>`;\n  } else {\n    $$payload.out += \"<!--[!-->\";\n  }\n  $$payload.out += `<!--]--> <label class=\"label required\"><span>Label:</span> <input type=\"text\"${attr(\"value\", label)} class=\"input\" required minlength=\"1\" maxlength=\"255\"/></label> <label class=\"label required\"><span>ID:</span> <input type=\"text\"${attr(\"value\", id)} class=\"input\" required minlength=\"1\" maxlength=\"255\"/></label> <label class=\"label required\"><span>Sub Prefix:</span> <input type=\"text\"${attr(\"value\", subPrefix)} class=\"input\" required minlength=\"1\" maxlength=\"255\"/></label> `;\n  RequiredFieldsList($$payload, {\n    fields: requiredFields,\n    onupdate: updateRequiredFields\n  });\n  $$payload.out += `<!----> <div class=\"mt-2\"><button type=\"submit\" data-testid=\"connection-save-btn\" class=\"btn preset-tonal-primary border border-primary-500 hover:preset-filled-primary-500\">Save</button> <a href=\"/admin/configuration\" data-testid=\"connection-cancel-btn\" class=\"btn preset-tonal-secondary border border-secondary-500 hover:preset-filled-secondary-500\">Cancel</a></div></fieldset></form>`;\n  if ($$store_subs) unsubscribe_stores($$store_subs);\n  pop();\n}\nexport {\n  ConnectionForm as C\n};\n"],"names":[],"mappings":"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"}