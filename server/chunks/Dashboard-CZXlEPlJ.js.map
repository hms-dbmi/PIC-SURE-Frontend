{"version":3,"file":"Dashboard-CZXlEPlJ.js","sources":["../../../.svelte-kit/adapter-node/chunks/Dashboard.js"],"sourcesContent":["import { w as writable, j as get } from \"./exports.js\";\nimport { g as get$1, e as Picsure, a as user } from \"./User.js\";\nimport \"./configuration.js\";\nconst open = writable(false);\nconst columns = writable([]);\nconst rows = writable([]);\nconst activeRow = writable({});\nfunction fetchDashboard() {\n  return get$1(Picsure.Dashboard);\n}\nasync function loadDashboardData() {\n  const dashboardData = await fetchDashboard();\n  columns.set(dashboardData.columns);\n  get(user);\n  let consents = [];\n  const processedRows = dashboardData.rows.map(processRow(consents));\n  const sortedRows = processedRows.sort((a, b) => {\n    const aIsAnvil = (a.program_name?.toString().toLowerCase() || \"\") === \"anvil\";\n    const bIsAnvil = (b.program_name?.toString().toLowerCase() || \"\") === \"anvil\";\n    if (aIsAnvil !== bIsAnvil) {\n      return aIsAnvil ? 1 : -1;\n    }\n    if (a.consentGranted === b.consentGranted) {\n      return sortByAbbreviation(a, b);\n    }\n    return a.consentGranted ? -1 : 1;\n  });\n  rows.set(sortedRows);\n}\nfunction processRow(consents) {\n  return (row) => {\n    if (!row.accession) {\n      return { ...row, consentGranted: false };\n    }\n    const accession = row.accession.toString();\n    const accessionRegex = /^phs\\d+\\.v\\d+\\.p\\d+\\.c\\d+$/;\n    if (accessionRegex.test(accession)) {\n      const accessionBase = accession.replace(/\\.v\\d+\\.p\\d+/, \"\");\n      return { ...row, consentGranted: consents.includes(accessionBase) };\n    }\n    return { ...row, consentGranted: consents.includes(accession) };\n  };\n}\nfunction sortByAbbreviation(a, b) {\n  const aAbbr = a.abbreviation?.toString() || \"\";\n  const bAbbr = b.abbreviation?.toString() || \"\";\n  return aAbbr.localeCompare(bAbbr);\n}\nexport {\n  activeRow as a,\n  loadDashboardData as l,\n  open as o\n};\n"],"names":[],"mappings":";;;;AAGK,MAAC,IAAI,GAAG,QAAQ,CAAC,KAAK;AAC3B,MAAM,OAAO,GAAG,QAAQ,CAAC,EAAE,CAAC;AAC5B,MAAM,IAAI,GAAG,QAAQ,CAAC,EAAE,CAAC;AACpB,MAAC,SAAS,GAAG,QAAQ,CAAC,EAAE;AAC7B,SAAS,cAAc,GAAG;AAC1B,EAAE,OAAO,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC;AACjC;AACA,eAAe,iBAAiB,GAAG;AACnC,EAAE,MAAM,aAAa,GAAG,MAAM,cAAc,EAAE;AAC9C,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,OAAO,CAAC;AACpC,EAAE,GAAG,CAAC,IAAI,CAAC;AACX,EAAE,IAAI,QAAQ,GAAG,EAAE;AACnB,EAAE,MAAM,aAAa,GAAG,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;AACpE,EAAE,MAAM,UAAU,GAAG,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK;AAClD,IAAI,MAAM,QAAQ,GAAG,CAAC,CAAC,CAAC,YAAY,EAAE,QAAQ,EAAE,CAAC,WAAW,EAAE,IAAI,EAAE,MAAM,OAAO;AACjF,IAAI,MAAM,QAAQ,GAAG,CAAC,CAAC,CAAC,YAAY,EAAE,QAAQ,EAAE,CAAC,WAAW,EAAE,IAAI,EAAE,MAAM,OAAO;AACjF,IAAI,IAAI,QAAQ,KAAK,QAAQ,EAAE;AAC/B,MAAM,OAAO,QAAQ,GAAG,CAAC,GAAG,EAAE;AAC9B;AACA,IAAI,IAAI,CAAC,CAAC,cAAc,KAAK,CAAC,CAAC,cAAc,EAAE;AAC/C,MAAM,OAAO,kBAAkB,CAAC,CAAC,EAAE,CAAC,CAAC;AACrC;AACA,IAAI,OAAO,CAAC,CAAC,cAAc,GAAG,EAAE,GAAG,CAAC;AACpC,GAAG,CAAC;AACJ,EAAE,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC;AACtB;AACA,SAAS,UAAU,CAAC,QAAQ,EAAE;AAC9B,EAAE,OAAO,CAAC,GAAG,KAAK;AAClB,IAAI,IAAI,CAAC,GAAG,CAAC,SAAS,EAAE;AACxB,MAAM,OAAO,EAAE,GAAG,GAAG,EAAE,cAAc,EAAE,KAAK,EAAE;AAC9C;AACA,IAAI,MAAM,SAAS,GAAG,GAAG,CAAC,SAAS,CAAC,QAAQ,EAAE;AAC9C,IAAI,MAAM,cAAc,GAAG,4BAA4B;AACvD,IAAI,IAAI,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;AACxC,MAAM,MAAM,aAAa,GAAG,SAAS,CAAC,OAAO,CAAC,cAAc,EAAE,EAAE,CAAC;AACjE,MAAM,OAAO,EAAE,GAAG,GAAG,EAAE,cAAc,EAAE,QAAQ,CAAC,QAAQ,CAAC,aAAa,CAAC,EAAE;AACzE;AACA,IAAI,OAAO,EAAE,GAAG,GAAG,EAAE,cAAc,EAAE,QAAQ,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;AACnE,GAAG;AACH;AACA,SAAS,kBAAkB,CAAC,CAAC,EAAE,CAAC,EAAE;AAClC,EAAE,MAAM,KAAK,GAAG,CAAC,CAAC,YAAY,EAAE,QAAQ,EAAE,IAAI,EAAE;AAChD,EAAE,MAAM,KAAK,GAAG,CAAC,CAAC,YAAY,EAAE,QAAQ,EAAE,IAAI,EAAE;AAChD,EAAE,OAAO,KAAK,CAAC,aAAa,CAAC,KAAK,CAAC;AACnC;;;;"}