{"version":3,"file":"Roles-CHsR1lsS.js","sources":["../../../.svelte-kit/adapter-node/chunks/Roles.js"],"sourcesContent":["import { i as derived, w as writable, j as get } from \"./exports.js\";\nimport { g as get$1, d as del } from \"./User.js\";\nfunction mapRole(data) {\n  return {\n    ...data,\n    privileges: data.privileges ? data.privileges.map((p) => p.uuid) : []\n  };\n}\nconst ROLE_PATH = \"psama/role\";\nconst loaded = writable(false);\nconst roles = writable([]);\nconst roleList = derived(roles, ($r) => $r.map((r) => [r.name, r.uuid || \"\"]), []);\nasync function loadRoles() {\n  if (get(loaded)) return;\n  const res = await get$1(ROLE_PATH);\n  roles.set(res.map(mapRole));\n  loaded.set(true);\n}\nasync function getRole(uuid) {\n  const store = get(roles);\n  const role = store.find((r) => r.uuid === uuid);\n  if (role) {\n    return role;\n  }\n  const res = await get$1(`${ROLE_PATH}/${uuid}`);\n  return mapRole(res);\n}\nasync function deleteRole(uuid) {\n  await del(`${ROLE_PATH}/${uuid}`);\n  const store = get(roles);\n  const roleIndex = store.findIndex((r) => r.uuid === uuid);\n  if (roleIndex > -1) {\n    store.splice(roleIndex, 1);\n    roles.set(store);\n  }\n}\nconst RoleStore = {\n  subscribe: roles.subscribe,\n  roles,\n  roleList,\n  loadRoles,\n  getRole\n};\nexport {\n  RoleStore as R,\n  deleteRole as d,\n  getRole as g,\n  loadRoles as l,\n  roles as r\n};\n"],"names":[],"mappings":";;;AAEA,SAAS,OAAO,CAAC,IAAI,EAAE;AACvB,EAAE,OAAO;AACT,IAAI,GAAG,IAAI;AACX,IAAI,UAAU,EAAE,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,GAAG;AACvE,GAAG;AACH;AACA,MAAM,SAAS,GAAG,YAAY;AAC9B,MAAM,MAAM,GAAG,QAAQ,CAAC,KAAK,CAAC;AACzB,MAAC,KAAK,GAAG,QAAQ,CAAC,EAAE;AACzB,MAAM,QAAQ,GAAG,OAAO,CAAC,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC;AAClF,eAAe,SAAS,GAAG;AAC3B,EAAE,IAAI,GAAG,CAAC,MAAM,CAAC,EAAE;AACnB,EAAE,MAAM,GAAG,GAAG,MAAM,KAAK,CAAC,SAAS,CAAC;AACpC,EAAE,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;AAC7B,EAAE,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC;AAClB;AACA,eAAe,OAAO,CAAC,IAAI,EAAE;AAC7B,EAAE,MAAM,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC;AAC1B,EAAE,MAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC;AACjD,EAAE,IAAI,IAAI,EAAE;AACZ,IAAI,OAAO,IAAI;AACf;AACA,EAAE,MAAM,GAAG,GAAG,MAAM,KAAK,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC;AACjD,EAAE,OAAO,OAAO,CAAC,GAAG,CAAC;AACrB;AACA,eAAe,UAAU,CAAC,IAAI,EAAE;AAChC,EAAE,MAAM,GAAG,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC;AACnC,EAAE,MAAM,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC;AAC1B,EAAE,MAAM,SAAS,GAAG,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC;AAC3D,EAAE,IAAI,SAAS,GAAG,EAAE,EAAE;AACtB,IAAI,KAAK,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,CAAC;AAC9B,IAAI,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC;AACpB;AACA;AACK,MAAC,SAAS,GAAG;AAClB,EAAE,SAAS,EAAE,KAAK,CAAC,SAAS;AAC5B,EAAE,KAAK;AACP,EAAE,QAAQ;AACV,EAAE,SAAS;AACX,EAAE;AACF;;;;"}