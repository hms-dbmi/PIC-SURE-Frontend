{"version":3,"file":"_page.svelte-DdbSQC4o.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/(picsure)/(authorized)/explorer/cohort/_page.svelte.js"],"sourcesContent":["import { A as push, O as store_get, W as head, F as escape_html, S as await_block, P as unsubscribe_stores, C as pop, N as ensure_array_like, I as attr_class, J as clsx, G as stringify, T as store_set } from \"../../../../../../chunks/index.js\";\nimport { o as onDestroy, L as Loading } from \"../../../../../../chunks/Loading.js\";\nimport { b as branding } from \"../../../../../../chunks/configuration.js\";\nimport { S as StatPromise, c as countResult, g as getStatFields } from \"../../../../../../chunks/StatBuilder.js\";\nimport { r as resultCounts } from \"../../../../../../chunks/ResultStore.js\";\nimport { p as panelOpen } from \"../../../../../../chunks/SidePanel.js\";\nimport { q as loading } from \"../../../../../../chunks/User.js\";\nimport { C as Content } from \"../../../../../../chunks/Content.js\";\nfunction _page($$payload, $$props) {\n  push();\n  var $$store_subs;\n  const NO_DATA = \"-\";\n  const styles = {\n    center: \"!text-center\",\n    left: \"!text-left\",\n    stat: \"font-bold\",\n    field: \"\"\n  };\n  let resources = [];\n  let columns = [\n    { style: styles.left, value: \"Details\" },\n    { style: styles.center, value: \"Total\" },\n    ...resources.map((value) => ({ style: styles.center, value }))\n  ];\n  let rows = resources.length > 0 ? setTableData(store_get($$store_subs ??= {}, \"$resultCounts\", resultCounts), resources) : [];\n  function setTableData(stats, resourceNames) {\n    let rows2 = [];\n    stats.forEach((stat) => {\n      const statTotal = Promise.allSettled(StatPromise.list(stat)).then((results) => countResult(results.map(StatPromise.valueOrZero)));\n      const resourceTotals = resourceNames.map((resource) => stat.result[resource].then((count) => countResult([count])));\n      rows2.push({\n        style: styles.stat,\n        values: [stat.label, statTotal, ...resourceTotals]\n      });\n      getStatFields(stat.key).forEach((field) => {\n        const fieldCount = (stat2) => {\n          const count = typeof stat2 === \"object\" ? stat2[field.conceptPath] || NO_DATA : stat2;\n          return `${count}` === \"-1\" ? NO_DATA : count;\n        };\n        const fieldTotal = Promise.allSettled(StatPromise.list(stat)).then((results) => countResult(results.map(StatPromise.valueOrZero).map(fieldCount)));\n        const fieldTotals = resourceNames.map((resource) => stat.result[resource].then(fieldCount));\n        rows2.push({\n          style: styles.field,\n          values: [field.label, fieldTotal, ...fieldTotals]\n        });\n      });\n    });\n    return rows2;\n  }\n  onDestroy(() => {\n    store_set(panelOpen, true);\n  });\n  head($$payload, ($$payload2) => {\n    $$payload2.title = `<title>${escape_html(branding.applicationName)} | Cohort Details</title>`;\n  });\n  Content($$payload, {\n    full: true,\n    backUrl: \"/explorer\",\n    backTitle: \"Back to Cohort Builder\",\n    title: \"Cohort Details\",\n    children: ($$payload2) => {\n      $$payload2.out += `<p class=\"text-center\">${escape_html(branding.results.cohortDescription || \"Distribution of total patient counts across networked institutions.\")}</p> `;\n      await_block(\n        $$payload2,\n        store_get($$store_subs ??= {}, \"$resourcesPromise\", loading),\n        () => {\n          Loading($$payload2, { ring: true, size: \"large\" });\n        },\n        () => {\n          const each_array = ensure_array_like(columns);\n          const each_array_1 = ensure_array_like(rows);\n          $$payload2.out += `<div class=\"table-wrap\"><table class=\"table caption-bottom\"><thead><tr><!--[-->`;\n          for (let $$index = 0, $$length = each_array.length; $$index < $$length; $$index++) {\n            let column = each_array[$$index];\n            $$payload2.out += `<th${attr_class(clsx(column.style))}>${escape_html(column.value)}</th>`;\n          }\n          $$payload2.out += `<!--]--></tr></thead><tbody><!--[-->`;\n          for (let $$index_2 = 0, $$length = each_array_1.length; $$index_2 < $$length; $$index_2++) {\n            let row = each_array_1[$$index_2];\n            const each_array_2 = ensure_array_like(row.values);\n            $$payload2.out += `<tr><!--[-->`;\n            for (let index = 0, $$length2 = each_array_2.length; index < $$length2; index++) {\n              let rowColumn = each_array_2[index];\n              $$payload2.out += `<td${attr_class(`${stringify(columns[index].style)} ${stringify(row.style)}`)}>`;\n              await_block(\n                $$payload2,\n                rowColumn,\n                () => {\n                  Loading($$payload2, { ring: true, size: \"micro\" });\n                },\n                (rowValue) => {\n                  $$payload2.out += `${escape_html(rowValue)}`;\n                }\n              );\n              $$payload2.out += `<!--]--></td>`;\n            }\n            $$payload2.out += `<!--]--></tr>`;\n          }\n          $$payload2.out += `<!--]--></tbody></table></div> <ul id=\"cohort-key\" class=\"w-full flex text-center py-3\"><li class=\"flex-auto\">\"0\" = Site returned zero results</li> <li class=\"flex-auto\">\"-\" = No data for that site</li> <li class=\"flex-auto\"><i class=\"fa-solid fa-circle-xmark text-error-500\"></i> = Site did not return results</li></ul>`;\n        }\n      );\n      $$payload2.out += `<!--]-->`;\n    }\n  });\n  if ($$store_subs) unsubscribe_stores($$store_subs);\n  pop();\n}\nexport {\n  _page as default\n};\n"],"names":[],"mappings":"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"}