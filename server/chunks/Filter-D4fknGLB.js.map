{"version":3,"file":"Filter-D4fknGLB.js","sources":["../../../.svelte-kit/adapter-node/chunks/Filter.js"],"sourcesContent":["import { j as derived, w as writable, i as get } from \"./exports.js\";\nimport { d as user } from \"./User.js\";\nimport * as uuid from \"uuid\";\nuuid.v4();\nfunction genericUUID() {\n  return uuid.v4();\n}\nconst filters = writable(restoreFilters());\nconst hasGenomicFilter = derived(\n  filters,\n  ($f) => $f && $f.length > 0 ? $f.some((filter) => filter.filterType === \"genomic\") : false\n);\nderived(\n  filters,\n  ($f) => $f && $f.length > 0 ? $f.some((filter) => !filter.allowFiltering) : false\n);\nderived([user, filters], ([$user, $filters]) => {\n  if ($filters.length === 0 || !$user?.queryScopes) return false;\n  return $filters.some((filter) => {\n    let filterDataset = filter.dataset || \"\";\n    if (filter.filterType === \"genomic\" || filter.filterType === \"snp\") {\n      filterDataset = \"Gene_with_variant\";\n    }\n    const isValidFilter = $user?.queryScopes?.some((scope) => {\n      const isMatch = filterDataset.length > 0 && scope.includes(filterDataset);\n      return isMatch;\n    });\n    return !isValidFilter;\n  });\n});\nconst filterWarning = writable();\nfilters.subscribe((f) => {\n});\nfunction restoreFilters() {\n  return [];\n}\nfunction removeGenomicFilters() {\n  const currentFilters = get(filters);\n  filters.set(currentFilters.filter((f) => f.filterType !== \"genomic\"));\n}\nfunction removeUnallowedFilters() {\n  const currentFilters = get(filters);\n  filters.set(currentFilters.filter((f) => f.allowFiltering));\n}\nfunction removeInvalidFilters() {\n  const currentUser = get(user);\n  const currentFilters = get(filters);\n  if (!currentUser || currentFilters.length === 0) return;\n  const validFilters = currentFilters.filter((filter) => {\n    let filterDataset = filter.dataset || \"\";\n    if (filter.filterType === \"genomic\" || filter.filterType === \"snp\") {\n      filterDataset = \"Gene_with_variant\";\n    }\n    const isValidFilter = currentUser.queryScopes?.some((scope) => {\n      const isMatch = filterDataset.length > 0 && scope.includes(filterDataset);\n      return isMatch;\n    });\n    return isValidFilter;\n  });\n  filters.set(validFilters);\n}\nfunction clearFilters() {\n  filters.set([]);\n}\nfunction getFiltersByType(type) {\n  return get(filters).filter((f) => f.filterType === type);\n}\nexport {\n  filterWarning as a,\n  removeGenomicFilters as b,\n  clearFilters as c,\n  removeUnallowedFilters as d,\n  getFiltersByType as e,\n  filters as f,\n  genericUUID as g,\n  hasGenomicFilter as h,\n  removeInvalidFilters as r\n};\n"],"names":[],"mappings":"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"}