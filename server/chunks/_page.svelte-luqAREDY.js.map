{"version":3,"file":"_page.svelte-luqAREDY.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/(picsure)/_page.svelte.js"],"sourcesContent":["import { c as create_ssr_component, f as each, e as escape, v as validate_component, a as add_attribute } from \"../../../chunks/ssr.js\";\nimport { b as branding, r as resources } from \"../../../chunks/configuration.js\";\nimport { g as goto } from \"../../../chunks/client.js\";\nimport { S as Searchbox } from \"../../../chunks/Searchbox.js\";\nimport { i as is_promise, d as noop } from \"../../../chunks/lifecycle.js\";\nimport { p as post } from \"../../../chunks/User.js\";\nimport \"../../../chunks/ProgressBar.svelte_svelte_type_style_lang.js\";\nimport { P as ProgressRadial } from \"../../../chunks/ProgressRadial.js\";\nimport { g as getBlankQueryRequest } from \"../../../chunks/QueryBuilder.js\";\nimport { g as getStudiesCount, a as getConceptCount } from \"../../../chunks/dictionary.js\";\nconst css = {\n  code: \".stats.svelte-1crd580{font-size:1rem;padding:1rem}.stats.svelte-1crd580{background-color:rgb(var(--color-surface-300))}\",\n  map: `{\"version\":3,\"file\":\"Stats.svelte\",\"sources\":[\"Stats.svelte\"],\"sourcesContent\":[\"<script lang=\\\\\"ts\\\\\">import * as api from \\\\\"$lib/api\\\\\";\\\\nimport { ProgressRadial } from \\\\\"@skeletonlabs/skeleton\\\\\";\\\\nimport { branding, resources } from \\\\\"$lib/configuration\\\\\";\\\\nimport { browser } from \\\\\"$app/environment\\\\\";\\\\nimport { getBlankQueryRequest } from \\\\\"$lib/QueryBuilder\\\\\";\\\\nimport { getStudiesCount, getConceptCount } from \\\\\"$lib/services/dictionary\\\\\";\\\\nconst ERROR_VALUE = \\\\\"-\\\\\";\\\\nconst isUserLoggedIn = () => {\\\\n  if (browser) {\\\\n    return !!localStorage.getItem(\\\\\"token\\\\\");\\\\n  }\\\\n  return false;\\\\n};\\\\nconst apiMap = {\\\\n  \\\\\"Data Sources\\\\\": () => getStudiesCount(!isUserLoggedIn()).then((response) => {\\\\n    if (response) {\\\\n      return response.toLocaleString();\\\\n    }\\\\n    hasError = true;\\\\n    return ERROR_VALUE;\\\\n  }),\\\\n  Participants: () => api.post(\\\\\"picsure/query/sync\\\\\", getBlankQueryRequest(isUserLoggedIn(), isUserLoggedIn() ? resources.hpds : resources.openHPDS)).then((response) => {\\\\n    if (response) {\\\\n      return response.toLocaleString();\\\\n    }\\\\n    hasError = true;\\\\n    return ERROR_VALUE;\\\\n  }),\\\\n  Variables: () => getConceptCount(!isUserLoggedIn()).then((response) => {\\\\n    if (response) {\\\\n      return response.toLocaleString();\\\\n    }\\\\n    hasError = true;\\\\n    return ERROR_VALUE;\\\\n  })\\\\n};\\\\nasync function getOrApi(key) {\\\\n  return apiMap[key]();\\\\n}\\\\nlet width = branding?.landing?.stats.length;\\\\nlet hasError = false;\\\\nlet statMap = /* @__PURE__ */ new Map();\\\\nbranding?.landing?.stats?.forEach((stat) => {\\\\n  statMap.set(stat, getOrApi(stat));\\\\n});\\\\nlet promises = statMap.values();\\\\nPromise.allSettled(Array.from(promises)).then((results) => {\\\\n  results.forEach((result) => {\\\\n    if (result.status === \\\\\"rejected\\\\\") {\\\\n      hasError = true;\\\\n    }\\\\n  });\\\\n});\\\\n<\\/script>\\\\n\\\\n<section class=\\\\\"stats flex flex-col items-center w-full mt-auto p-4\\\\\">\\\\n  <h2 class=\\\\\"m-4\\\\\">Data Summary</h2>\\\\n  <div class=\\\\\"flex flex-wrap justify-evenlyp-4 my-4 gap-y-9 w-1/2\\\\\">\\\\n    {#each Array.from(statMap) as [key, value] (key)}\\\\n      <div\\\\n        class=\\\\\"flex flex-col w-1/{width} p-4 [&:not(:last-child)]:border-r border-surface-400-500-token\\\\\"\\\\n      >\\\\n        <div data-testid=\\\\\"value-{key}\\\\\" class=\\\\\"flex flex-col justify-center items-center text-2xl\\\\\">\\\\n          {#await value}\\\\n            <ProgressRadial\\\\n              width=\\\\\"w-10\\\\\"\\\\n              meter=\\\\\"stroke-surface-50 dark:stroke-surface-900\\\\\"\\\\n              track=\\\\\"stroke-secondary-500/30\\\\\"\\\\n              value={undefined}\\\\n            />\\\\n          {:then statValue}\\\\n            <strong class=\\\\\"p-1 mb-3\\\\\">{statValue}</strong>\\\\n          {:catch}\\\\n            <i class=\\\\\"fa-solid fa-circle-exclamation p-1 mb-4 mt-1\\\\\"></i>\\\\n          {/await}\\\\n        </div>\\\\n        <p>{key}</p>\\\\n      </div>\\\\n    {/each}\\\\n  </div>\\\\n  <div class=\\\\\"w-2/4 p-8\\\\\">\\\\n    {@html isUserLoggedIn() ? branding?.landing?.authExplanation : branding?.landing?.explanation}\\\\n  </div>\\\\n  {#if hasError}\\\\n    <div\\\\n      id=\\\\\"landing-errors\\\\\"\\\\n      class=\\\\\"alert variant-filled-error text-error-50-900-token 200-700-token w-3/4 px-4 mb-6 mt-2\\\\\"\\\\n    >\\\\n      <div><i class=\\\\\"fa-solid fa-circle-exclamation text-4xl\\\\\"></i></div>\\\\n      <div class=\\\\\"alert-message\\\\\">\\\\n        <p>We're having trouble fetching some data points right now. Please try again later.</p>\\\\n      </div>\\\\n    </div>\\\\n  {/if}\\\\n</section>\\\\n\\\\n<style lang=\\\\\"postcss\\\\\">\\\\n  .stats {\\\\n    font-size: 1rem;\\\\n    padding: 1rem;\\\\n  }\\\\n  .dark .stats {\\\\n    background-color: rgb(var(--color-surface-600));\\\\n}\\\\n  .stats {\\\\n    background-color: rgb(var(--color-surface-300));\\\\n}\\\\n  .dark .stats {\\\\n    background-color: rgb(var(--color-surface-600));\\\\n}\\\\n  .stats a {\\\\n    text-decoration: underline;\\\\n  }</style>\\\\n\"],\"names\":[],\"mappings\":\"AAiGE,qBAAO,CACL,SAAS,CAAE,IAAI,CACf,OAAO,CAAE,IACX,CAIA,qBAAO,CACL,gBAAgB,CAAE,IAAI,IAAI,mBAAmB,CAAC,CAClD\"}`\n};\nconst ERROR_VALUE = \"-\";\nconst Stats = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  const isUserLoggedIn = () => {\n    return false;\n  };\n  const apiMap = {\n    \"Data Sources\": () => getStudiesCount(!isUserLoggedIn()).then((response) => {\n      if (response) {\n        return response.toLocaleString();\n      }\n      hasError = true;\n      return ERROR_VALUE;\n    }),\n    Participants: () => post(\"picsure/query/sync\", getBlankQueryRequest(isUserLoggedIn(), isUserLoggedIn() ? resources.hpds : resources.openHPDS)).then((response) => {\n      if (response) {\n        return response.toLocaleString();\n      }\n      hasError = true;\n      return ERROR_VALUE;\n    }),\n    Variables: () => getConceptCount(!isUserLoggedIn()).then((response) => {\n      if (response) {\n        return response.toLocaleString();\n      }\n      hasError = true;\n      return ERROR_VALUE;\n    })\n  };\n  async function getOrApi(key) {\n    return apiMap[key]();\n  }\n  let width = branding?.landing?.stats.length;\n  let hasError = false;\n  let statMap = /* @__PURE__ */ new Map();\n  branding?.landing?.stats?.forEach((stat) => {\n    statMap.set(stat, getOrApi(stat));\n  });\n  let promises = statMap.values();\n  Promise.allSettled(Array.from(promises)).then((results) => {\n    results.forEach((result) => {\n      if (result.status === \"rejected\") {\n        hasError = true;\n      }\n    });\n  });\n  $$result.css.add(css);\n  return `<section class=\"stats flex flex-col items-center w-full mt-auto p-4 svelte-1crd580\"><h2 class=\"m-4\" data-svelte-h=\"svelte-c8j8ir\">Data Summary</h2> <div class=\"flex flex-wrap justify-evenlyp-4 my-4 gap-y-9 w-1/2\">${each(Array.from(statMap), ([key, value]) => {\n    return `<div class=\"${\"flex flex-col w-1/\" + escape(width, true) + \" p-4 [&amp;:not(:last-child)]:border-r border-surface-400-500-token svelte-1crd580\"}\"><div data-testid=\"${\"value-\" + escape(key, true)}\" class=\"flex flex-col justify-center items-center text-2xl\">${function(__value) {\n      if (is_promise(__value)) {\n        __value.then(null, noop);\n        return ` ${validate_component(ProgressRadial, \"ProgressRadial\").$$render(\n          $$result,\n          {\n            width: \"w-10\",\n            meter: \"stroke-surface-50 dark:stroke-surface-900\",\n            track: \"stroke-secondary-500/30\",\n            value: void 0\n          },\n          {},\n          {}\n        )} `;\n      }\n      return function(statValue) {\n        return ` <strong class=\"p-1 mb-3\">${escape(statValue)}</strong> `;\n      }(__value);\n    }(value)}</div> <p>${escape(key)}</p> </div>`;\n  })}</div> <div class=\"w-2/4 p-8\"><!-- HTML_TAG_START -->${isUserLoggedIn() ? branding?.landing?.authExplanation : branding?.landing?.explanation}<!-- HTML_TAG_END --></div> ${hasError ? `<div id=\"landing-errors\" class=\"alert variant-filled-error text-error-50-900-token 200-700-token w-3/4 px-4 mb-6 mt-2\" data-svelte-h=\"svelte-5wd9ib\"><div><i class=\"fa-solid fa-circle-exclamation text-4xl\"></i></div> <div class=\"alert-message\"><p>We&#39;re having trouble fetching some data points right now. Please try again later.</p></div></div>` : ``} </section>`;\n});\nconst Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let searchTerm = \"\";\n  const isUserLoggedIn = () => {\n    return false;\n  };\n  function search() {\n    isUserLoggedIn() ? goto() : goto();\n  }\n  const actionsToDisplay = branding?.landing?.actions.filter((action) => {\n    if (isUserLoggedIn()) {\n      return action.showIfLoggedIn;\n    } else {\n      return action.isOpen || !action.showIfLoggedIn;\n    }\n  });\n  let $$settled;\n  let $$rendered;\n  let previous_head = $$result.head;\n  do {\n    $$settled = true;\n    $$result.head = previous_head;\n    $$rendered = `${$$result.head += `<!-- HEAD_svelte-1uz9aip_START -->${$$result.title = `<title>${escape(branding.applicationName)}</title>`, \"\"}<!-- HEAD_svelte-1uz9aip_END -->`, \"\"} <div id=\"landing\" class=\"flex flex-wrap flex-col justify-evenly text-center items-center w-full h-full mt-8\"><section id=\"search-section\" class=\"flex flex-col text-center items-center my-4 mt-auto w-2/3\">${validate_component(Searchbox, \"Searchbox\").$$render(\n      $$result,\n      {\n        placeholder: branding?.landing?.searchPlaceholder,\n        search,\n        searchTerm\n      },\n      {\n        searchTerm: ($$value) => {\n          searchTerm = $$value;\n          $$settled = false;\n        }\n      },\n      {}\n    )}</section> <section id=\"actions-section\" class=\"flex flex-row justify-evenly items-center w-2/3 mt-auto mb-8\">${each(actionsToDisplay, ({ title, description, icon, url, btnText }) => {\n      return `<div class=\"${\"flex flex-col items-center w-1/\" + escape(actionsToDisplay?.length || 3, true)}\"><div class=\"text-3xl my-1\">${escape(title)}</div> <i class=\"${\"text-[5rem] my-3 text-secondary-500-400-token \" + escape(icon, true)}\"></i> <div class=\"subtitle my-3\">${escape(description)}</div> <a data-testid=\"${\"landing-action-\" + escape(title, true) + \"-btn\"}\"${add_attribute(\"href\", url, 0)} class=\"btn variant-filled-primary\">${escape(btnText)}</a> </div>`;\n    })}</section> ${validate_component(Stats, \"Stats\").$$render($$result, {}, {}, {})}</div>`;\n  } while (!$$settled);\n  return $$rendered;\n});\nexport {\n  Page as default\n};\n"],"names":[],"mappings":"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"}