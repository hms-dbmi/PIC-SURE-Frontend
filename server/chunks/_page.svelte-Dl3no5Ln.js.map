{"version":3,"file":"_page.svelte-Dl3no5Ln.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/(picsure)/(authorized)/(admin)/admin/users/_page.svelte.js"],"sourcesContent":["import { i as is_promise, d as noop, a as subscribe } from \"../../../../../../../chunks/lifecycle.js\";\nimport { c as create_ssr_component, a as add_attribute, e as escape, v as validate_component, f as each } from \"../../../../../../../chunks/ssr.js\";\nimport { r as readable, d as derived } from \"../../../../../../../chunks/index2.js\";\nimport \"../../../../../../../chunks/ProgressBar.svelte_svelte_type_style_lang.js\";\nimport { P as ProgressBar } from \"../../../../../../../chunks/ProgressBar.js\";\nimport { g as goto } from \"../../../../../../../chunks/client.js\";\nimport { b as branding } from \"../../../../../../../chunks/configuration.js\";\nimport { C as Content } from \"../../../../../../../chunks/Content.js\";\nimport { T as Table } from \"../../../../../../../chunks/Table.js\";\nimport { g as getModalStore } from \"../../../../../../../chunks/stores.js\";\nimport { g as getToastStore } from \"../../../../../../../chunks/stores2.js\";\nimport { U as UsersStore, C as ConnectionsStore } from \"../../../../../../../chunks/Connections.js\";\nimport { R as RoleStore } from \"../../../../../../../chunks/Roles.js\";\nimport \"../../../../../../../chunks/Privileges.js\";\nconst Actions = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  getModalStore();\n  getToastStore();\n  let { data = { cell: \"\", row: { status: \"\", email: \"\" } } } = $$props;\n  if ($$props.data === void 0 && $$bindings.data && data !== void 0) $$bindings.data(data);\n  return `<button${add_attribute(\"data-testid\", `user-view-btn-${data.cell}`, 0)} type=\"button\" title=\"View\" class=\"btn-icon-color\"><i class=\"fa-solid fa-circle-info fa-xl\"></i></button> ${data.row.status === \"Active\" ? `<button${add_attribute(\"data-testid\", `user-edit-btn-${data.cell}`, 0)} type=\"button\" title=\"Edit\" class=\"btn-icon-color\"><i class=\"fa-solid fa-pen-to-square fa-xl\"></i></button> <button${add_attribute(\"data-testid\", `user-deactivate-btn-${data.cell}`, 0)} type=\"button\" title=\"Deactivate user\" class=\"btn-icon-color\"><i class=\"fa-solid fa-trash fa-xl\"></i></button>` : `<button${add_attribute(\"data-testid\", `user-activate-btn-${data.cell}`, 0)} type=\"button\" title=\"Reactivate user\" class=\"btn-icon-color\"><i class=\"fa-solid fa-trash-arrow-up fa-xl\"></i></button>`}`;\n});\nconst Status = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let { data = { cell: \"\", row: {} } } = $$props;\n  if ($$props.data === void 0 && $$bindings.data && data !== void 0) $$bindings.data(data);\n  return `<span${add_attribute(\"class\", `badge last:p-1 rounded variant-filled-${data.cell === \"Active\" ? \"success\" : \"error\"}`, 0)}>${escape(data.cell)}</span>`;\n});\nconst Page = create_ssr_component(($$result, $$props, $$bindings, slots) => {\n  let $usersByConnection, $$unsubscribe_usersByConnection = noop, $$subscribe_usersByConnection = () => ($$unsubscribe_usersByConnection(), $$unsubscribe_usersByConnection = subscribe(usersByConnection, ($$value) => $usersByConnection = $$value), usersByConnection);\n  let { users, loadUsers } = UsersStore;\n  let { connections, loadConnections } = ConnectionsStore;\n  let { roles, loadRoles } = RoleStore;\n  let usersByConnection = readable([]);\n  $$subscribe_usersByConnection();\n  const columns = [\n    {\n      dataElement: \"email\",\n      label: \"Username\",\n      sort: true\n    },\n    {\n      dataElement: \"roles\",\n      label: \"Role(s)\",\n      sort: true,\n      class: \"!normal-case\"\n    },\n    {\n      dataElement: \"status\",\n      label: \"Status\",\n      sort: true\n    },\n    {\n      dataElement: \"uuid\",\n      label: \"Actions\",\n      sort: false\n    }\n  ];\n  const cellOverides = { status: Status, uuid: Actions };\n  async function load() {\n    await loadConnections();\n    await loadRoles();\n    await loadUsers();\n    $$subscribe_usersByConnection(usersByConnection = derived([users, connections, roles], ([$u, $c, $r]) => {\n      return $c.map((connection) => ({\n        label: connection.label,\n        users: $u.filter((user) => connection.uuid === user.connection).map((row) => ({\n          uuid: row.uuid || \"\",\n          email: row.email || \"uuid:\" + row.uuid,\n          roles: row.roles.length === 0 ? \"none\" : row.roles.map((role) => $r.find((r) => r.uuid === role)?.name).sort().join(\", \"),\n          status: row.active ? \"Active\" : \"Inactive\"\n        })).sort((uA, uB) => uA.status.localeCompare(uB.status))\n      }));\n    }));\n  }\n  const rowClickHandler = (row) => {\n    row?.uuid;\n    goto();\n  };\n  $$unsubscribe_usersByConnection();\n  return `${$$result.head += `<!-- HEAD_svelte-zefh4i_START -->${$$result.title = `<title>${escape(branding.applicationName)} | Manage Users</title>`, \"\"}<!-- HEAD_svelte-zefh4i_END -->`, \"\"} ${validate_component(Content, \"Content\").$$render($$result, { title: \"Manage Users\" }, {}, {\n    default: () => {\n      return `${function(__value) {\n        if (is_promise(__value)) {\n          __value.then(null, noop);\n          return ` <h3 class=\"text-left\" data-svelte-h=\"svelte-16fo5h6\">Loading</h3> ${validate_component(ProgressBar, \"ProgressBar\").$$render($$result, { animIndeterminate: \"anim-progress-bar\" }, {}, {})} `;\n        }\n        return function() {\n          return ` <div class=\"flex gap-4 mb-6\" data-svelte-h=\"svelte-3ryyp1\"><div class=\"flex-auto\"><a data-testid=\"add-user-btn\" class=\"btn variant-ghost-primary hover:variant-filled-primary\" href=\"/admin/users/new\">+ Add User</a></div></div> ${each($usersByConnection, (connection) => {\n            return `<div${add_attribute(\"id\", `user-table-${connection.label.replaceAll(\" \", \"_\")}`, 0)} class=\"mb-10\">${validate_component(Table, \"Datatable\").$$render(\n              $$result,\n              {\n                tableName: \"Users\",\n                data: connection.users,\n                columns,\n                cellOverides,\n                search: true,\n                defaultRowsPerPage: 10,\n                title: connection.label,\n                rowClickHandler,\n                isClickable: true\n              },\n              {},\n              {}\n            )} </div>`;\n          })} `;\n        }();\n      }(load())}`;\n    }\n  })}`;\n});\nexport {\n  Page as default\n};\n"],"names":[],"mappings":"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"}