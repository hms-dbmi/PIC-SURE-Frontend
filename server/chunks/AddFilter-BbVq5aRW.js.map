{"version":3,"file":"AddFilter-BbVq5aRW.js","sources":["../../../.svelte-kit/adapter-node/chunks/AddFilter.js"],"sourcesContent":["import { A as push, Q as copy_payload, R as assign_payload, C as pop, F as escape_html, E as attr } from \"./index.js\";\nimport { t as toaster } from \"./User.js\";\nimport \"./Filter.js\";\nimport \"./Dictionary.js\";\nimport { L as Loading } from \"./Loading.js\";\nimport { O as OptionsSelectionList } from \"./OptionsSelectionList.js\";\nfunction AddFilter($$payload, $$props) {\n  push();\n  let {\n    data = {},\n    existingFilter,\n    onclose = () => {\n    }\n  } = $$props;\n  let max = \"\";\n  let min = \"\";\n  let minFormValue = \"\";\n  let maxFormValue = \"\";\n  let pageSize = 20;\n  let unselectedOptions = [];\n  let selectedOptions = [];\n  let startLocation = pageSize;\n  let lastSearchTerm = \"\";\n  let loading = false;\n  function getNextValues(search = \"\") {\n    const totalOptions = data?.values?.length || 0;\n    if (totalOptions === 0) return;\n    loading = true;\n    try {\n      let allOptions = data?.values || [];\n      if (search !== lastSearchTerm || !lastSearchTerm.includes(search)) {\n        startLocation = 0;\n        unselectedOptions = [];\n        lastSearchTerm = search;\n      }\n      let filteredOptions = allOptions.filter((option) => !selectedOptions.includes(option) && (!search || option.toLowerCase().includes(search.toLowerCase())));\n      const endLocation = Math.min(startLocation + pageSize, filteredOptions.length);\n      const nextOptions = filteredOptions.slice(startLocation, endLocation);\n      unselectedOptions = [...unselectedOptions, ...nextOptions];\n      startLocation = endLocation;\n    } catch (error) {\n      console.error(error);\n      toaster.error({\n        title: \"An error occurred while loading more options. Please try again later.\"\n      });\n    }\n    loading = false;\n  }\n  let valuesSelected = selectedOptions.map((option) => option);\n  let $$settled = true;\n  let $$inner_payload;\n  function $$render_inner($$payload2) {\n    $$payload2.out += `<div>`;\n    if (!!data) {\n      $$payload2.out += \"<!--[-->\";\n      $$payload2.out += `<div class=\"variable-info\">`;\n      {\n        $$payload2.out += \"<!--[!-->\";\n      }\n      $$payload2.out += `<!--]--> `;\n      {\n        $$payload2.out += \"<!--[!-->\";\n      }\n      $$payload2.out += `<!--]--> `;\n      {\n        $$payload2.out += \"<!--[!-->\";\n      }\n      $$payload2.out += `<!--]--></div>`;\n    } else {\n      $$payload2.out += \"<!--[!-->\";\n    }\n    $$payload2.out += `<!--]--> <div class=\"flex justify-between\" data-testid=\"filter-component\">`;\n    if (!data) {\n      $$payload2.out += \"<!--[-->\";\n      Loading($$payload2, { ring: true, size: \"medium\" });\n    } else {\n      $$payload2.out += \"<!--[!-->\";\n      if (data?.type === \"Categorical\") {\n        $$payload2.out += \"<!--[-->\";\n        $$payload2.out += `<div data-testid=\"categoical-filter\" class=\"w-full\">`;\n        OptionsSelectionList($$payload2, {\n          allOptions: data?.values,\n          onscroll: getNextValues,\n          get unselectedOptions() {\n            return unselectedOptions;\n          },\n          set unselectedOptions($$value) {\n            unselectedOptions = $$value;\n            $$settled = false;\n          },\n          get selectedOptions() {\n            return selectedOptions;\n          },\n          set selectedOptions($$value) {\n            selectedOptions = $$value;\n            $$settled = false;\n          },\n          get currentlyLoading() {\n            return loading;\n          },\n          set currentlyLoading($$value) {\n            loading = $$value;\n            $$settled = false;\n          }\n        });\n        $$payload2.out += `<!----></div>`;\n      } else if (data?.type === \"Continuous\") {\n        $$payload2.out += \"<!--[1-->\";\n        $$payload2.out += `<div class=\"card bg-surface-100 p-3 m-1 w-full\"><section class=\"card-body flex grow gap-4\" data-testid=\"numerical-filter\"><label class=\"flex-auto flex-col\"><span>Min: ${escape_html(min)}</span> <input id=\"min\" data-testid=\"min-input\" type=\"text\" placeholder=\"Enter value or leave blank for variable min\" class=\"input\"${attr(\"value\", minFormValue)}/></label> <label class=\"flex-auto flex-col\"><span>Max: ${escape_html(max)}</span> <input id=\"max\" data-testid=\"max-input\" type=\"text\" placeholder=\"Enter value or leave blank for variable max\" class=\"input\"${attr(\"value\", maxFormValue)}/></label></section></div>`;\n      } else {\n        $$payload2.out += \"<!--[!-->\";\n      }\n      $$payload2.out += `<!--]--> <button class=\"btn btn-icon preset-filled-primary-500 m-1 svelte-1kbvhvw\" data-testid=\"add-filter\" aria-label=\"Add Filter\"${attr(\"disabled\", data.type === \"Categorical\" && valuesSelected.length === 0, true)}><i class=\"fas fa-plus\"></i></button>`;\n    }\n    $$payload2.out += `<!--]--></div></div>`;\n  }\n  do {\n    $$settled = true;\n    $$inner_payload = copy_payload($$payload);\n    $$render_inner($$inner_payload);\n  } while (!$$settled);\n  assign_payload($$payload, $$inner_payload);\n  pop();\n}\nexport {\n  AddFilter as A\n};\n"],"names":[],"mappings":";;;;;;;AAMA,SAAS,SAAS,CAAC,SAAS,EAAE,OAAO,EAAE;AACvC,EAAE,IAAI,EAAE;AACR,EAAE,IAAI;AACN,IAAI,IAAI,GAAG,EAAE;AACb,IAAI,cAAc;AAClB,IAAI,OAAO,GAAG,MAAM;AACpB;AACA,GAAG,GAAG,OAAO;AACb,EAAE,IAAI,GAAG,GAAG,EAAE;AACd,EAAE,IAAI,GAAG,GAAG,EAAE;AACd,EAAE,IAAI,YAAY,GAAG,EAAE;AACvB,EAAE,IAAI,YAAY,GAAG,EAAE;AACvB,EAAE,IAAI,QAAQ,GAAG,EAAE;AACnB,EAAE,IAAI,iBAAiB,GAAG,EAAE;AAC5B,EAAE,IAAI,eAAe,GAAG,EAAE;AAC1B,EAAE,IAAI,aAAa,GAAG,QAAQ;AAC9B,EAAE,IAAI,cAAc,GAAG,EAAE;AACzB,EAAE,IAAI,OAAO,GAAG,KAAK;AACrB,EAAE,SAAS,aAAa,CAAC,MAAM,GAAG,EAAE,EAAE;AACtC,IAAI,MAAM,YAAY,GAAG,IAAI,EAAE,MAAM,EAAE,MAAM,IAAI,CAAC;AAClD,IAAI,IAAI,YAAY,KAAK,CAAC,EAAE;AAC5B,IAAI,OAAO,GAAG,IAAI;AAClB,IAAI,IAAI;AACR,MAAM,IAAI,UAAU,GAAG,IAAI,EAAE,MAAM,IAAI,EAAE;AACzC,MAAM,IAAI,MAAM,KAAK,cAAc,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;AACzE,QAAQ,aAAa,GAAG,CAAC;AACzB,QAAQ,iBAAiB,GAAG,EAAE;AAC9B,QAAQ,cAAc,GAAG,MAAM;AAC/B;AACA,MAAM,IAAI,eAAe,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC,MAAM,KAAK,CAAC,eAAe,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,IAAI,MAAM,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;AAChK,MAAM,MAAM,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,aAAa,GAAG,QAAQ,EAAE,eAAe,CAAC,MAAM,CAAC;AACpF,MAAM,MAAM,WAAW,GAAG,eAAe,CAAC,KAAK,CAAC,aAAa,EAAE,WAAW,CAAC;AAC3E,MAAM,iBAAiB,GAAG,CAAC,GAAG,iBAAiB,EAAE,GAAG,WAAW,CAAC;AAChE,MAAM,aAAa,GAAG,WAAW;AACjC,KAAK,CAAC,OAAO,KAAK,EAAE;AACpB,MAAM,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC;AAC1B,MAAM,OAAO,CAAC,KAAK,CAAC;AACpB,QAAQ,KAAK,EAAE;AACf,OAAO,CAAC;AACR;AACA,IAAI,OAAO,GAAG,KAAK;AACnB;AACA,EAAE,IAAI,cAAc,GAAG,eAAe,CAAC,GAAG,CAAC,CAAC,MAAM,KAAK,MAAM,CAAC;AAC9D,EAAE,IAAI,SAAS,GAAG,IAAI;AACtB,EAAE,IAAI,eAAe;AACrB,EAAE,SAAS,cAAc,CAAC,UAAU,EAAE;AACtC,IAAI,UAAU,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC;AAC7B,IAAI,IAAI,CAAC,CAAC,IAAI,EAAE;AAChB,MAAM,UAAU,CAAC,GAAG,IAAI,UAAU;AAClC,MAAM,UAAU,CAAC,GAAG,IAAI,CAAC,2BAA2B,CAAC;AACrD,MAAM;AACN,QAAQ,UAAU,CAAC,GAAG,IAAI,WAAW;AACrC;AACA,MAAM,UAAU,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC;AACnC,MAAM;AACN,QAAQ,UAAU,CAAC,GAAG,IAAI,WAAW;AACrC;AACA,MAAM,UAAU,CAAC,GAAG,IAAI,CAAC,SAAS,CAAC;AACnC,MAAM;AACN,QAAQ,UAAU,CAAC,GAAG,IAAI,WAAW;AACrC;AACA,MAAM,UAAU,CAAC,GAAG,IAAI,CAAC,cAAc,CAAC;AACxC,KAAK,MAAM;AACX,MAAM,UAAU,CAAC,GAAG,IAAI,WAAW;AACnC;AACA,IAAI,UAAU,CAAC,GAAG,IAAI,CAAC,0EAA0E,CAAC;AAClG,IAAI,IAAI,CAAC,IAAI,EAAE;AACf,MAAM,UAAU,CAAC,GAAG,IAAI,UAAU;AAClC,MAAM,OAAO,CAAC,UAAU,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC;AACzD,KAAK,MAAM;AACX,MAAM,UAAU,CAAC,GAAG,IAAI,WAAW;AACnC,MAAM,IAAI,IAAI,EAAE,IAAI,KAAK,aAAa,EAAE;AACxC,QAAQ,UAAU,CAAC,GAAG,IAAI,UAAU;AACpC,QAAQ,UAAU,CAAC,GAAG,IAAI,CAAC,oDAAoD,CAAC;AAChF,QAAQ,oBAAoB,CAAC,UAAU,EAAE;AACzC,UAAU,UAAU,EAAE,IAAI,EAAE,MAAM;AAClC,UAAU,QAAQ,EAAE,aAAa;AACjC,UAAU,IAAI,iBAAiB,GAAG;AAClC,YAAY,OAAO,iBAAiB;AACpC,WAAW;AACX,UAAU,IAAI,iBAAiB,CAAC,OAAO,EAAE;AACzC,YAAY,iBAAiB,GAAG,OAAO;AACvC,YAAY,SAAS,GAAG,KAAK;AAC7B,WAAW;AACX,UAAU,IAAI,eAAe,GAAG;AAChC,YAAY,OAAO,eAAe;AAClC,WAAW;AACX,UAAU,IAAI,eAAe,CAAC,OAAO,EAAE;AACvC,YAAY,eAAe,GAAG,OAAO;AACrC,YAAY,SAAS,GAAG,KAAK;AAC7B,WAAW;AACX,UAAU,IAAI,gBAAgB,GAAG;AACjC,YAAY,OAAO,OAAO;AAC1B,WAAW;AACX,UAAU,IAAI,gBAAgB,CAAC,OAAO,EAAE;AACxC,YAAY,OAAO,GAAG,OAAO;AAC7B,YAAY,SAAS,GAAG,KAAK;AAC7B;AACA,SAAS,CAAC;AACV,QAAQ,UAAU,CAAC,GAAG,IAAI,CAAC,aAAa,CAAC;AACzC,OAAO,MAAM,IAAI,IAAI,EAAE,IAAI,KAAK,YAAY,EAAE;AAC9C,QAAQ,UAAU,CAAC,GAAG,IAAI,WAAW;AACrC,QAAQ,UAAU,CAAC,GAAG,IAAI,CAAC,uKAAuK,EAAE,WAAW,CAAC,GAAG,CAAC,CAAC,mIAAmI,EAAE,IAAI,CAAC,OAAO,EAAE,YAAY,CAAC,CAAC,wDAAwD,EAAE,WAAW,CAAC,GAAG,CAAC,CAAC,mIAAmI,EAAE,IAAI,CAAC,OAAO,EAAE,YAAY,CAAC,CAAC,0BAA0B,CAAC;AAC7nB,OAAO,MAAM;AACb,QAAQ,UAAU,CAAC,GAAG,IAAI,WAAW;AACrC;AACA,MAAM,UAAU,CAAC,GAAG,IAAI,CAAC,mIAAmI,EAAE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,IAAI,KAAK,aAAa,IAAI,cAAc,CAAC,MAAM,KAAK,CAAC,EAAE,IAAI,CAAC,CAAC,qCAAqC,CAAC;AACvR;AACA,IAAI,UAAU,CAAC,GAAG,IAAI,CAAC,oBAAoB,CAAC;AAC5C;AACA,EAAE,GAAG;AACL,IAAI,SAAS,GAAG,IAAI;AACpB,IAAI,eAAe,GAAG,YAAY,CAAC,SAAS,CAAC;AAC7C,IAAI,cAAc,CAAC,eAAe,CAAC;AACnC,GAAG,QAAQ,CAAC,SAAS;AACrB,EAAE,cAAc,CAAC,SAAS,EAAE,eAAe,CAAC;AAC5C,EAAE,GAAG,EAAE;AACP;;;;"}